module.exports=[67658,(a,b,c)=>{"use strict";var d=a.r(72131),e="function"==typeof Object.is?Object.is:function(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},f=d.useSyncExternalStore,g=d.useRef,h=d.useEffect,i=d.useMemo,j=d.useDebugValue;c.useSyncExternalStoreWithSelector=function(a,b,c,d,k){var l=g(null);if(null===l.current){var m={hasValue:!1,value:null};l.current=m}else m=l.current;var n=f(a,(l=i(function(){function a(a){if(!h){if(h=!0,f=a,a=d(a),void 0!==k&&m.hasValue){var b=m.value;if(k(b,a))return g=b}return g=a}if(b=g,e(f,a))return b;var c=d(a);return void 0!==k&&k(b,c)?(f=a,b):(f=a,g=c)}var f,g,h=!1,i=void 0===c?null:c;return[function(){return a(b())},null===i?void 0:function(){return a(i())}]},[b,c,d,k]))[0],l[1]);return h(function(){m.hasValue=!0,m.value=n},[n]),j(n),n}},32473,(a,b,c)=>{"use strict";b.exports=a.r(67658)},72124,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=class extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}}},56592,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(23952)),f=d(a.r(72124));c.default=class{constructor(a){var b,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=null!=(b=a.shouldThrowOnError)&&b,this.signal=a.signal,this.isMaybeSingle=null!=(c=a.isMaybeSingle)&&c,a.fetch?this.fetch=a.fetch:"undefined"==typeof fetch?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,b){return this.headers=new Headers(this.headers),this.headers.set(a,b),this}then(a,b){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let c=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var b,c,d,e;let g=null,h=null,i=null,j=a.status,k=a.statusText;if(a.ok){if("HEAD"!==this.method){let c=await a.text();""===c||(h="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null==(b=this.headers.get("Accept"))?void 0:b.includes("application/vnd.pgrst.plan+text"))?c:JSON.parse(c))}let e=null==(c=this.headers.get("Prefer"))?void 0:c.match(/count=(exact|planned|estimated)/),f=null==(d=a.headers.get("content-range"))?void 0:d.split("/");e&&f&&f.length>1&&(i=parseInt(f[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(h)&&(h.length>1?(g={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,i=null,j=406,k="Not Acceptable"):h=1===h.length?h[0]:null)}else{let b=await a.text();try{g=JSON.parse(b),Array.isArray(g)&&404===a.status&&(h=[],g=null,j=200,k="OK")}catch(c){404===a.status&&""===b?(j=204,k="No Content"):g={message:b}}if(g&&this.isMaybeSingle&&(null==(e=null==g?void 0:g.details)?void 0:e.includes("0 rows"))&&(g=null,j=200,k="OK"),g&&this.shouldThrowOnError)throw new f.default(g)}return{error:g,data:h,count:i,status:j,statusText:k}});return this.shouldThrowOnError||(c=c.catch(a=>{var b,c,d;return{error:{message:`${null!=(b=null==a?void 0:a.name)?b:"FetchError"}: ${null==a?void 0:a.message}`,details:`${null!=(c=null==a?void 0:a.stack)?c:""}`,hint:"",code:`${null!=(d=null==a?void 0:a.code)?d:""}`},data:null,count:null,status:0,statusText:""}})),c.then(a,b)}returns(){return this}overrideTypes(){return this}}},98564,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(56592));class f extends e.default{select(a){let b=!1,c=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!b?"":('"'===a&&(b=!b),a)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:b=!0,nullsFirst:c,foreignTable:d,referencedTable:e=d}={}){let f=e?`${e}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${b?"asc":"desc"}${void 0===c?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:b,referencedTable:c=b}={}){let d=void 0===c?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,b,{foreignTable:c,referencedTable:d=c}={}){let e=void 0===d?"offset":`${d}.offset`,f=void 0===d?"limit":`${d}.limit`;return this.url.searchParams.set(e,`${a}`),this.url.searchParams.set(f,`${b-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:b=!1,settings:c=!1,buffers:d=!1,wal:e=!1,format:f="text"}={}){var g;let h=[a?"analyze":null,b?"verbose":null,c?"settings":null,d?"buffers":null,e?"wal":null].filter(Boolean).join("|"),i=null!=(g=this.headers.get("Accept"))?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${i}"; options=${h};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}c.default=f},19001,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(98564));class f extends e.default{eq(a,b){return this.url.searchParams.append(a,`eq.${b}`),this}neq(a,b){return this.url.searchParams.append(a,`neq.${b}`),this}gt(a,b){return this.url.searchParams.append(a,`gt.${b}`),this}gte(a,b){return this.url.searchParams.append(a,`gte.${b}`),this}lt(a,b){return this.url.searchParams.append(a,`lt.${b}`),this}lte(a,b){return this.url.searchParams.append(a,`lte.${b}`),this}like(a,b){return this.url.searchParams.append(a,`like.${b}`),this}likeAllOf(a,b){return this.url.searchParams.append(a,`like(all).{${b.join(",")}}`),this}likeAnyOf(a,b){return this.url.searchParams.append(a,`like(any).{${b.join(",")}}`),this}ilike(a,b){return this.url.searchParams.append(a,`ilike.${b}`),this}ilikeAllOf(a,b){return this.url.searchParams.append(a,`ilike(all).{${b.join(",")}}`),this}ilikeAnyOf(a,b){return this.url.searchParams.append(a,`ilike(any).{${b.join(",")}}`),this}is(a,b){return this.url.searchParams.append(a,`is.${b}`),this}in(a,b){let c=Array.from(new Set(b)).map(a=>"string"==typeof a&&RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}contains(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cs.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cs.{${b.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(b)}`),this}containedBy(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cd.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cd.{${b.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(b)}`),this}rangeGt(a,b){return this.url.searchParams.append(a,`sr.${b}`),this}rangeGte(a,b){return this.url.searchParams.append(a,`nxl.${b}`),this}rangeLt(a,b){return this.url.searchParams.append(a,`sl.${b}`),this}rangeLte(a,b){return this.url.searchParams.append(a,`nxr.${b}`),this}rangeAdjacent(a,b){return this.url.searchParams.append(a,`adj.${b}`),this}overlaps(a,b){return"string"==typeof b?this.url.searchParams.append(a,`ov.${b}`):this.url.searchParams.append(a,`ov.{${b.join(",")}}`),this}textSearch(a,b,{config:c,type:d}={}){let e="";"plain"===d?e="pl":"phrase"===d?e="ph":"websearch"===d&&(e="w");let f=void 0===c?"":`(${c})`;return this.url.searchParams.append(a,`${e}fts${f}.${b}`),this}match(a){return Object.entries(a).forEach(([a,b])=>{this.url.searchParams.append(a,`eq.${b}`)}),this}not(a,b,c){return this.url.searchParams.append(a,`not.${b}.${c}`),this}or(a,{foreignTable:b,referencedTable:c=b}={}){let d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,b,c){return this.url.searchParams.append(a,`${b}.${c}`),this}}c.default=f},3619,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(19001));c.default=class{constructor(a,{headers:b={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(b),this.schema=c,this.fetch=d}select(a,{head:b=!1,count:c}={}){let d=!1,f=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!d?"":('"'===a&&(d=!d),a)).join("");return this.url.searchParams.set("select",f),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:b?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:b,defaultToNull:c=!0}={}){var d;if(b&&this.headers.append("Prefer",`count=${b}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);this.url.searchParams.set("columns",a.join(","))}}return new e.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(d=this.fetch)?d:fetch})}upsert(a,{onConflict:b,ignoreDuplicates:c=!1,count:d,defaultToNull:f=!0}={}){var g;if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),void 0!==b&&this.url.searchParams.set("on_conflict",b),d&&this.headers.append("Prefer",`count=${d}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);this.url.searchParams.set("columns",a.join(","))}}return new e.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(g=this.fetch)?g:fetch})}update(a,{count:b}={}){var c;return b&&this.headers.append("Prefer",`count=${b}`),new e.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(c=this.fetch)?c:fetch})}delete({count:a}={}){var b;return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!=(b=this.fetch)?b:fetch})}}},27749,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(3619)),f=d(a.r(19001));class g{constructor(a,{headers:b={},schema:c,fetch:d}={}){this.url=a,this.headers=new Headers(b),this.schemaName=c,this.fetch=d}from(a){let b=new URL(`${this.url}/${a}`);return new e.default(b,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new g(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,b={},{head:c=!1,get:d=!1,count:e}={}){var g;let h,i,j=new URL(`${this.url}/rpc/${a}`);c||d?(h=c?"HEAD":"GET",Object.entries(b).filter(([a,b])=>void 0!==b).map(([a,b])=>[a,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([a,b])=>{j.searchParams.append(a,b)})):(h="POST",i=b);let k=new Headers(this.headers);return e&&k.set("Prefer",`count=${e}`),new f.default({method:h,url:j,headers:k,schema:this.schemaName,body:i,fetch:null!=(g=this.fetch)?g:fetch})}}c.default=g},79614,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.PostgrestError=c.PostgrestBuilder=c.PostgrestTransformBuilder=c.PostgrestFilterBuilder=c.PostgrestQueryBuilder=c.PostgrestClient=void 0;let e=d(a.r(27749));c.PostgrestClient=e.default;let f=d(a.r(3619));c.PostgrestQueryBuilder=f.default;let g=d(a.r(19001));c.PostgrestFilterBuilder=g.default;let h=d(a.r(98564));c.PostgrestTransformBuilder=h.default;let i=d(a.r(56592));c.PostgrestBuilder=i.default;let j=d(a.r(72124));c.PostgrestError=j.default,c.default={PostgrestClient:e.default,PostgrestQueryBuilder:f.default,PostgrestFilterBuilder:g.default,PostgrestTransformBuilder:h.default,PostgrestBuilder:i.default,PostgrestError:j.default}},33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},92434,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"warnOnce",{enumerable:!0,get:function(){return d}});let d=a=>{}},4987,(a,b,c)=>{"use strict";function d(a){let{widthInt:b,heightInt:c,blurWidth:d,blurHeight:e,blurDataURL:f,objectFit:g}=a,h=d?40*d:b,i=e?40*e:c,j=h&&i?"viewBox='0 0 "+h+" "+i+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+j+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(j?"none":"contain"===g?"xMidYMid":"cover"===g?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+f+"'/%3E%3C/svg%3E"}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getImageBlurSvg",{enumerable:!0,get:function(){return d}})},345,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{VALID_LOADERS:function(){return d},imageConfigDefault:function(){return e}});let d=["default","imgix","cloudinary","akamai","custom"],e={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:void 0,unoptimized:!1}},94915,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getImgProps",{enumerable:!0,get:function(){return i}}),a.r(92434);let d=a.r(4987),e=a.r(345),f=["-moz-initial","fill","none","scale-down",void 0];function g(a){return void 0!==a.default}function h(a){return void 0===a?a:"number"==typeof a?Number.isFinite(a)?a:NaN:"string"==typeof a&&/^[0-9]+$/.test(a)?parseInt(a,10):NaN}function i(a,b){var c,i;let j,k,l,{src:m,sizes:n,unoptimized:o=!1,priority:p=!1,loading:q,className:r,quality:s,width:t,height:u,fill:v=!1,style:w,overrideSrc:x,onLoad:y,onLoadingComplete:z,placeholder:A="empty",blurDataURL:B,fetchPriority:C,decoding:D="async",layout:E,objectFit:F,objectPosition:G,lazyBoundary:H,lazyRoot:I,...J}=a,{imgConf:K,showAltText:L,blurComplete:M,defaultLoader:N}=b,O=K||e.imageConfigDefault;if("allSizes"in O)j=O;else{let a=[...O.deviceSizes,...O.imageSizes].sort((a,b)=>a-b),b=O.deviceSizes.sort((a,b)=>a-b),d=null==(c=O.qualities)?void 0:c.sort((a,b)=>a-b);j={...O,allSizes:a,deviceSizes:b,qualities:d}}if(void 0===N)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let P=J.loader||N;delete J.loader,delete J.srcSet;let Q="__next_img_default"in P;if(Q){if("custom"===j.loader)throw Object.defineProperty(Error('Image with src "'+m+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader'),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let a=P;P=b=>{let{config:c,...d}=b;return a(d)}}if(E){"fill"===E&&(v=!0);let a={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[E];a&&(w={...w,...a});let b={responsive:"100vw",fill:"100vw"}[E];b&&!n&&(n=b)}let R="",S=h(t),T=h(u);if((i=m)&&"object"==typeof i&&(g(i)||void 0!==i.src)){let a=g(m)?m.default:m;if(!a.src)throw Object.defineProperty(Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(a)),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!a.height||!a.width)throw Object.defineProperty(Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(a)),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(k=a.blurWidth,l=a.blurHeight,B=B||a.blurDataURL,R=a.src,!v)if(S||T){if(S&&!T){let b=S/a.width;T=Math.round(a.height*b)}else if(!S&&T){let b=T/a.height;S=Math.round(a.width*b)}}else S=a.width,T=a.height}let U=!p&&("lazy"===q||void 0===q);(!(m="string"==typeof m?m:R)||m.startsWith("data:")||m.startsWith("blob:"))&&(o=!0,U=!1),j.unoptimized&&(o=!0),Q&&!j.dangerouslyAllowSVG&&m.split("?",1)[0].endsWith(".svg")&&(o=!0);let V=h(s),W=Object.assign(v?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:F,objectPosition:G}:{},L?{}:{color:"transparent"},w),X=M||"empty"===A?null:"blur"===A?'url("data:image/svg+xml;charset=utf-8,'+(0,d.getImageBlurSvg)({widthInt:S,heightInt:T,blurWidth:k,blurHeight:l,blurDataURL:B||"",objectFit:W.objectFit})+'")':'url("'+A+'")',Y=f.includes(W.objectFit)?"fill"===W.objectFit?"100% 100%":"cover":W.objectFit,Z=X?{backgroundSize:Y,backgroundPosition:W.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:X}:{},$=function(a){let{config:b,src:c,unoptimized:d,width:e,quality:f,sizes:g,loader:h}=a;if(d)return{src:c,srcSet:void 0,sizes:void 0};let{widths:i,kind:j}=function(a,b,c){let{deviceSizes:d,allSizes:e}=a;if(c){let a=/(^|\s)(1?\d?\d)vw/g,b=[];for(let d;d=a.exec(c);)b.push(parseInt(d[2]));if(b.length){let a=.01*Math.min(...b);return{widths:e.filter(b=>b>=d[0]*a),kind:"w"}}return{widths:e,kind:"w"}}return"number"!=typeof b?{widths:d,kind:"w"}:{widths:[...new Set([b,2*b].map(a=>e.find(b=>b>=a)||e[e.length-1]))],kind:"x"}}(b,e,g),k=i.length-1;return{sizes:g||"w"!==j?g:"100vw",srcSet:i.map((a,d)=>h({config:b,src:c,quality:f,width:a})+" "+("w"===j?a:d+1)+j).join(", "),src:h({config:b,src:c,quality:f,width:i[k]})}}({config:j,src:m,unoptimized:o,width:S,quality:V,sizes:n,loader:P});return{props:{...J,loading:U?"lazy":q,fetchPriority:C,width:S,height:T,decoding:D,className:r,style:{...W,...Z},sizes:$.sizes,srcSet:$.srcSet,src:x||$.src},meta:{unoptimized:o,priority:p,placeholder:A,fill:v}}}},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},94613,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return f}});let d=a.r(72131),e=()=>{};function f(a){var b;let{headManager:c,reduceComponentsToState:f}=a;function g(){if(c&&c.mountedInstances){let b=d.Children.toArray(Array.from(c.mountedInstances).filter(Boolean));c.updateHead(f(b,a))}}return null==c||null==(b=c.mountedInstances)||b.add(a.children),g(),e(()=>{var b;return null==c||null==(b=c.mountedInstances)||b.add(a.children),()=>{var b;null==c||null==(b=c.mountedInstances)||b.delete(a.children)}}),e(()=>(c&&(c._pendingUpdate=g),()=>{c&&(c._pendingUpdate=g)})),null}},59231,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AmpContext},92966,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HeadManagerContext},57268,(a,b,c)=>{"use strict";function d(a){let{ampFirst:b=!1,hybrid:c=!1,hasQuery:d=!1}=void 0===a?{}:a;return b||c&&d}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isInAmpMode",{enumerable:!0,get:function(){return d}})},58018,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{default:function(){return p},defaultHead:function(){return l}});let d=a.r(33354),e=a.r(46058),f=a.r(87924),g=e._(a.r(72131)),h=d._(a.r(94613)),i=a.r(59231),j=a.r(92966),k=a.r(57268);function l(a){void 0===a&&(a=!1);let b=[(0,f.jsx)("meta",{charSet:"utf-8"},"charset")];return a||b.push((0,f.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),b}function m(a,b){return"string"==typeof b||"number"==typeof b?a:b.type===g.default.Fragment?a.concat(g.default.Children.toArray(b.props.children).reduce((a,b)=>"string"==typeof b||"number"==typeof b?a:a.concat(b),[])):a.concat(b)}a.r(92434);let n=["name","httpEquiv","charSet","itemProp"];function o(a,b){let{inAmpMode:c}=b;return a.reduce(m,[]).reverse().concat(l(c).reverse()).filter(function(){let a=new Set,b=new Set,c=new Set,d={};return e=>{let f=!0,g=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){g=!0;let b=e.key.slice(e.key.indexOf("$")+1);a.has(b)?f=!1:a.add(b)}switch(e.type){case"title":case"base":b.has(e.type)?f=!1:b.add(e.type);break;case"meta":for(let a=0,b=n.length;a<b;a++){let b=n[a];if(e.props.hasOwnProperty(b))if("charSet"===b)c.has(b)?f=!1:c.add(b);else{let a=e.props[b],c=d[b]||new Set;("name"!==b||!g)&&c.has(a)?f=!1:(c.add(a),d[b]=c)}}}return f}}()).reverse().map((a,b)=>{let c=a.key||b;return g.default.cloneElement(a,{key:c})})}let p=function(a){let{children:b}=a,c=(0,g.useContext)(i.AmpStateContext),d=(0,g.useContext)(j.HeadManagerContext);return(0,f.jsx)(h.default,{reduceComponentsToState:o,headManager:d,inAmpMode:(0,k.isInAmpMode)(c),children:b})};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},4486,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ImageConfigContext},53773,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.RouterContext},2305,(a,b,c)=>{"use strict";function d(a){var b;let{config:c,src:d,width:e,quality:f}=a,g=f||(null==(b=c.qualities)?void 0:b.reduce((a,b)=>Math.abs(b-75)<Math.abs(a-75)?b:a))||75;return c.path+"?url="+encodeURIComponent(d)+"&w="+e+"&q="+g+(d.startsWith("/_next/static/media/"),"")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}}),d.__next_img_default=!0;let e=d},8591,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=a.r(72131);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},67161,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return u}});let d=a.r(33354),e=a.r(46058),f=a.r(87924),g=e._(a.r(72131)),h=d._(a.r(35112)),i=d._(a.r(58018)),j=a.r(94915),k=a.r(345),l=a.r(4486);a.r(92434);let m=a.r(53773),n=d._(a.r(2305)),o=a.r(8591),p={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function q(a,b,c,d,e,f,g){let h=null==a?void 0:a.src;a&&a["data-loaded-src"]!==h&&(a["data-loaded-src"]=h,("decode"in a?a.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(a.parentElement&&a.isConnected){if("empty"!==b&&e(!0),null==c?void 0:c.current){let b=new Event("load");Object.defineProperty(b,"target",{writable:!1,value:a});let d=!1,e=!1;c.current({...b,nativeEvent:b,currentTarget:a,target:a,isDefaultPrevented:()=>d,isPropagationStopped:()=>e,persist:()=>{},preventDefault:()=>{d=!0,b.preventDefault()},stopPropagation:()=>{e=!0,b.stopPropagation()}})}(null==d?void 0:d.current)&&d.current(a)}}))}function r(a){return g.use?{fetchPriority:a}:{fetchpriority:a}}globalThis.__NEXT_IMAGE_IMPORTED=!0;let s=(0,g.forwardRef)((a,b)=>{let{src:c,srcSet:d,sizes:e,height:h,width:i,decoding:j,className:k,style:l,fetchPriority:m,placeholder:n,loading:p,unoptimized:s,fill:t,onLoadRef:u,onLoadingCompleteRef:v,setBlurComplete:w,setShowAltText:x,sizesInput:y,onLoad:z,onError:A,...B}=a,C=(0,g.useCallback)(a=>{a&&(A&&(a.src=a.src),a.complete&&q(a,n,u,v,w,s,y))},[c,n,u,v,w,A,s,y]),D=(0,o.useMergedRef)(b,C);return(0,f.jsx)("img",{...B,...r(m),loading:p,width:i,height:h,decoding:j,"data-nimg":t?"fill":"1",className:k,style:l,sizes:e,srcSet:d,src:c,ref:D,onLoad:a=>{q(a.currentTarget,n,u,v,w,s,y)},onError:a=>{x(!0),"empty"!==n&&w(!0),A&&A(a)}})});function t(a){let{isAppRouter:b,imgAttributes:c}=a,d={as:"image",imageSrcSet:c.srcSet,imageSizes:c.sizes,crossOrigin:c.crossOrigin,referrerPolicy:c.referrerPolicy,...r(c.fetchPriority)};return b&&h.default.preload?(h.default.preload(c.src,d),null):(0,f.jsx)(i.default,{children:(0,f.jsx)("link",{rel:"preload",href:c.srcSet?void 0:c.src,...d},"__nimg-"+c.src+c.srcSet+c.sizes)})}let u=(0,g.forwardRef)((a,b)=>{let c=(0,g.useContext)(m.RouterContext),d=(0,g.useContext)(l.ImageConfigContext),e=(0,g.useMemo)(()=>{var a;let b=p||d||k.imageConfigDefault,c=[...b.deviceSizes,...b.imageSizes].sort((a,b)=>a-b),e=b.deviceSizes.sort((a,b)=>a-b),f=null==(a=b.qualities)?void 0:a.sort((a,b)=>a-b);return{...b,allSizes:c,deviceSizes:e,qualities:f}},[d]),{onLoad:h,onLoadingComplete:i}=a,o=(0,g.useRef)(h);(0,g.useEffect)(()=>{o.current=h},[h]);let q=(0,g.useRef)(i);(0,g.useEffect)(()=>{q.current=i},[i]);let[r,u]=(0,g.useState)(!1),[v,w]=(0,g.useState)(!1),{props:x,meta:y}=(0,j.getImgProps)(a,{defaultLoader:n.default,imgConf:e,blurComplete:r,showAltText:v});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(s,{...x,unoptimized:y.unoptimized,placeholder:y.placeholder,fill:y.fill,onLoadRef:o,onLoadingCompleteRef:q,setBlurComplete:u,setShowAltText:w,sizesInput:a.sizes,ref:b}),y.priority?(0,f.jsx)(t,{isAppRouter:!c,imgAttributes:x}):null]})});("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},33095,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{default:function(){return i},getImageProps:function(){return h}});let d=a.r(33354),e=a.r(94915),f=a.r(67161),g=d._(a.r(2305));function h(a){let{props:b}=(0,e.getImgProps)(a,{defaultLoader:g.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[a,c]of Object.entries(b))void 0===c&&delete b[a];return{props:b}}let i=f.Image},71987,(a,b,c)=>{b.exports=a.r(33095)},40777,a=>{"use strict";a.s(["default",()=>et],40777);var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=a.i(87924),s=a.i(72131);let t={pocketbase:{url:process.env.NEXT_PUBLIC_POCKETBASE_URL||"https://get.piksel.lt",collection:"orders"},supabase:{url:process.env.NEXT_PUBLIC_SUPABASE_URL||"https://titkwifsatjemnquyrij.supabase.co",anonKey:process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"sb_publishable_bXgkXQ6_FY3CdnPRHZ-onA_p-bjSFM_"},app:{name:"Piksel Orders",description:"Modernus užsakymų valdymo sistema"}},u=t.pocketbase.url,v=t.pocketbase.collection;class w{static connectionPool=new Map;static requestQueue=[];static isProcessingQueue=!1;static async makeRequest(a,b={}){let c=`${u}/api/collections/${v}${a}`,d=new AbortController,e=setTimeout(()=>d.abort(),1e4);try{let a=await fetch(c,{headers:{"Content-Type":"application/json","Cache-Control":"max-age=300",...b.headers},signal:d.signal,...b});if(clearTimeout(e),!a.ok)throw Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){if(clearTimeout(e),a instanceof Error&&"AbortError"===a.name)throw console.error("⏰ PocketBase request timeout:",c),Error("Request timeout");throw console.error("❌ PocketBase request failed:",a),a}}static async makeRequestWithRetry(a,b={},c=3){try{return await this.makeRequest(a,b)}catch(d){if(c>0&&d instanceof Error&&"Request timeout"!==d.message)return console.log(`🔄 Retrying request (${c} attempts left)...`),await new Promise(a=>setTimeout(a,1e3)),this.makeRequestWithRetry(a,b,c-1);throw d}}static async processQueue(){if(!this.isProcessingQueue&&0!==this.requestQueue.length){for(this.isProcessingQueue=!0;this.requestQueue.length>0;){let a=this.requestQueue.shift();if(a)try{await a()}catch{console.error("❌ Queue request failed")}}this.isProcessingQueue=!1}}static queueRequest(a){return new Promise((b,c)=>{this.requestQueue.push(async()=>{try{let c=await a();b(c)}catch(a){c(a)}}),this.processQueue()})}static async getOrders(a={}){let{page:b=1,perPage:c=25,sort:d="-updated",filter:e=""}=a,f=new URLSearchParams({page:b.toString(),perPage:c.toString(),sort:d,...e&&{filter:e}}),g=`/records?${f}`;console.log("🌐 PocketBase request URL:",g),console.log("🌐 PocketBase filter:",e);let h=await this.makeRequestWithRetry(g);return console.log("📦 PocketBase raw response:",h),{items:h.items||[],totalItems:h.totalItems||0,totalPages:h.totalPages||0}}static async getOrder(a){return this.makeRequestWithRetry(`/records/${a}`)}static async searchOrders(a){return this.queueRequest(async()=>(await this.makeRequestWithRetry(`/records?filter=(client~"${a}" || agency~"${a}" || invoice_id~"${a}")&perPage=25`)).items||[])}static async updateOrder(a,b){return this.makeRequestWithRetry(`/records/${a}`,{method:"PATCH",body:JSON.stringify(b)})}static async deleteOrder(a){await this.makeRequestWithRetry(`/records/${a}`,{method:"DELETE"})}static async getQuoteByOrderId(a){try{let b=`${u}/api/collections/quotes/records?filter=order_id="${a}"&perPage=1`;console.log("🔍 Trying to fetch quote from:",b);let c=await fetch(b,{headers:{"Content-Type":"application/json","Cache-Control":"max-age=600"},signal:AbortSignal.timeout(5e3)});if(!c.ok)throw Error(`HTTP error! status: ${c.status}`);let d=await c.json();return d.items?.[0]||null}catch{return console.log("No quote found for order:",a),null}}static async getOrdersBatch(a){if(0===a.length)return[];let b=[];for(let c=0;c<a.length;c+=10){let d=a.slice(c,c+10).map(a=>`id="${a}"`).join(" || ");try{let a=await this.makeRequestWithRetry(`/records?filter=(${d})&perPage=10`);b.push(...a.items||[])}catch(a){console.error("❌ Batch request failed:",a)}}return b}static async healthCheck(){try{return(await fetch(`${u}/api/health`,{signal:AbortSignal.timeout(3e3)})).ok}catch{return!1}}}let x={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function y(a){return (b={})=>{let c=b.width?String(b.width):a.defaultWidth;return a.formats[c]||a.formats[a.defaultWidth]}}let z={date:y({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:y({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:y({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},A={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function B(a){return(b,c)=>{let d;if("formatting"===(c?.context?String(c.context):"standalone")&&a.formattingValues){let b=a.defaultFormattingWidth||a.defaultWidth,e=c?.width?String(c.width):b;d=a.formattingValues[e]||a.formattingValues[b]}else{let b=a.defaultWidth,e=c?.width?String(c.width):a.defaultWidth;d=a.values[e]||a.values[b]}return d[a.argumentCallback?a.argumentCallback(b):b]}}function C(a){return(b,c={})=>{let d,e=c.width,f=e&&a.matchPatterns[e]||a.matchPatterns[a.defaultMatchWidth],g=b.match(f);if(!g)return null;let h=g[0],i=e&&a.parsePatterns[e]||a.parsePatterns[a.defaultParseWidth],j=Array.isArray(i)?function(a,b){for(let c=0;c<a.length;c++)if(b(a[c]))return c}(i,a=>a.test(h)):function(a,b){for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)&&b(a[c]))return c}(i,a=>a.test(h));return d=a.valueCallback?a.valueCallback(j):j,{value:d=c.valueCallback?c.valueCallback(d):d,rest:b.slice(h.length)}}}let D={code:"en-US",formatDistance:(a,b,c)=>{let d,e=x[a];if(d="string"==typeof e?e:1===b?e.one:e.other.replace("{{count}}",b.toString()),c?.addSuffix)if(c.comparison&&c.comparison>0)return"in "+d;else return d+" ago";return d},formatLong:z,formatRelative:(a,b,c,d)=>A[a],localize:{ordinalNumber:(a,b)=>{let c=Number(a),d=c%100;if(d>20||d<10)switch(d%10){case 1:return c+"st";case 2:return c+"nd";case 3:return c+"rd"}return c+"th"},era:B({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:B({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:a=>a-1}),month:B({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:B({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:B({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:function(a){return(b,c={})=>{let d=b.match(a.matchPattern);if(!d)return null;let e=d[0],f=b.match(a.parsePattern);if(!f)return null;let g=a.valueCallback?a.valueCallback(f[0]):f[0];return{value:g=c.valueCallback?c.valueCallback(g):g,rest:b.slice(e.length)}}}({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:a=>parseInt(a,10)}),era:C({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:C({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:a=>a+1}),month:C({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:C({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:C({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},E={},F=Symbol.for("constructDateFrom");function G(a,b){return"function"==typeof a?a(b):a&&"object"==typeof a&&F in a?a[F](b):a instanceof Date?new a.constructor(b):new Date(b)}function H(a,b){return G(b||a,a)}function I(a){let b=H(a),c=new Date(Date.UTC(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds()));return c.setUTCFullYear(b.getFullYear()),a-c}function J(a,b){let c=H(a,b?.in);return c.setHours(0,0,0,0),c}function K(a,b){let c=b?.weekStartsOn??b?.locale?.options?.weekStartsOn??E.weekStartsOn??E.locale?.options?.weekStartsOn??0,d=H(a,b?.in),e=d.getDay();return d.setDate(d.getDate()-(7*(e<c)+e-c)),d.setHours(0,0,0,0),d}function L(a,b){return K(a,{...b,weekStartsOn:1})}function M(a,b){let c=H(a,b?.in),d=c.getFullYear(),e=G(c,0);e.setFullYear(d+1,0,4),e.setHours(0,0,0,0);let f=L(e),g=G(c,0);g.setFullYear(d,0,4),g.setHours(0,0,0,0);let h=L(g);return c.getTime()>=f.getTime()?d+1:c.getTime()>=h.getTime()?d:d-1}function N(a,b){let c=H(a,b?.in),d=c.getFullYear(),e=b?.firstWeekContainsDate??b?.locale?.options?.firstWeekContainsDate??E.firstWeekContainsDate??E.locale?.options?.firstWeekContainsDate??1,f=G(b?.in||a,0);f.setFullYear(d+1,0,e),f.setHours(0,0,0,0);let g=K(f,b),h=G(b?.in||a,0);h.setFullYear(d,0,e),h.setHours(0,0,0,0);let i=K(h,b);return+c>=+g?d+1:+c>=+i?d:d-1}function O(a,b){let c=Math.abs(a).toString().padStart(b,"0");return(a<0?"-":"")+c}let P={y(a,b){let c=a.getFullYear(),d=c>0?c:1-c;return O("yy"===b?d%100:d,b.length)},M(a,b){let c=a.getMonth();return"M"===b?String(c+1):O(c+1,2)},d:(a,b)=>O(a.getDate(),b.length),a(a,b){let c=a.getHours()/12>=1?"pm":"am";switch(b){case"a":case"aa":return c.toUpperCase();case"aaa":return c;case"aaaaa":return c[0];default:return"am"===c?"a.m.":"p.m."}},h:(a,b)=>O(a.getHours()%12||12,b.length),H:(a,b)=>O(a.getHours(),b.length),m:(a,b)=>O(a.getMinutes(),b.length),s:(a,b)=>O(a.getSeconds(),b.length),S(a,b){let c=b.length;return O(Math.trunc(a.getMilliseconds()*Math.pow(10,c-3)),b.length)}},Q={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},R={G:function(a,b,c){let d=+(a.getFullYear()>0);switch(b){case"G":case"GG":case"GGG":return c.era(d,{width:"abbreviated"});case"GGGGG":return c.era(d,{width:"narrow"});default:return c.era(d,{width:"wide"})}},y:function(a,b,c){if("yo"===b){let b=a.getFullYear();return c.ordinalNumber(b>0?b:1-b,{unit:"year"})}return P.y(a,b)},Y:function(a,b,c,d){let e=N(a,d),f=e>0?e:1-e;return"YY"===b?O(f%100,2):"Yo"===b?c.ordinalNumber(f,{unit:"year"}):O(f,b.length)},R:function(a,b){return O(M(a),b.length)},u:function(a,b){return O(a.getFullYear(),b.length)},Q:function(a,b,c){let d=Math.ceil((a.getMonth()+1)/3);switch(b){case"Q":return String(d);case"QQ":return O(d,2);case"Qo":return c.ordinalNumber(d,{unit:"quarter"});case"QQQ":return c.quarter(d,{width:"abbreviated",context:"formatting"});case"QQQQQ":return c.quarter(d,{width:"narrow",context:"formatting"});default:return c.quarter(d,{width:"wide",context:"formatting"})}},q:function(a,b,c){let d=Math.ceil((a.getMonth()+1)/3);switch(b){case"q":return String(d);case"qq":return O(d,2);case"qo":return c.ordinalNumber(d,{unit:"quarter"});case"qqq":return c.quarter(d,{width:"abbreviated",context:"standalone"});case"qqqqq":return c.quarter(d,{width:"narrow",context:"standalone"});default:return c.quarter(d,{width:"wide",context:"standalone"})}},M:function(a,b,c){let d=a.getMonth();switch(b){case"M":case"MM":return P.M(a,b);case"Mo":return c.ordinalNumber(d+1,{unit:"month"});case"MMM":return c.month(d,{width:"abbreviated",context:"formatting"});case"MMMMM":return c.month(d,{width:"narrow",context:"formatting"});default:return c.month(d,{width:"wide",context:"formatting"})}},L:function(a,b,c){let d=a.getMonth();switch(b){case"L":return String(d+1);case"LL":return O(d+1,2);case"Lo":return c.ordinalNumber(d+1,{unit:"month"});case"LLL":return c.month(d,{width:"abbreviated",context:"standalone"});case"LLLLL":return c.month(d,{width:"narrow",context:"standalone"});default:return c.month(d,{width:"wide",context:"standalone"})}},w:function(a,b,c,d){let e=function(a,b){let c=H(a,b?.in);return Math.round((K(c,b)-function(a,b){let c=b?.firstWeekContainsDate??b?.locale?.options?.firstWeekContainsDate??E.firstWeekContainsDate??E.locale?.options?.firstWeekContainsDate??1,d=N(a,b),e=G(b?.in||a,0);return e.setFullYear(d,0,c),e.setHours(0,0,0,0),K(e,b)}(c,b))/6048e5)+1}(a,d);return"wo"===b?c.ordinalNumber(e,{unit:"week"}):O(e,b.length)},I:function(a,b,c){let d=function(a,b){let c=H(a,void 0);return Math.round((L(c)-function(a,b){let c=M(a,void 0),d=G(a,0);return d.setFullYear(c,0,4),d.setHours(0,0,0,0),L(d)}(c))/6048e5)+1}(a);return"Io"===b?c.ordinalNumber(d,{unit:"week"}):O(d,b.length)},d:function(a,b,c){return"do"===b?c.ordinalNumber(a.getDate(),{unit:"date"}):P.d(a,b)},D:function(a,b,c){let d=function(a,b){let c=H(a,void 0);return function(a,b,c){let[d,e]=function(a,...b){let c=G.bind(null,a||b.find(a=>"object"==typeof a));return b.map(c)}(void 0,a,b),f=J(d),g=J(e);return Math.round((f-I(f)-(g-I(g)))/864e5)}(c,function(a,b){let c=H(a,void 0);return c.setFullYear(c.getFullYear(),0,1),c.setHours(0,0,0,0),c}(c))+1}(a);return"Do"===b?c.ordinalNumber(d,{unit:"dayOfYear"}):O(d,b.length)},E:function(a,b,c){let d=a.getDay();switch(b){case"E":case"EE":case"EEE":return c.day(d,{width:"abbreviated",context:"formatting"});case"EEEEE":return c.day(d,{width:"narrow",context:"formatting"});case"EEEEEE":return c.day(d,{width:"short",context:"formatting"});default:return c.day(d,{width:"wide",context:"formatting"})}},e:function(a,b,c,d){let e=a.getDay(),f=(e-d.weekStartsOn+8)%7||7;switch(b){case"e":return String(f);case"ee":return O(f,2);case"eo":return c.ordinalNumber(f,{unit:"day"});case"eee":return c.day(e,{width:"abbreviated",context:"formatting"});case"eeeee":return c.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return c.day(e,{width:"short",context:"formatting"});default:return c.day(e,{width:"wide",context:"formatting"})}},c:function(a,b,c,d){let e=a.getDay(),f=(e-d.weekStartsOn+8)%7||7;switch(b){case"c":return String(f);case"cc":return O(f,b.length);case"co":return c.ordinalNumber(f,{unit:"day"});case"ccc":return c.day(e,{width:"abbreviated",context:"standalone"});case"ccccc":return c.day(e,{width:"narrow",context:"standalone"});case"cccccc":return c.day(e,{width:"short",context:"standalone"});default:return c.day(e,{width:"wide",context:"standalone"})}},i:function(a,b,c){let d=a.getDay(),e=0===d?7:d;switch(b){case"i":return String(e);case"ii":return O(e,b.length);case"io":return c.ordinalNumber(e,{unit:"day"});case"iii":return c.day(d,{width:"abbreviated",context:"formatting"});case"iiiii":return c.day(d,{width:"narrow",context:"formatting"});case"iiiiii":return c.day(d,{width:"short",context:"formatting"});default:return c.day(d,{width:"wide",context:"formatting"})}},a:function(a,b,c){let d=a.getHours()/12>=1?"pm":"am";switch(b){case"a":case"aa":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"aaa":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return c.dayPeriod(d,{width:"narrow",context:"formatting"});default:return c.dayPeriod(d,{width:"wide",context:"formatting"})}},b:function(a,b,c){let d,e=a.getHours();switch(d=12===e?Q.noon:0===e?Q.midnight:e/12>=1?"pm":"am",b){case"b":case"bb":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"bbb":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return c.dayPeriod(d,{width:"narrow",context:"formatting"});default:return c.dayPeriod(d,{width:"wide",context:"formatting"})}},B:function(a,b,c){let d,e=a.getHours();switch(d=e>=17?Q.evening:e>=12?Q.afternoon:e>=4?Q.morning:Q.night,b){case"B":case"BB":case"BBB":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"BBBBB":return c.dayPeriod(d,{width:"narrow",context:"formatting"});default:return c.dayPeriod(d,{width:"wide",context:"formatting"})}},h:function(a,b,c){if("ho"===b){let b=a.getHours()%12;return 0===b&&(b=12),c.ordinalNumber(b,{unit:"hour"})}return P.h(a,b)},H:function(a,b,c){return"Ho"===b?c.ordinalNumber(a.getHours(),{unit:"hour"}):P.H(a,b)},K:function(a,b,c){let d=a.getHours()%12;return"Ko"===b?c.ordinalNumber(d,{unit:"hour"}):O(d,b.length)},k:function(a,b,c){let d=a.getHours();return(0===d&&(d=24),"ko"===b)?c.ordinalNumber(d,{unit:"hour"}):O(d,b.length)},m:function(a,b,c){return"mo"===b?c.ordinalNumber(a.getMinutes(),{unit:"minute"}):P.m(a,b)},s:function(a,b,c){return"so"===b?c.ordinalNumber(a.getSeconds(),{unit:"second"}):P.s(a,b)},S:function(a,b){return P.S(a,b)},X:function(a,b,c){let d=a.getTimezoneOffset();if(0===d)return"Z";switch(b){case"X":return T(d);case"XXXX":case"XX":return U(d);default:return U(d,":")}},x:function(a,b,c){let d=a.getTimezoneOffset();switch(b){case"x":return T(d);case"xxxx":case"xx":return U(d);default:return U(d,":")}},O:function(a,b,c){let d=a.getTimezoneOffset();switch(b){case"O":case"OO":case"OOO":return"GMT"+S(d,":");default:return"GMT"+U(d,":")}},z:function(a,b,c){let d=a.getTimezoneOffset();switch(b){case"z":case"zz":case"zzz":return"GMT"+S(d,":");default:return"GMT"+U(d,":")}},t:function(a,b,c){return O(Math.trunc(a/1e3),b.length)},T:function(a,b,c){return O(+a,b.length)}};function S(a,b=""){let c=a>0?"-":"+",d=Math.abs(a),e=Math.trunc(d/60),f=d%60;return 0===f?c+String(e):c+String(e)+b+O(f,2)}function T(a,b){return a%60==0?(a>0?"-":"+")+O(Math.abs(a)/60,2):U(a,b)}function U(a,b=""){let c=Math.abs(a);return(a>0?"-":"+")+O(Math.trunc(c/60),2)+b+O(c%60,2)}let V=(a,b)=>{switch(a){case"P":return b.date({width:"short"});case"PP":return b.date({width:"medium"});case"PPP":return b.date({width:"long"});default:return b.date({width:"full"})}},W=(a,b)=>{switch(a){case"p":return b.time({width:"short"});case"pp":return b.time({width:"medium"});case"ppp":return b.time({width:"long"});default:return b.time({width:"full"})}},X={p:W,P:(a,b)=>{let c,d=a.match(/(P+)(p+)?/)||[],e=d[1],f=d[2];if(!f)return V(a,b);switch(e){case"P":c=b.dateTime({width:"short"});break;case"PP":c=b.dateTime({width:"medium"});break;case"PPP":c=b.dateTime({width:"long"});break;default:c=b.dateTime({width:"full"})}return c.replace("{{date}}",V(e,b)).replace("{{time}}",W(f,b))}},Y=/^D+$/,Z=/^Y+$/,$=["D","DD","YY","YYYY"],_=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,aa=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ab=/^'([^]*?)'?$/,ac=/''/g,ad=/[a-zA-Z]/;function ae(a,b,c){let d=c?.locale??E.locale??D,e=c?.firstWeekContainsDate??c?.locale?.options?.firstWeekContainsDate??E.firstWeekContainsDate??E.locale?.options?.firstWeekContainsDate??1,f=c?.weekStartsOn??c?.locale?.options?.weekStartsOn??E.weekStartsOn??E.locale?.options?.weekStartsOn??0,g=H(a,c?.in);if(!(g instanceof Date||"object"==typeof g&&"[object Date]"===Object.prototype.toString.call(g))&&"number"!=typeof g||isNaN(+H(g)))throw RangeError("Invalid time value");let h=b.match(aa).map(a=>{let b=a[0];return"p"===b||"P"===b?(0,X[b])(a,d.formatLong):a}).join("").match(_).map(a=>{if("''"===a)return{isToken:!1,value:"'"};let b=a[0];if("'"===b)return{isToken:!1,value:function(a){let b=a.match(ab);return b?b[1].replace(ac,"'"):a}(a)};if(R[b])return{isToken:!0,value:a};if(b.match(ad))throw RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:a}});d.localize.preprocessor&&(h=d.localize.preprocessor(g,h));let i={firstWeekContainsDate:e,weekStartsOn:f,locale:d};return h.map(e=>{if(!e.isToken)return e.value;let f=e.value;return(!c?.useAdditionalWeekYearTokens&&Z.test(f)||!c?.useAdditionalDayOfYearTokens&&Y.test(f))&&function(a,b,c){let d=function(a,b,c){let d="Y"===a[0]?"years":"days of the month";return`Use \`${a.toLowerCase()}\` instead of \`${a}\` (in \`${b}\`) for formatting ${d} to the input \`${c}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(a,b,c);if(console.warn(d),$.includes(a))throw RangeError(d)}(f,b,String(a)),(0,R[f[0]])(g,f,d.localize,i)}).join("")}function af({searchQuery:a,filters:b,onEditOrder:c}){let[d,e]=(0,s.useState)([]),[f,g]=(0,s.useState)(!0),[h,i]=(0,s.useState)(1),[j,k]=(0,s.useState)(1),[l,m]=(0,s.useState)(0),[n,o]=(0,s.useState)(0),[p,q]=(0,s.useState)("updated"),[t,u]=(0,s.useState)("desc"),v=function(a=9e5){let[b,c]=(0,s.useState)(new Map),d=(0,s.useRef)(void 0);(0,s.useEffect)(()=>(d.current=setInterval(()=>{c(a=>{let b=Date.now(),c=new Map;for(let[d,e]of a)b-e.timestamp<=e.ttl&&c.set(d,e);return c})},3e5),()=>{d.current&&clearInterval(d.current)}),[]);let e=(0,s.useCallback)(a=>{let d=b.get(a);return d?Date.now()-d.timestamp>d.ttl?(c(b=>{let c=new Map(b);return c.delete(a),c}),null):(c(b=>{let c=new Map(b),d=c.get(a);return d&&c.set(a,{...d,accessCount:d.accessCount+1}),c}),d.data):null},[b]),f=(0,s.useCallback)((b,d,e)=>{c(c=>{let f=new Map(c);if(f.size>100){let a=Array.from(f.entries());a.sort((a,b)=>a[1].accessCount-b[1].accessCount),a.slice(0,20).forEach(([a])=>f.delete(a))}return f.set(b,{data:d,timestamp:Date.now(),ttl:e||a,accessCount:1}),f})},[a]);return{get:e,set:f,clear:(0,s.useCallback)(()=>{c(new Map)},[]),remove:(0,s.useCallback)(a=>{c(b=>{let c=new Map(b);return c.delete(a),c})},[])}}(6e5),x=(0,s.useCallback)(async a=>{let b=`sum_${a}`,c=v.get(b);if(c)return void o(c);try{let c=(await w.getOrders({page:1,perPage:100,sort:"-updated",filter:a})).items.filter(a=>a.approved).reduce((a,b)=>a+(b.final_price||0),0);v.set(b,c,6e5),o(c)}catch{o(0)}},[v]),y=async a=>{try{let b={...a,invoice_sent:!a.invoice_sent};await w.updateOrder(a.id,b),e(b=>b.map(b=>b.id===a.id?{...b,invoice_sent:!b.invoice_sent}:b))}catch(a){console.error("Error updating invoice status:",a)}},z=(0,s.useCallback)(c=>{let d=[...c];if(a.trim()){let b=a.toLowerCase();d=d.filter(a=>a.client.toLowerCase().includes(b)||a.agency.toLowerCase().includes(b)||a.invoice_id.toLowerCase().includes(b))}return b.status&&("taip"===b.status?d=d.filter(a=>!0===a.approved):"ne"===b.status&&(d=d.filter(a=>!1===a.approved))),b.client&&(d=d.filter(a=>a.client.toLowerCase().includes(b.client.toLowerCase()))),b.agency&&(d=d.filter(a=>a.agency.toLowerCase().includes(b.agency.toLowerCase()))),b.media_received&&("true"===b.media_received?d=d.filter(a=>!0===a.media_received):"false"===b.media_received&&(d=d.filter(a=>!1===a.media_received))),b.month&&b.year&&(d=d.filter(a=>{let c=new Date(a.from),d=c.getMonth()+1,e=c.getFullYear();return d===parseInt(b.month)&&e===parseInt(b.year)})),d},[a,b]),A=(0,s.useCallback)(a=>[...a].sort((a,b)=>{let c,d;switch(p){case"client":case"agency":case"invoice_id":c=a[p]?.toLowerCase()||"",d=b[p]?.toLowerCase()||"";break;case"final_price":c=Number(a.final_price)||0,d=Number(b.final_price)||0;break;case"from":case"to":case"updated":c=new Date(a[p]),d=new Date(b[p]);break;case"approved":c=+!!a.approved,d=+!!b.approved;break;case"media_received":c=+!!a.media_received,d=+!!b.media_received;break;default:c=a[p],d=b[p]}return c<d?"asc"===t?-1:1:c>d?"asc"===t?1:-1:0}),[p,t]),B=(0,s.useCallback)(()=>{let c=[];if(console.log("🔍 Building filter string with:",{searchQuery:a,filters:b}),a.trim()&&(a.toLowerCase().startsWith("viad")?(c.push(`(client~"${a}" || agency~"${a}" || invoice_id~"${a}" || viaduct=true)`),console.log('🔍 Added viaduct filter for "viad" search'),console.log('🔍 Search query starts with "viad", adding viaduct=true filter')):(c.push(`(client~"${a}" || agency~"${a}" || invoice_id~"${a}")`),console.log("🔍 Regular search filter added")),console.log("🔍 Search query:",a)),b.status&&("taip"===b.status?(c.push("approved=true"),console.log("🔍 Added status filter: approved=true")):"ne"===b.status&&(c.push("approved=false"),console.log("🔍 Added status filter: approved=false"))),b.client.trim()&&(c.push(`client~"${b.client}"`),console.log("🔍 Added client filter:",b.client)),b.agency.trim()&&(c.push(`agency~"${b.agency}"`),console.log("🔍 Added agency filter:",b.agency)),b.media_received&&("true"===b.media_received?(c.push("media_received=true"),console.log("🔍 Added media filter: media_received=true")):"false"===b.media_received&&(c.push("media_received=false"),console.log("🔍 Added media filter: media_received=false"))),b.month&&b.year){let a=`${b.year}-${b.month.padStart(2,"0")}-01`,d=`${b.year}-${b.month.padStart(2,"0")}-31`;c.push(`(from<="${d}" && to>="${a}")`),console.log("🔍 Added date filter:",{startDate:a,endDate:d,month:b.month,year:b.year})}if(0===c.length)return console.log("🔍 No filters applied, returning empty string"),"";let d=c.join(" && ");return console.log("🔍 Final filter string:",d),d},[a,b]),C=a=>{p===a?u(a=>"asc"===a?"desc":"asc"):(q(a),u("asc"))},D=a=>p!==a?(0,r.jsx)("svg",{className:"w-3 h-3 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})}):"asc"===t?(0,r.jsx)("svg",{className:"w-3 h-3 text-blue-500 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 9l4-4 4 4"})}):(0,r.jsx)("svg",{className:"w-3 h-3 text-blue-500 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 15l4 4 4-4"})}),E=a=>{try{return ae(new Date(a),"yyyy-MM-dd")}catch{return a}};return((0,s.useEffect)(()=>{(async()=>{try{g(!0);let c=B();console.log("🔍 PocketBase filter string:",c),console.log("🔍 Current filters:",b),console.log("🔍 Search query:",a),console.log("🔍 Sort field:",p,"direction:",t);let d=await w.getOrders({page:h,perPage:20,sort:`${"desc"===t?"-":""}${p}`,filter:c});console.log("✅ PocketBase response:",d),console.log("🔍 Filter string sent to PocketBase:",c),console.log("🔍 Current filters:",b),console.log("🔍 Search query:",a);let f=d.items.find(a=>a.client.includes("GO3")||a.client.includes("Viadukai"));f?(console.log("🔍 Found GO3 - Viadukai order:",f),console.log("🔍 Order dates:",{from:f.from,to:f.to}),console.log("🔍 Order approved:",f.approved),console.log("🔍 Order viaduct:",f.viaduct),console.log("🔍 All orders from PocketBase:",d.items),console.log("🔍 Orders with viaduct=true:",d.items.filter(a=>a.viaduct))):console.log("❌ GO3 - Viadukai order not found in response"),console.log("🔍 All orders from PocketBase:",d.items),console.log("🔍 Orders with viaduct=true:",d.items.filter(a=>a.viaduct)),console.log("🔍 Orders with viaduct=false:",d.items.filter(a=>!a.viaduct)),e(d.items),k(d.totalPages),m(d.totalItems),x(c)}catch(b){console.error("❌ Failed to fetch orders:",b);let a=A(z([{id:"1",client:"Ansamblis LIETUVA",agency:"PUBLICIS GROUPE",invoice_id:"3481",approved:!0,viaduct:!1,from:"2025-08-25",to:"2025-09-07",media_received:!0,final_price:1150.64,invoice_sent:!1,updated:"2025-08-22T13:37:44Z"},{id:"2",client:"Perlas momentinės 08 25-08 31",agency:"Open",invoice_id:"3545",approved:!0,viaduct:!1,from:"2025-08-25",to:"2025-08-31",media_received:!0,final_price:5618.25,invoice_sent:!1,updated:"2025-08-22T13:34:37Z"},{id:"3",client:"CCC back to school",agency:"OMG",invoice_id:"3546",approved:!1,viaduct:!0,from:"2025-09-08",to:"2025-09-14",media_received:!1,final_price:282.33,invoice_sent:!1,updated:"2025-08-22T13:23:39Z"},{id:"4",client:"Maxima",agency:"DDB",invoice_id:"3547",approved:!0,viaduct:!1,from:"2025-09-01",to:"2025-09-15",media_received:!0,final_price:1250,invoice_sent:!0,updated:"2025-08-22T14:00:00Z"},{id:"5",client:"Lidl",agency:"McCann",invoice_id:"3548",approved:!1,viaduct:!0,from:"2025-09-10",to:"2025-09-20",media_received:!1,final_price:890.5,invoice_sent:!1,updated:"2025-08-22T14:30:00Z"}]));e(a),k(1),m(a.length)}finally{g(!1)}})()},[h,a,b,p,t,B,z,A]),f)?(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Kraunama..."})]})}):(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Užsakymai (",l,")",n>0&&(0,r.jsxs)("span",{className:"ml-2 text-sm font-normal text-green-600 dark:text-green-400",children:["- Suma: €",n.toLocaleString("lt-LT",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),p&&(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Rūšiuojama pagal: ",(0,r.jsx)("span",{className:"font-medium",children:p}),"(","asc"===t?"didėjimo":"mažėjimo"," tvarka)"]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Puslapis ",h," iš ",j]})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,r.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("client"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Klientas"}),D("client")]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("agency"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Agentūra"}),D("agency")]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("invoice_id"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Užsakymo Nr."}),D("invoice_id")]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("approved"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Statusas"}),D("approved")]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("from"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Data nuo"}),D("from")]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("to"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Data iki"}),D("to")]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("media_received"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Media gautas"}),D("media_received")]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("final_price"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Kaina"}),D("final_price")]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("invoice_sent"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Sąskaita"}),D("invoice_sent")]})})]})}),(0,r.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:d.map(a=>{let b;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors",onClick:()=>c(a),children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[a.viaduct&&(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Viadukai"}),(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[a.client,(a=>{if(!a.approved||a.media_received)return!1;try{let b=new Date(a.from),c=new Date,d=b.getTime()-c.getTime();return 2>=Math.ceil(d/864e5)}catch{return!1}})(a)&&(0,r.jsx)("span",{className:"ml-2 text-red-600 animate-pulse",children:"⚠️"})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.agency||"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:a.invoice_id})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a.approved?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:a.approved?"Patvirtinta":"Nepatvirtinta"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:E(a.from)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:E(a.to)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a.media_received?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:a.media_received?"Taip":"Ne"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(b=a.final_price,new Intl.NumberFormat("lt-LT",{style:"currency",currency:"EUR"}).format(b))})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:b=>{b.stopPropagation(),y(a)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${a.invoice_sent?"bg-green-300":"bg-gray-200"}`,children:(0,r.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.invoice_sent?"translate-x-6":"translate-x-1"}`})})})]},a.id)})})]})}),j>1&&(0,r.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Rodoma ",(h-1)*20+1," - ",Math.min(20*h,l)," iš ",l," rezultatų"]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>i(Math.max(1,h-1)),disabled:1===h,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Ankstesnis"}),(0,r.jsx)("button",{onClick:()=>i(Math.min(j,h+1)),disabled:h===j,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Sekantis"})]})]})})]})}let ag=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"}))}),ah=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"}))}),ai=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});function aj({onAddOrder:a,isDarkMode:b,onToggleDarkMode:c}){return(0,r.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("div",{className:"container mx-auto px-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-bold text-xl",children:"P"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Piksel Orders"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Užsakymų valdymas"})]})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:c,className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:b?(0,r.jsx)(ag,{className:"w-5 h-5"}):(0,r.jsx)(ah,{className:"w-5 h-5"})}),(0,r.jsxs)("button",{onClick:a,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-medium rounded-lg hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl",children:[(0,r.jsx)(ai,{className:"w-5 h-5 mr-2"}),"Pridėti užsakymą"]})]})]})})})}let ak=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}),al=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))});function am({searchQuery:a,onSearchChange:b,filters:c,onFiltersChange:d}){let e=[{value:"01",label:"Sausis"},{value:"02",label:"Vasaris"},{value:"03",label:"Kovas"},{value:"04",label:"Balandis"},{value:"05",label:"Gegužė"},{value:"06",label:"Birželis"},{value:"07",label:"Liepa"},{value:"08",label:"Rugpjūtis"},{value:"09",label:"Rugsėjis"},{value:"10",label:"Spalis"},{value:"11",label:"Lapkritis"},{value:"12",label:"Gruodis"}],f=Array.from({length:5},(a,b)=>new Date().getFullYear()-2+b),g=[{value:"",label:"Visi statusai"},{value:"taip",label:"Patvirtinta"},{value:"ne",label:"Nepatvirtinta"},{value:"rezervuota",label:"Rezervuota"},{value:"atšaukta",label:"Atšaukta"}],h=[{value:"",label:"Visi media"},{value:"true",label:"Media gautas"},{value:"false",label:"Media negautas"}],i=(a,b)=>{d({...c,[a]:b})};return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Paieška"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(ak,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Ieškoti pagal klientą, agentūrą, užsakymo Nr...",value:a,onChange:a=>b(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Filtrai"}),("taip"===c.status||c.month||c.year)&&(0,r.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-3 py-2 rounded-md",children:["ℹ️ Aktyvūs filtrai: ","taip"===c.status?"Patvirtinta, ":"",c.month?`${e.find(a=>a.value===c.month)?.label}, `:"",c.year?`${c.year} metai`:""]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,r.jsx)("select",{value:c.status,onChange:a=>i("status",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm",children:g.map(a=>(0,r.jsx)("option",{value:a.value,children:a.label},a.value))}),(0,r.jsxs)("select",{value:c.month,onChange:a=>i("month",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm",children:[(0,r.jsx)("option",{value:"",children:"Visi mėnesiai"}),e.map(a=>(0,r.jsx)("option",{value:a.value,children:a.label},a.value))]}),(0,r.jsxs)("select",{value:c.year,onChange:a=>i("year",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm",children:[(0,r.jsx)("option",{value:"",children:"Visi metai"}),f.map(a=>(0,r.jsx)("option",{value:a.toString(),children:a},a))]}),(0,r.jsx)("select",{value:c.media_received,onChange:a=>i("media_received",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm",children:h.map(a=>(0,r.jsx)("option",{value:a.value,children:a.label},a.value))}),(0,r.jsx)("input",{type:"text",placeholder:"Klientas",value:c.client,onChange:a=>i("client",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm"}),(0,r.jsx)("input",{type:"text",placeholder:"Agentūra",value:c.agency,onChange:a=>i("agency",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm"})]})]})]}),(c.status||c.month||c.year||c.client||c.agency)&&(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(al,{className:"w-4 h-4 text-gray-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Aktyvūs filtrai:"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[c.status&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:["Statusas: ",g.find(a=>a.value===c.status)?.label,(0,r.jsx)("button",{onClick:()=>i("status",""),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]}),c.month&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:["Mėnuo: ",e.find(a=>a.value===c.month)?.label,(0,r.jsx)("button",{onClick:()=>i("month",""),className:"ml-1 text-green-600 hover:text-green-800",children:"×"})]}),c.year&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",children:["Metai: ",c.year,(0,r.jsx)("button",{onClick:()=>i("year",""),className:"ml-1 text-purple-600 hover:text-purple-800",children:"×"})]}),c.client&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",children:["Klientas: ",c.client,(0,r.jsx)("button",{onClick:()=>i("client",""),className:"ml-1 text-orange-600 hover:text-orange-800",children:"×"})]}),c.agency&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200",children:["Agentūra: ",c.agency,(0,r.jsx)("button",{onClick:()=>i("agency",""),className:"ml-1 text-indigo-600 hover:text-indigo-800",children:"×"})]}),c.media_received&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200",children:["Media: ",h.find(a=>a.value===c.media_received)?.label,(0,r.jsx)("button",{onClick:()=>i("media_received",""),className:"ml-1 text-teal-600 hover:text-teal-800",children:"×"})]})]})]})})]})}var an=(a=>(a.Space=" ",a.Enter="Enter",a.Escape="Escape",a.Backspace="Backspace",a.Delete="Delete",a.ArrowLeft="ArrowLeft",a.ArrowUp="ArrowUp",a.ArrowRight="ArrowRight",a.ArrowDown="ArrowDown",a.Home="Home",a.End="End",a.PageUp="PageUp",a.PageDown="PageDown",a.Tab="Tab",a))(an||{}),ao=Object.defineProperty,ap=(a,b,c)=>(((a,b,c)=>b in a?ao(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c),c);let aq=new class{constructor(){ap(this,"current",this.detect()),ap(this,"handoffState","pending"),ap(this,"currentId",0)}set(a){this.current!==a&&(this.handoffState="pending",this.currentId=0,this.current=a)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"server"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}},ar=(a,b)=>{aq.isServer?(0,s.useEffect)(a,b):(0,s.useLayoutEffect)(a,b)};function as(a){let b=(0,s.useRef)(a);return ar(()=>{b.current=a},[a]),b}function at(a,b,c,d){let e=as(c);(0,s.useEffect)(()=>{function c(a){e.current(a)}return(a=null!=a?a:window).addEventListener(b,c,d),()=>a.removeEventListener(b,c,d)},[a,b,d])}class au extends Map{constructor(a){super(),this.factory=a}get(a){let b=super.get(a);return void 0===b&&(b=this.factory(a),this.set(a,b)),b}}function av(a){"function"==typeof queueMicrotask?queueMicrotask(a):Promise.resolve().then(a).catch(a=>setTimeout(()=>{throw a}))}function aw(){let a=[],b={addEventListener:(a,c,d,e)=>(a.addEventListener(c,d,e),b.add(()=>a.removeEventListener(c,d,e))),requestAnimationFrame(...a){let c=requestAnimationFrame(...a);return b.add(()=>cancelAnimationFrame(c))},nextFrame:(...a)=>b.requestAnimationFrame(()=>b.requestAnimationFrame(...a)),setTimeout(...a){let c=setTimeout(...a);return b.add(()=>clearTimeout(c))},microTask(...a){let c={current:!0};return av(()=>{c.current&&a[0]()}),b.add(()=>{c.current=!1})},style(a,b,c){let d=a.style.getPropertyValue(b);return Object.assign(a.style,{[b]:c}),this.add(()=>{Object.assign(a.style,{[b]:d})})},group(a){let b=aw();return a(b),this.add(()=>b.dispose())},add:b=>(a.includes(b)||a.push(b),()=>{let c=a.indexOf(b);if(c>=0)for(let b of a.splice(c,1))b()}),dispose(){for(let b of a.splice(0))b()}};return b}var ax=Object.defineProperty,ay=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot "+c)},az=(a,b,c)=>(ay(a,b,"read from private field"),c?c.call(a):b.get(a)),aA=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},aB=(a,b,c,d)=>(ay(a,b,"write to private field"),d?d.call(a,c):b.set(a,c),c);class aC{constructor(a){aA(this,b,{}),aA(this,c,new au(()=>new Set)),aA(this,d,new Set),((a,b,c)=>((a,b,c)=>b in a?ax(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c))(this,"disposables",aw()),aB(this,b,a),aq.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return az(this,b)}subscribe(a,c){if(aq.isServer)return()=>{};let e={selector:a,callback:c,current:a(az(this,b))};return az(this,d).add(e),this.disposables.add(()=>{az(this,d).delete(e)})}on(a,b){return aq.isServer?()=>{}:(az(this,c).get(a).add(b),this.disposables.add(()=>{az(this,c).get(a).delete(b)}))}send(a){let e=this.reduce(az(this,b),a);if(e!==az(this,b)){for(let a of(aB(this,b,e),az(this,d))){let c=a.selector(az(this,b));aD(a.current,c)||(a.current=c,a.callback(c))}for(let d of az(this,c).get(a.type))d(az(this,b),a)}}}function aD(a,b){return!!Object.is(a,b)||"object"==typeof a&&null!==a&&"object"==typeof b&&null!==b&&(Array.isArray(a)&&Array.isArray(b)?a.length===b.length&&aE(a[Symbol.iterator](),b[Symbol.iterator]()):a instanceof Map&&b instanceof Map||a instanceof Set&&b instanceof Set?a.size===b.size&&aE(a.entries(),b.entries()):!!(aF(a)&&aF(b))&&aE(Object.entries(a)[Symbol.iterator](),Object.entries(b)[Symbol.iterator]()))}function aE(a,b){for(;;){let c=a.next(),d=b.next();if(c.done&&d.done)return!0;if(c.done||d.done||!Object.is(c.value,d.value))return!1}}function aF(a){if("[object Object]"!==Object.prototype.toString.call(a))return!1;let b=Object.getPrototypeOf(a);return null===b||null===Object.getPrototypeOf(b)}function aG(a,b,...c){if(a in b){let d=b[a];return"function"==typeof d?d(...c):d}let d=Error(`Tried to handle "${a}" but there is no handler defined. Only defined handlers are: ${Object.keys(b).map(a=>`"${a}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(d,aG),d}b=new WeakMap,c=new WeakMap,d=new WeakMap;var aH=Object.defineProperty,aI=(a,b,c)=>(((a,b,c)=>b in a?aH(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c),c),aJ=(a=>(a[a.Push=0]="Push",a[a.Pop=1]="Pop",a))(aJ||{});let aK={0(a,b){let c=b.id,d=a.stack,e=a.stack.indexOf(c);if(-1!==e){let b=a.stack.slice();return b.splice(e,1),b.push(c),d=b,{...a,stack:d}}return{...a,stack:[...a.stack,c]}},1(a,b){let c=b.id,d=a.stack.indexOf(c);if(-1===d)return a;let e=a.stack.slice();return e.splice(d,1),{...a,stack:e}}};class aL extends aC{constructor(){super(...arguments),aI(this,"actions",{push:a=>this.send({type:0,id:a}),pop:a=>this.send({type:1,id:a})}),aI(this,"selectors",{isTop:(a,b)=>a.stack[a.stack.length-1]===b,inStack:(a,b)=>a.stack.includes(b)})}static new(){return new aL({stack:[]})}reduce(a,b){return aG(b.type,aK,a,b)}}let aM=new au(()=>aL.new());var aN=a.i(32473);let aO=function(a){let b=as(a);return s.default.useCallback((...a)=>b.current(...a),[b])};function aP(a,b,c=aD){return(0,aN.useSyncExternalStoreWithSelector)(aO(b=>a.subscribe(aQ,b)),aO(()=>a.state),aO(()=>a.state),aO(b),c)}function aQ(a){return a}function aR(a,b){let c=(0,s.useId)(),d=aM.get(b),[e,f]=aP(d,(0,s.useCallback)(a=>[d.selectors.isTop(a,c),d.selectors.inStack(a,c)],[d,c]));return ar(()=>{if(a)return d.actions.push(c),()=>d.actions.pop(c)},[d,a,c]),!!a&&(!f||e)}function aS(a){var b,c;return aq.isServer?null:a?"ownerDocument"in a?a.ownerDocument:"current"in a?null!=(c=null==(b=a.current)?void 0:b.ownerDocument)?c:document:null:document}let aT=new Map,aU=new Map;function aV(a){var b;let c=null!=(b=aU.get(a))?b:0;return aU.set(a,c+1),0!==c||(aT.set(a,{"aria-hidden":a.getAttribute("aria-hidden"),inert:a.inert}),a.setAttribute("aria-hidden","true"),a.inert=!0),()=>(function(a){var b;let c=null!=(b=aU.get(a))?b:1;if(1===c?aU.delete(a):aU.set(a,c-1),1!==c)return;let d=aT.get(a);d&&(null===d["aria-hidden"]?a.removeAttribute("aria-hidden"):a.setAttribute("aria-hidden",d["aria-hidden"]),a.inert=d.inert,aT.delete(a))})(a)}function aW(a){return"object"==typeof a&&null!==a&&"nodeType"in a}function aX(a){return aW(a)&&"tagName"in a}function aY(a){return aX(a)&&"accessKey"in a}function aZ(a){return aX(a)&&"tabIndex"in a}let a$=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(a=>`${a}:not([tabindex='-1'])`).join(","),a_=["[data-autofocus]"].map(a=>`${a}:not([tabindex='-1'])`).join(",");var a0=(a=>(a[a.First=1]="First",a[a.Previous=2]="Previous",a[a.Next=4]="Next",a[a.Last=8]="Last",a[a.WrapAround=16]="WrapAround",a[a.NoScroll=32]="NoScroll",a[a.AutoFocus=64]="AutoFocus",a))(a0||{}),a1=(a=>(a[a.Error=0]="Error",a[a.Overflow=1]="Overflow",a[a.Success=2]="Success",a[a.Underflow=3]="Underflow",a))(a1||{}),a2=(a=>(a[a.Previous=-1]="Previous",a[a.Next=1]="Next",a))(a2||{}),a3=(a=>(a[a.Strict=0]="Strict",a[a.Loose=1]="Loose",a))(a3||{}),a4=(a=>(a[a.Keyboard=0]="Keyboard",a[a.Mouse=1]="Mouse",a))(a4||{});function a5(a){null==a||a.focus({preventScroll:!0})}function a6(a,b,{sorted:c=!0,relativeTo:d=null,skipElements:e=[]}={}){var f,g,h;let i=Array.isArray(a)?a.length>0?a[0].ownerDocument:document:a.ownerDocument,j=Array.isArray(a)?c?function(a,b=a=>a){return a.slice().sort((a,c)=>{let d=b(a),e=b(c);if(null===d||null===e)return 0;let f=d.compareDocumentPosition(e);return f&Node.DOCUMENT_POSITION_FOLLOWING?-1:f&Node.DOCUMENT_POSITION_PRECEDING?1:0})}(a):a:64&b?function(a=document.body){return null==a?[]:Array.from(a.querySelectorAll(a_)).sort((a,b)=>Math.sign((a.tabIndex||Number.MAX_SAFE_INTEGER)-(b.tabIndex||Number.MAX_SAFE_INTEGER)))}(a):function(a=document.body){return null==a?[]:Array.from(a.querySelectorAll(a$)).sort((a,b)=>Math.sign((a.tabIndex||Number.MAX_SAFE_INTEGER)-(b.tabIndex||Number.MAX_SAFE_INTEGER)))}(a);e.length>0&&j.length>1&&(j=j.filter(a=>!e.some(b=>null!=b&&"current"in b?(null==b?void 0:b.current)===a:b===a))),d=null!=d?d:i.activeElement;let k=(()=>{if(5&b)return 1;if(10&b)return -1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(1&b)return 0;if(2&b)return Math.max(0,j.indexOf(d))-1;if(4&b)return Math.max(0,j.indexOf(d))+1;if(8&b)return j.length-1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),m=32&b?{preventScroll:!0}:{},n=0,o=j.length,p;do{if(n>=o||n+o<=0)return 0;let a=l+n;if(16&b)a=(a+o)%o;else{if(a<0)return 3;if(a>=o)return 1}null==(p=j[a])||p.focus(m),n+=k}while(p!==i.activeElement)return 6&b&&null!=(h=null==(g=null==(f=p)?void 0:f.matches)?void 0:g.call(f,"textarea,input"))&&h&&p.select(),2}function a7(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function a8(){return a7()||/Android/gi.test(window.navigator.userAgent)}function a9(a,b,c,d){let e=as(c);(0,s.useEffect)(()=>{if(a)return document.addEventListener(b,c,d),()=>document.removeEventListener(b,c,d);function c(a){e.current(a)}},[a,b,d])}function ba(a,b,c,d){let e=as(c);(0,s.useEffect)(()=>{if(a)return window.addEventListener(b,c,d),()=>window.removeEventListener(b,c,d);function c(a){e.current(a)}},[a,b,d])}function bb(...a){return(0,s.useMemo)(()=>aS(...a),[...a])}function bc(...a){return Array.from(new Set(a.flatMap(a=>"string"==typeof a?a.split(" "):[]))).filter(Boolean).join(" ")}var bd=(a=>(a[a.None=0]="None",a[a.RenderStrategy=1]="RenderStrategy",a[a.Static=2]="Static",a))(bd||{}),be=(a=>(a[a.Unmount=0]="Unmount",a[a.Hidden=1]="Hidden",a))(be||{});function bf(){let a,b,c=(a=(0,s.useRef)([]),b=(0,s.useCallback)(b=>{for(let c of a.current)null!=c&&("function"==typeof c?c(b):c.current=b)},[]),(...c)=>{if(!c.every(a=>null==a))return a.current=c,b});return(0,s.useCallback)(a=>(function({ourProps:a,theirProps:b,slot:c,defaultTag:d,features:e,visible:f=!0,name:g,mergeRefs:h}){h=null!=h?h:bh;let i=bi(b,a);if(f)return bg(i,c,d,g,h);let j=null!=e?e:0;if(2&j){let{static:a=!1,...b}=i;if(a)return bg(b,c,d,g,h)}if(1&j){let{unmount:a=!0,...b}=i;return aG(+!a,{0:()=>null,1:()=>bg({...b,hidden:!0,style:{display:"none"}},c,d,g,h)})}return bg(i,c,d,g,h)})({mergeRefs:c,...a}),[c])}function bg(a,b={},c,d,e){let{as:f=c,children:g,refName:h="ref",...i}=bl(a,["unmount","static"]),j=void 0!==a.ref?{[h]:a.ref}:{},k="function"==typeof g?g(b):g;"className"in i&&i.className&&"function"==typeof i.className&&(i.className=i.className(b)),i["aria-labelledby"]&&i["aria-labelledby"]===i.id&&(i["aria-labelledby"]=void 0);let l={};if(b){let a=!1,c=[];for(let[d,e]of Object.entries(b))"boolean"==typeof e&&(a=!0),!0===e&&c.push(d.replace(/([A-Z])/g,a=>`-${a.toLowerCase()}`));if(a)for(let a of(l["data-headlessui-state"]=c.join(" "),c))l[`data-${a}`]=""}if(f===s.Fragment&&(Object.keys(bk(i)).length>0||Object.keys(bk(l)).length>0))if(!(0,s.isValidElement)(k)||Array.isArray(k)&&k.length>1){if(Object.keys(bk(i)).length>0)throw Error(['Passing props on "Fragment"!',"",`The current component <${d} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(bk(i)).concat(Object.keys(bk(l))).map(a=>`  - ${a}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(a=>`  - ${a}`).join(`
`)].join(`
`))}else{var m;let a=k.props,b=null==a?void 0:a.className,c="function"==typeof b?(...a)=>bc(b(...a),i.className):bc(b,i.className),d=bi(k.props,bk(bl(i,["ref"])));for(let a in l)a in d&&delete l[a];return(0,s.cloneElement)(k,Object.assign({},d,l,j,{ref:e((m=k,s.default.version.split(".")[0]>="19"?m.props.ref:m.ref),j.ref)},c?{className:c}:{}))}return(0,s.createElement)(f,Object.assign({},bl(i,["ref"]),f!==s.Fragment&&j,f!==s.Fragment&&l),k)}function bh(...a){return a.every(a=>null==a)?void 0:b=>{for(let c of a)null!=c&&("function"==typeof c?c(b):c.current=b)}}function bi(...a){if(0===a.length)return{};if(1===a.length)return a[0];let b={},c={};for(let d of a)for(let a in d)a.startsWith("on")&&"function"==typeof d[a]?(null!=c[a]||(c[a]=[]),c[a].push(d[a])):b[a]=d[a];if(b.disabled||b["aria-disabled"])for(let a in c)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(a)&&(c[a]=[a=>{var b;return null==(b=null==a?void 0:a.preventDefault)?void 0:b.call(a)}]);for(let a in c)Object.assign(b,{[a](b,...d){for(let e of c[a]){if((b instanceof Event||(null==b?void 0:b.nativeEvent)instanceof Event)&&b.defaultPrevented)return;e(b,...d)}}});return b}function bj(a){var b;return Object.assign((0,s.forwardRef)(a),{displayName:null!=(b=a.displayName)?b:a.name})}function bk(a){let b=Object.assign({},a);for(let a in b)void 0===b[a]&&delete b[a];return b}function bl(a,b=[]){let c=Object.assign({},a);for(let a of b)a in c&&delete c[a];return c}var bm=(a=>(a[a.None=1]="None",a[a.Focusable=2]="Focusable",a[a.Hidden=4]="Hidden",a))(bm||{});let bn=bj(function(a,b){var c;let{features:d=1,...e}=a,f={ref:b,"aria-hidden":(2&d)==2||(null!=(c=e["aria-hidden"])?c:void 0),hidden:(4&d)==4||void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(4&d)==4&&(2&d)!=2&&{display:"none"}}};return bf()({ourProps:f,theirProps:e,slot:{},defaultTag:"span",name:"Hidden"})}),bo=(0,s.createContext)(null);function bp({children:a,node:b}){let[c,d]=(0,s.useState)(null),e=bq(null!=b?b:c);return s.default.createElement(bo.Provider,{value:e},a,null===e&&s.default.createElement(bn,{features:bm.Hidden,ref:a=>{var b,c;if(a){for(let e of null!=(c=null==(b=aS(a))?void 0:b.querySelectorAll("html > *, body > *"))?c:[])if(e!==document.body&&e!==document.head&&aX(e)&&null!=e&&e.contains(a)){d(e);break}}}}))}function bq(a=null){var b;return null!=(b=(0,s.useContext)(bo))?b:a}let br=function(a,b){let c=a(),d=new Set;return{getSnapshot:()=>c,subscribe:a=>(d.add(a),()=>d.delete(a)),dispatch(a,...e){let f=b[a].call(c,...e);f&&(c=f,d.forEach(a=>a()))}}}(()=>new Map,{PUSH(a,b){var c;let d=null!=(c=this.get(a))?c:{doc:a,count:0,d:aw(),meta:new Set};return d.count++,d.meta.add(b),this.set(a,d),this},POP(a,b){let c=this.get(a);return c&&(c.count--,c.meta.delete(b)),this},SCROLL_PREVENT({doc:a,d:b,meta:c}){let d,e={doc:a,d:b,meta:function(a){let b={};for(let c of a)Object.assign(b,c(b));return b}(c)},f=[a7()?{before({doc:a,d:b,meta:c}){function d(a){return c.containers.flatMap(a=>a()).some(b=>b.contains(a))}b.microTask(()=>{var c;if("auto"!==window.getComputedStyle(a.documentElement).scrollBehavior){let c=aw();c.style(a.documentElement,"scrollBehavior","auto"),b.add(()=>b.microTask(()=>c.dispose()))}let e=null!=(c=window.scrollY)?c:window.pageYOffset,f=null;b.addEventListener(a,"click",b=>{if(aZ(b.target))try{let c=b.target.closest("a");if(!c)return;let{hash:e}=new URL(c.href),g=a.querySelector(e);aZ(g)&&!d(g)&&(f=g)}catch{}},!0),b.addEventListener(a,"touchstart",a=>{var c;if(aZ(a.target)&&aX(c=a.target)&&"style"in c)if(d(a.target)){let c=a.target;for(;c.parentElement&&d(c.parentElement);)c=c.parentElement;b.style(c,"overscrollBehavior","contain")}else b.style(a.target,"touchAction","none")}),b.addEventListener(a,"touchmove",a=>{if(aZ(a.target)){var b;if(!(aY(b=a.target)&&"INPUT"===b.nodeName))if(d(a.target)){let b=a.target;for(;b.parentElement&&""!==b.dataset.headlessuiPortal&&!(b.scrollHeight>b.clientHeight||b.scrollWidth>b.clientWidth);)b=b.parentElement;""===b.dataset.headlessuiPortal&&a.preventDefault()}else a.preventDefault()}},{passive:!1}),b.add(()=>{var a;e!==(null!=(a=window.scrollY)?a:window.pageYOffset)&&window.scrollTo(0,e),f&&f.isConnected&&(f.scrollIntoView({block:"nearest"}),f=null)})})}}:{},{before({doc:a}){var b;let c=a.documentElement;d=Math.max(0,(null!=(b=a.defaultView)?b:window).innerWidth-c.clientWidth)},after({doc:a,d:b}){let c=a.documentElement,e=Math.max(0,c.clientWidth-c.offsetWidth),f=Math.max(0,d-e);b.style(c,"paddingRight",`${f}px`)}},{before({doc:a,d:b}){b.style(a.documentElement,"overflow","hidden")}}];f.forEach(({before:a})=>null==a?void 0:a(e)),f.forEach(({after:a})=>null==a?void 0:a(e))},SCROLL_ALLOW({d:a}){a.dispose()},TEARDOWN({doc:a}){this.delete(a)}});function bs(){let a,b=(a="undefined"==typeof document,"useSyncExternalStore"in s&&(0,s.useSyncExternalStore)(()=>()=>{},()=>!1,()=>!a)),[c,d]=s.useState(aq.isHandoffComplete);return c&&!1===aq.isHandoffComplete&&d(!1),s.useEffect(()=>{!0!==c&&d(!0)},[c]),s.useEffect(()=>aq.handoff(),[]),!b&&c}br.subscribe(()=>{let a=br.getSnapshot(),b=new Map;for(let[c]of a)b.set(c,c.documentElement.style.overflow);for(let c of a.values()){let a="hidden"===b.get(c.doc),d=0!==c.count;(d&&!a||!d&&a)&&br.dispatch(c.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",c),0===c.count&&br.dispatch("TEARDOWN",c)}});let bt=Symbol();function bu(...a){let b=(0,s.useRef)(a);(0,s.useEffect)(()=>{b.current=a},[a]);let c=aO(a=>{for(let c of b.current)null!=c&&("function"==typeof c?c(a):c.current=a)});return a.every(a=>null==a||(null==a?void 0:a[bt]))?void 0:c}let bv=(0,s.createContext)(()=>{});function bw({value:a,children:b}){return s.default.createElement(bv.Provider,{value:a},b)}let bx=(0,s.createContext)(null);bx.displayName="OpenClosedContext";var by=(a=>(a[a.Open=1]="Open",a[a.Closed=2]="Closed",a[a.Closing=4]="Closing",a[a.Opening=8]="Opening",a))(by||{});function bz(){return(0,s.useContext)(bx)}function bA({value:a,children:b}){return s.default.createElement(bx.Provider,{value:a},b)}function bB({children:a}){return s.default.createElement(bx.Provider,{value:null},a)}let bC=(0,s.createContext)(!1);function bD(a){return s.default.createElement(bC.Provider,{value:a.force},a.children)}let bE=(0,s.createContext)(void 0),bF=(0,s.createContext)(null);bF.displayName="DescriptionContext";let bG=Object.assign(bj(function(a,b){let c=(0,s.useId)(),d=(0,s.useContext)(bE),{id:e=`headlessui-description-${c}`,...f}=a,g=function a(){let b=(0,s.useContext)(bF);if(null===b){let b=Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(b,a),b}return b}(),h=bu(b);ar(()=>g.register(e),[e,g.register]);let i=d||!1,j=(0,s.useMemo)(()=>({...g.slot,disabled:i}),[g.slot,i]),k={ref:h,...g.props,id:e};return bf()({ourProps:k,theirProps:f,slot:j,defaultTag:"p",name:g.name||"Description"})}),{});function bH(){let[a]=(0,s.useState)(aw);return(0,s.useEffect)(()=>()=>a.dispose(),[a]),a}function bI(){let a=(0,s.useRef)(!1);return ar(()=>(a.current=!0,()=>{a.current=!1}),[]),a}function bJ(a){let b=aO(a),c=(0,s.useRef)(!1);(0,s.useEffect)(()=>(c.current=!1,()=>{c.current=!0,av(()=>{c.current&&b()})}),[b])}var bK=(a=>(a[a.Forwards=0]="Forwards",a[a.Backwards=1]="Backwards",a))(bK||{});function bL(a,b){let c=(0,s.useRef)([]),d=aO(a);(0,s.useEffect)(()=>{let a=[...c.current];for(let[e,f]of b.entries())if(c.current[e]!==f){let e=d(b,a);return c.current=b,e}},[d,...b])}let bM=[];function bN(a){if(!a)return new Set;if("function"==typeof a)return new Set(a());let b=new Set;for(let c of a.current)aX(c.current)&&b.add(c.current);return b}!(()=>{function a(a){if(!aZ(a.target)||a.target===document.body||bM[0]===a.target)return;let b=a.target;b=b.closest(a$),bM.unshift(null!=b?b:a.target),(bM=bM.filter(a=>null!=a&&a.isConnected)).splice(10)}window.addEventListener("click",a,{capture:!0}),window.addEventListener("mousedown",a,{capture:!0}),window.addEventListener("focus",a,{capture:!0}),document.body.addEventListener("click",a,{capture:!0}),document.body.addEventListener("mousedown",a,{capture:!0}),document.body.addEventListener("focus",a,{capture:!0})});var bO=(a=>(a[a.None=0]="None",a[a.InitialFocus=1]="InitialFocus",a[a.TabLock=2]="TabLock",a[a.FocusLock=4]="FocusLock",a[a.RestoreFocus=8]="RestoreFocus",a[a.AutoFocus=16]="AutoFocus",a))(bO||{});let bP=Object.assign(bj(function(a,b){let c,d=(0,s.useRef)(null),e=bu(d,b),{initialFocus:f,initialFocusFallback:g,containers:h,features:i=15,...j}=a;bs()||(i=0);let k=bb(d);!function(a,{ownerDocument:b}){let c=!!(8&a),d=function(a=!0){let b=(0,s.useRef)(bM.slice());return bL(([a],[c])=>{!0===c&&!1===a&&av(()=>{b.current.splice(0)}),!1===c&&!0===a&&(b.current=bM.slice())},[a,bM,b]),aO(()=>{var a;return null!=(a=b.current.find(a=>null!=a&&a.isConnected))?a:null})}(c);bL(()=>{c||(null==b?void 0:b.activeElement)===(null==b?void 0:b.body)&&a5(d())},[c]),bJ(()=>{c&&a5(d())})}(i,{ownerDocument:k});let l=function(a,{ownerDocument:b,container:c,initialFocus:d,initialFocusFallback:e}){let f=(0,s.useRef)(null),g=aR(!!(1&a),"focus-trap#initial-focus"),h=bI();return bL(()=>{if(0===a)return;if(!g){null!=e&&e.current&&a5(e.current);return}let i=c.current;i&&av(()=>{if(!h.current)return;let c=null==b?void 0:b.activeElement;if(null!=d&&d.current){if((null==d?void 0:d.current)===c){f.current=c;return}}else if(i.contains(c)){f.current=c;return}if(null!=d&&d.current)a5(d.current);else{if(16&a){if(a6(i,a0.First|a0.AutoFocus)!==a1.Error)return}else if(a6(i,a0.First)!==a1.Error)return;if(null!=e&&e.current&&(a5(e.current),(null==b?void 0:b.activeElement)===e.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}f.current=null==b?void 0:b.activeElement})},[e,g,a]),f}(i,{ownerDocument:k,container:d,initialFocus:f,initialFocusFallback:g});!function(a,{ownerDocument:b,container:c,containers:d,previousActiveElement:e}){let f=bI(),g=!!(4&a);at(null==b?void 0:b.defaultView,"focus",a=>{if(!g||!f.current)return;let b=bN(d);aY(c.current)&&b.add(c.current);let h=e.current;if(!h)return;let i=a.target;aY(i)?bQ(b,i)?(e.current=i,a5(i)):(a.preventDefault(),a.stopPropagation(),a5(h)):a5(e.current)},!0)}(i,{ownerDocument:k,container:d,containers:h,previousActiveElement:l});let m=(c=(0,s.useRef)(0),ba(!0,"keydown",a=>{"Tab"===a.key&&(c.current=+!!a.shiftKey)},!0),c),n=aO(a=>{if(!aY(d.current))return;let b=d.current;aG(m.current,{[bK.Forwards]:()=>{a6(b,a0.First,{skipElements:[a.relatedTarget,g]})},[bK.Backwards]:()=>{a6(b,a0.Last,{skipElements:[a.relatedTarget,g]})}})}),o=aR(!!(2&i),"focus-trap#tab-lock"),p=bH(),q=(0,s.useRef)(!1),r=bf();return s.default.createElement(s.default.Fragment,null,o&&s.default.createElement(bn,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:n,features:bm.Focusable}),r({ourProps:{ref:e,onKeyDown(a){"Tab"==a.key&&(q.current=!0,p.requestAnimationFrame(()=>{q.current=!1}))},onBlur(a){if(!(4&i))return;let b=bN(h);aY(d.current)&&b.add(d.current);let c=a.relatedTarget;aZ(c)&&"true"!==c.dataset.headlessuiFocusGuard&&(bQ(b,c)||(q.current?a6(d.current,aG(m.current,{[bK.Forwards]:()=>a0.Next,[bK.Backwards]:()=>a0.Previous})|a0.WrapAround,{relativeTo:a.target}):aZ(a.target)&&a5(a.target)))}},theirProps:j,defaultTag:"div",name:"FocusTrap"}),o&&s.default.createElement(bn,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:n,features:bm.Focusable}))}),{features:bO});function bQ(a,b){for(let c of a)if(c.contains(b))return!0;return!1}var bR=a.i(35112);let bS=s.Fragment,bT=bj(function(a,b){let{ownerDocument:c=null,...d}=a,e=(0,s.useRef)(null),f=bu(function(a,b=!0){return Object.assign(a,{[bt]:b})}(a=>{e.current=a}),b),g=bb(e),h=null!=c?c:g,i=function(a){let b=(0,s.useContext)(bC),c=(0,s.useContext)(bV),[d,e]=(0,s.useState)(()=>{var d;if(!b&&null!==c)return null!=(d=c.current)?d:null;if(aq.isServer)return null;let e=null==a?void 0:a.getElementById("headlessui-portal-root");if(e)return e;if(null===a)return null;let f=a.createElement("div");return f.setAttribute("id","headlessui-portal-root"),a.body.appendChild(f)});return(0,s.useEffect)(()=>{null!==d&&(null!=a&&a.body.contains(d)||null==a||a.body.appendChild(d))},[d,a]),(0,s.useEffect)(()=>{b||null!==c&&e(c.current)},[c,e,b]),d}(h),[j]=(0,s.useState)(()=>{var a;return aq.isServer?null:null!=(a=null==h?void 0:h.createElement("div"))?a:null}),k=(0,s.useContext)(bW),l=bs();ar(()=>{!i||!j||i.contains(j)||(j.setAttribute("data-headlessui-portal",""),i.appendChild(j))},[i,j]),ar(()=>{if(j&&k)return k.register(j)},[k,j]),bJ(()=>{var a;i&&j&&(aW(j)&&i.contains(j)&&i.removeChild(j),i.childNodes.length<=0&&(null==(a=i.parentElement)||a.removeChild(i)))});let m=bf();return l&&i&&j?(0,bR.createPortal)(m({ourProps:{ref:f},theirProps:d,slot:{},defaultTag:bS,name:"Portal"}),j):null}),bU=s.Fragment,bV=(0,s.createContext)(null),bW=(0,s.createContext)(null),bX=bj(function(a,b){let c=bu(b),{enabled:d=!0,ownerDocument:e,...f}=a,g=bf();return d?s.default.createElement(bT,{...f,ownerDocument:e,ref:c}):g({ourProps:{ref:c},theirProps:f,slot:{},defaultTag:bS,name:"Portal"})}),bY=bj(function(a,b){let{target:c,...d}=a,e={ref:bu(b)},f=bf();return s.default.createElement(bV.Provider,{value:c},f({ourProps:e,theirProps:d,defaultTag:bU,name:"Popover.Group"}))}),bZ=Object.assign(bX,{Group:bY});"undefined"!=typeof process&&"undefined"!=typeof globalThis&&"undefined"!=typeof Element&&(null==(e=null==process?void 0:process.env)?void 0:e.NODE_ENV)==="test"&&void 0===(null==(f=null==Element?void 0:Element.prototype)?void 0:f.getAnimations)&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var b$=(a=>(a[a.None=0]="None",a[a.Closed=1]="Closed",a[a.Enter=2]="Enter",a[a.Leave=4]="Leave",a))(b$||{});function b_(a){var b;return!!(a.enter||a.enterFrom||a.enterTo||a.leave||a.leaveFrom||a.leaveTo)||(null!=(b=a.as)?b:b5)!==s.Fragment||1===s.default.Children.count(a.children)}let b0=(0,s.createContext)(null);b0.displayName="TransitionContext";var b1=(a=>(a.Visible="visible",a.Hidden="hidden",a))(b1||{});let b2=(0,s.createContext)(null);function b3(a){return"children"in a?b3(a.children):a.current.filter(({el:a})=>null!==a.current).filter(({state:a})=>"visible"===a).length>0}function b4(a,b){let c=as(a),d=(0,s.useRef)([]),e=bI(),f=bH(),g=aO((a,b=be.Hidden)=>{let g=d.current.findIndex(({el:b})=>b===a);-1!==g&&(aG(b,{[be.Unmount](){d.current.splice(g,1)},[be.Hidden](){d.current[g].state="hidden"}}),f.microTask(()=>{var a;!b3(d)&&e.current&&(null==(a=c.current)||a.call(c))}))}),h=aO(a=>{let b=d.current.find(({el:b})=>b===a);return b?"visible"!==b.state&&(b.state="visible"):d.current.push({el:a,state:"visible"}),()=>g(a,be.Unmount)}),i=(0,s.useRef)([]),j=(0,s.useRef)(Promise.resolve()),k=(0,s.useRef)({enter:[],leave:[]}),l=aO((a,c,d)=>{i.current.splice(0),b&&(b.chains.current[c]=b.chains.current[c].filter(([b])=>b!==a)),null==b||b.chains.current[c].push([a,new Promise(a=>{i.current.push(a)})]),null==b||b.chains.current[c].push([a,new Promise(a=>{Promise.all(k.current[c].map(([a,b])=>b)).then(()=>a())})]),"enter"===c?j.current=j.current.then(()=>null==b?void 0:b.wait.current).then(()=>d(c)):d(c)}),m=aO((a,b,c)=>{Promise.all(k.current[b].splice(0).map(([a,b])=>b)).then(()=>{var a;null==(a=i.current.shift())||a()}).then(()=>c(b))});return(0,s.useMemo)(()=>({children:d,register:h,unregister:g,onStart:l,onStop:m,wait:j,chains:k}),[h,g,d,l,m,k,j])}b2.displayName="NestingContext";let b5=s.Fragment,b6=bd.RenderStrategy,b7=bj(function(a,b){let{show:c,appear:d=!1,unmount:e=!0,...f}=a,g=(0,s.useRef)(null),h=bu(...b_(a)?[g,b]:null===b?[]:[b]);bs();let i=bz();if(void 0===c&&null!==i&&(c=(i&by.Open)===by.Open),void 0===c)throw Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[j,k]=(0,s.useState)(c?"visible":"hidden"),l=b4(()=>{c||k("hidden")}),[m,n]=(0,s.useState)(!0),o=(0,s.useRef)([c]);ar(()=>{!1!==m&&o.current[o.current.length-1]!==c&&(o.current.push(c),n(!1))},[o,c]);let p=(0,s.useMemo)(()=>({show:c,appear:d,initial:m}),[c,d,m]);ar(()=>{c?k("visible"):b3(l)||null===g.current||k("hidden")},[c,l]);let q={unmount:e},r=aO(()=>{var b;m&&n(!1),null==(b=a.beforeEnter)||b.call(a)}),t=aO(()=>{var b;m&&n(!1),null==(b=a.beforeLeave)||b.call(a)}),u=bf();return s.default.createElement(b2.Provider,{value:l},s.default.createElement(b0.Provider,{value:p},u({ourProps:{...q,as:s.Fragment,children:s.default.createElement(b8,{ref:h,...q,...f,beforeEnter:r,beforeLeave:t})},theirProps:{},defaultTag:s.Fragment,features:b6,visible:"visible"===j,name:"Transition"})))}),b8=bj(function(a,b){var c,d;let{transition:e=!0,beforeEnter:f,afterEnter:g,beforeLeave:h,afterLeave:i,enter:j,enterFrom:k,enterTo:l,entered:m,leave:n,leaveFrom:o,leaveTo:p,...q}=a,[r,t]=(0,s.useState)(null),u=(0,s.useRef)(null),v=b_(a),w=bu(...v?[u,b,t]:null===b?[]:[b]),x=null==(c=q.unmount)||c?be.Unmount:be.Hidden,{show:y,appear:z,initial:A}=function(){let a=(0,s.useContext)(b0);if(null===a)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return a}(),[B,C]=(0,s.useState)(y?"visible":"hidden"),D=function(){let a=(0,s.useContext)(b2);if(null===a)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return a}(),{register:E,unregister:F}=D;ar(()=>E(u),[E,u]),ar(()=>{if(x===be.Hidden&&u.current)return y&&"visible"!==B?void C("visible"):aG(B,{hidden:()=>F(u),visible:()=>E(u)})},[B,u,E,F,y,x]);let G=bs();ar(()=>{if(v&&G&&"visible"===B&&null===u.current)throw Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[u,B,G,v]);let H=A&&!z,I=z&&y&&A,J=(0,s.useRef)(!1),K=b4(()=>{J.current||(C("hidden"),F(u))},D),L=aO(a=>{J.current=!0,K.onStart(u,a?"enter":"leave",a=>{"enter"===a?null==f||f():"leave"===a&&(null==h||h())})}),M=aO(a=>{let b=a?"enter":"leave";J.current=!1,K.onStop(u,b,a=>{"enter"===a?null==g||g():"leave"===a&&(null==i||i())}),"leave"!==b||b3(K)||(C("hidden"),F(u))});(0,s.useEffect)(()=>{v&&e||(L(y),M(y))},[y,v,e]);let[,N]=function(a,b,c,d){let[e,f]=(0,s.useState)(c),{hasFlag:g,addFlag:h,removeFlag:i}=function(a=0){let[b,c]=(0,s.useState)(a),d=(0,s.useCallback)(a=>c(a),[b]),e=(0,s.useCallback)(a=>c(b=>b|a),[b]),f=(0,s.useCallback)(a=>(b&a)===a,[b]);return{flags:b,setFlag:d,addFlag:e,hasFlag:f,removeFlag:(0,s.useCallback)(a=>c(b=>b&~a),[c]),toggleFlag:(0,s.useCallback)(a=>c(b=>b^a),[c])}}(a&&e?3:0),j=(0,s.useRef)(!1),k=(0,s.useRef)(!1);return ar(()=>{var e;if(a){if(c&&f(!0),!b){c&&h(3);return}return null==(e=null==d?void 0:d.start)||e.call(d,c),function(a,{prepare:b,run:c,done:d,inFlight:e}){let f=aw();return function(a,{inFlight:b,prepare:c}){if(null!=b&&b.current)return c();let d=a.style.transition;a.style.transition="none",c(),a.offsetHeight,a.style.transition=d}(a,{prepare:b,inFlight:e}),f.nextFrame(()=>{c(),f.requestAnimationFrame(()=>{f.add(function(a,b){var c,d;let e=aw();if(!a)return e.dispose;let f=!1;e.add(()=>{f=!0});let g=null!=(d=null==(c=a.getAnimations)?void 0:c.call(a).filter(a=>a instanceof CSSTransition))?d:[];return 0===g.length?b():Promise.allSettled(g.map(a=>a.finished)).then(()=>{f||b()}),e.dispose}(a,d))})}),f.dispose}(b,{inFlight:j,prepare(){k.current?k.current=!1:k.current=j.current,j.current=!0,k.current||(c?(h(3),i(4)):(h(4),i(2)))},run(){k.current?c?(i(3),h(4)):(i(4),h(3)):c?i(1):h(1)},done(){var a;k.current&&"function"==typeof b.getAnimations&&b.getAnimations().length>0||(j.current=!1,i(7),c||f(!1),null==(a=null==d?void 0:d.end)||a.call(d,c))}})}},[a,c,b,bH()]),a?[e,{closed:g(1),enter:g(2),leave:g(4),transition:g(2)||g(4)}]:[c,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}(!(!e||!v||!G||H),r,y,{start:L,end:M}),O=bk({ref:w,className:(null==(d=bc(q.className,I&&j,I&&k,N.enter&&j,N.enter&&N.closed&&k,N.enter&&!N.closed&&l,N.leave&&n,N.leave&&!N.closed&&o,N.leave&&N.closed&&p,!N.transition&&y&&m))?void 0:d.trim())||void 0,...function(a){let b={};for(let c in a)!0===a[c]&&(b[`data-${c}`]="");return b}(N)}),P=0;"visible"===B&&(P|=by.Open),"hidden"===B&&(P|=by.Closed),y&&"hidden"===B&&(P|=by.Opening),y||"visible"!==B||(P|=by.Closing);let Q=bf();return s.default.createElement(b2.Provider,{value:K},s.default.createElement(bA,{value:P},Q({ourProps:O,theirProps:q,defaultTag:b5,features:b6,visible:"visible"===B,name:"Transition.Child"})))}),b9=bj(function(a,b){let c=null!==(0,s.useContext)(b0),d=null!==bz();return s.default.createElement(s.default.Fragment,null,!c&&d?s.default.createElement(b7,{ref:b,...a}):s.default.createElement(b8,{ref:b,...a}))}),ca=Object.assign(b7,{Child:b9,Root:b7});var cb=(a=>(a[a.Open=0]="Open",a[a.Closed=1]="Closed",a))(cb||{}),cc=(a=>(a[a.SetTitleId=0]="SetTitleId",a))(cc||{});let cd={0:(a,b)=>a.titleId===b.id?a:{...a,titleId:b.id}},ce=(0,s.createContext)(null);function cf(a){let b=(0,s.useContext)(ce);if(null===b){let b=Error(`<${a} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(b,cf),b}return b}function cg(a,b){return aG(b.type,cd,a,b)}ce.displayName="DialogContext";let ch=bj(function(a,b){let c,d,e,f,g,h,i,j,k,l,m=(0,s.useId)(),{id:n=`headlessui-dialog-${m}`,open:o,onClose:p,initialFocus:q,role:r="dialog",autoFocus:t=!0,__demoMode:u=!1,unmount:v=!1,...w}=a,x=(0,s.useRef)(!1);r="dialog"===r||"alertdialog"===r?r:(x.current||(x.current=!0,console.warn(`Invalid role [${r}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog");let y=bz();void 0===o&&null!==y&&(o=(y&by.Open)===by.Open);let z=(0,s.useRef)(null),A=bu(z,b),B=bb(z),C=+!o,[D,E]=(0,s.useReducer)(cg,{titleId:null,descriptionId:null,panelRef:(0,s.createRef)()}),F=aO(()=>p(!1)),G=aO(a=>E({type:0,id:a})),H=!!bs()&&0===C,[I,J]=(c=(0,s.useContext)(bW),d=(0,s.useRef)([]),e=aO(a=>(d.current.push(a),c&&c.register(a),()=>f(a))),f=aO(a=>{let b=d.current.indexOf(a);-1!==b&&d.current.splice(b,1),c&&c.unregister(a)}),g=(0,s.useMemo)(()=>({register:e,unregister:f,portals:d}),[e,f,d]),[d,(0,s.useMemo)(()=>function({children:a}){return s.default.createElement(bW.Provider,{value:g},a)},[g])]),K=bq(),{resolveContainers:L}=function({defaultContainers:a=[],portals:b,mainTreeNode:c}={}){let d=bb(c),e=aO(()=>{var e,f;let g=[];for(let b of a)null!==b&&(aX(b)?g.push(b):"current"in b&&aX(b.current)&&g.push(b.current));if(null!=b&&b.current)for(let a of b.current)g.push(a);for(let a of null!=(e=null==d?void 0:d.querySelectorAll("html > *, body > *"))?e:[])a!==document.body&&a!==document.head&&aX(a)&&"headlessui-portal-root"!==a.id&&(c&&(a.contains(c)||a.contains(null==(f=null==c?void 0:c.getRootNode())?void 0:f.host))||g.some(b=>a.contains(b))||g.push(a));return g});return{resolveContainers:e,contains:aO(a=>e().some(b=>b.contains(a)))}}({mainTreeNode:K,portals:I,defaultContainers:[{get current(){var M;return null!=(M=D.panelRef.current)?M:z.current}}]}),N=null!==y&&(y&by.Closing)===by.Closing;!function(a,{allowed:b,disallowed:c}={}){let d=aR(a,"inert-others");ar(()=>{var a,e;if(!d)return;let f=aw();for(let b of null!=(a=null==c?void 0:c())?a:[])b&&f.add(aV(b));let g=null!=(e=null==b?void 0:b())?e:[];for(let a of g){if(!a)continue;let b=aS(a);if(!b)continue;let c=a.parentElement;for(;c&&c!==b.body;){for(let a of c.children)g.some(b=>a.contains(b))||f.add(aV(a));c=c.parentElement}}return f.dispose},[d,b,c])}(!u&&!N&&H,{allowed:aO(()=>{var a,b;return[null!=(b=null==(a=z.current)?void 0:a.closest("[data-headlessui-portal]"))?b:null]}),disallowed:aO(()=>{var a;return[null!=(a=null==K?void 0:K.closest("body > *:not(#headlessui-portal-root)"))?a:null]})});let O=aM.get(null);ar(()=>{if(H)return O.actions.push(n),()=>O.actions.pop(n)},[O,n,H]);let P=aP(O,(0,s.useCallback)(a=>O.selectors.isTop(a,n),[O,n]));h=as(a=>{a.preventDefault(),F()}),i=(0,s.useCallback)(function(a,b){if(a.defaultPrevented)return;let c=b(a);if(null!==c&&c.getRootNode().contains(c)&&c.isConnected){for(let b of function a(b){return"function"==typeof b?a(b()):Array.isArray(b)||b instanceof Set?b:[b]}(L))if(null!==b&&(b.contains(c)||a.composed&&a.composedPath().includes(b)))return;return function(a,b=0){var c;return a!==(null==(c=aS(a))?void 0:c.body)&&aG(b,{0:()=>a.matches(a$),1(){let b=a;for(;null!==b;){if(b.matches(a$))return!0;b=b.parentElement}return!1}})}(c,a3.Loose)||-1===c.tabIndex||a.preventDefault(),h.current(a,c)}},[h,L]),j=(0,s.useRef)(null),a9(P,"pointerdown",a=>{var b,c;a8()||(j.current=(null==(c=null==(b=a.composedPath)?void 0:b.call(a))?void 0:c[0])||a.target)},!0),a9(P,"pointerup",a=>{if(a8()||!j.current)return;let b=j.current;return j.current=null,i(a,()=>b)},!0),k=(0,s.useRef)({x:0,y:0}),a9(P,"touchstart",a=>{k.current.x=a.touches[0].clientX,k.current.y=a.touches[0].clientY},!0),a9(P,"touchend",a=>{let b={x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY};if(!(Math.abs(b.x-k.current.x)>=30||Math.abs(b.y-k.current.y)>=30))return i(a,()=>aZ(a.target)?a.target:null)},!0),ba(P,"blur",a=>i(a,()=>{var a;return aY(a=window.document.activeElement)&&"IFRAME"===a.nodeName?window.document.activeElement:null}),!0),function(a,b="undefined"!=typeof document?document.defaultView:null,c){let d=aR(a,"escape");at(b,"keydown",a=>{d&&(a.defaultPrevented||a.key===an.Escape&&c(a))})}(P,null==B?void 0:B.defaultView,a=>{a.preventDefault(),a.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur(),F()}),function(a,b,c=()=>[document.body]){!function(a,b,c=()=>({containers:[]})){let d=(0,s.useSyncExternalStore)(br.subscribe,br.getSnapshot,br.getSnapshot),e=b?d.get(b):void 0;e&&e.count,ar(()=>{if(!(!b||!a))return br.dispatch("PUSH",b,c),()=>br.dispatch("POP",b,c)},[a,b])}(aR(a,"scroll-lock"),b,a=>{var b;return{containers:[...null!=(b=a.containers)?b:[],c]}})}(!u&&!N&&H,B,L),l=as(a=>{let b=a.getBoundingClientRect();0===b.x&&0===b.y&&0===b.width&&0===b.height&&F()}),(0,s.useEffect)(()=>{if(!H)return;let a=null===z?null:aY(z)?z:z.current;if(!a)return;let b=aw();if("undefined"!=typeof ResizeObserver){let c=new ResizeObserver(()=>l.current(a));c.observe(a),b.add(()=>c.disconnect())}if("undefined"!=typeof IntersectionObserver){let c=new IntersectionObserver(()=>l.current(a));c.observe(a),b.add(()=>c.disconnect())}return()=>b.dispose()},[z,l,H]);let[Q,R]=function(){let[a,b]=(0,s.useState)([]);return[a.length>0?a.join(" "):void 0,(0,s.useMemo)(()=>function(a){let c=aO(a=>(b(b=>[...b,a]),()=>b(b=>{let c=b.slice(),d=c.indexOf(a);return -1!==d&&c.splice(d,1),c}))),d=(0,s.useMemo)(()=>({register:c,slot:a.slot,name:a.name,props:a.props,value:a.value}),[c,a.slot,a.name,a.props,a.value]);return s.default.createElement(bF.Provider,{value:d},a.children)},[b])]}(),S=(0,s.useMemo)(()=>[{dialogState:C,close:F,setTitleId:G,unmount:v},D],[C,D,F,G,v]),T=(0,s.useMemo)(()=>({open:0===C}),[C]),U={ref:A,id:n,role:r,tabIndex:-1,"aria-modal":u?void 0:0===C||void 0,"aria-labelledby":D.titleId,"aria-describedby":Q,unmount:v},V=!function(){var a;let[b]=(0,s.useState)(()=>null),[c,d]=(0,s.useState)(null!=(a=null==b?void 0:b.matches)&&a);return ar(()=>{if(b)return b.addEventListener("change",a),()=>b.removeEventListener("change",a);function a(a){d(a.matches)}},[b]),c}(),W=bO.None;H&&!u&&(W|=bO.RestoreFocus,W|=bO.TabLock,t&&(W|=bO.AutoFocus),V&&(W|=bO.InitialFocus));let X=bf();return s.default.createElement(bB,null,s.default.createElement(bD,{force:!0},s.default.createElement(bZ,null,s.default.createElement(ce.Provider,{value:S},s.default.createElement(bY,{target:z},s.default.createElement(bD,{force:!1},s.default.createElement(R,{slot:T},s.default.createElement(J,null,s.default.createElement(bP,{initialFocus:q,initialFocusFallback:z,containers:L,features:W},s.default.createElement(bw,{value:F},X({ourProps:U,theirProps:w,slot:T,defaultTag:ci,features:cj,visible:0===C,name:"Dialog"})))))))))))}),ci="div",cj=bd.RenderStrategy|bd.Static,ck=Object.assign(bj(function(a,b){let{transition:c=!1,open:d,...e}=a,f=bz(),g=a.hasOwnProperty("open")||null!==f,h=a.hasOwnProperty("onClose");if(!g&&!h)throw Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!g)throw Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!h)throw Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!f&&"boolean"!=typeof a.open)throw Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${a.open}`);if("function"!=typeof a.onClose)throw Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${a.onClose}`);return(void 0!==d||c)&&!e.static?s.default.createElement(bp,null,s.default.createElement(ca,{show:d,transition:c,unmount:e.unmount},s.default.createElement(ch,{ref:b,...e}))):s.default.createElement(bp,null,s.default.createElement(ch,{ref:b,open:d,...e}))}),{Panel:bj(function(a,b){let c=(0,s.useId)(),{id:d=`headlessui-dialog-panel-${c}`,transition:e=!1,...f}=a,[{dialogState:g,unmount:h},i]=cf("Dialog.Panel"),j=bu(b,i.panelRef),k=(0,s.useMemo)(()=>({open:0===g}),[g]),l=aO(a=>{a.stopPropagation()}),m=e?b9:s.Fragment,n=bf();return s.default.createElement(m,{...e?{unmount:h}:{}},n({ourProps:{ref:j,id:d,onClick:l},theirProps:f,slot:k,defaultTag:"div",name:"Dialog.Panel"}))}),Title:(bj(function(a,b){let{transition:c=!1,...d}=a,[{dialogState:e,unmount:f}]=cf("Dialog.Backdrop"),g=(0,s.useMemo)(()=>({open:0===e}),[e]),h=c?b9:s.Fragment,i=bf();return s.default.createElement(h,{...c?{unmount:f}:{}},i({ourProps:{ref:b,"aria-hidden":!0},theirProps:d,slot:g,defaultTag:"div",name:"Dialog.Backdrop"}))}),bj(function(a,b){let c=(0,s.useId)(),{id:d=`headlessui-dialog-title-${c}`,...e}=a,[{dialogState:f,setTitleId:g}]=cf("Dialog.Title"),h=bu(b);(0,s.useEffect)(()=>(g(d),()=>g(null)),[d,g]);let i=(0,s.useMemo)(()=>({open:0===f}),[f]);return bf()({ourProps:{ref:h,id:d},theirProps:e,slot:i,defaultTag:"h2",name:"Dialog.Title"})})),Description:bG}),cl=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))});function cm({isOpen:a,onClose:b}){let[c,d]=(0,s.useState)({client:"",agency:"",invoice_id:"",approved:"ne",viaduct:!1,from:"",to:"",media_received:!1,final_price:0,invoice_sent:!1}),[e,f]=(0,s.useState)(!1),g=async a=>{a.preventDefault(),f(!0);try{console.log("Submitting order:",c),await new Promise(a=>setTimeout(a,1e3)),d({client:"",agency:"",invoice_id:"",approved:"ne",viaduct:!1,from:"",to:"",media_received:!1,final_price:0,invoice_sent:!1}),b()}catch(a){console.error("Failed to create order:",a)}finally{f(!1)}},h=(a,b)=>{d(c=>({...c,[a]:b}))};return(0,r.jsxs)(ck,{open:a,onClose:b,className:"relative z-50",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)(ck.Panel,{className:"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-xl shadow-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsx)(ck.Title,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Pridėti naują užsakymą"}),(0,r.jsx)("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,r.jsx)(cl,{className:"w-6 h-6"})})]}),(0,r.jsxs)("form",{onSubmit:g,className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Klientas *"}),(0,r.jsx)("input",{type:"text",required:!0,value:c.client,onChange:a=>h("client",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"Įveskite kliento pavadinimą"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Agentūra"}),(0,r.jsx)("input",{type:"text",value:c.agency,onChange:a=>h("agency",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"Įveskite agentūros pavadinimą"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Užsakymo Nr. *"}),(0,r.jsx)("input",{type:"text",required:!0,value:c.invoice_id,onChange:a=>h("invoice_id",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"Įveskite užsakymo numerį"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Statusas *"}),(0,r.jsxs)("select",{required:!0,value:c.approved,onChange:a=>h("approved",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[(0,r.jsx)("option",{value:"ne",children:"Nepatvirtinta"}),(0,r.jsx)("option",{value:"taip",children:"Patvirtinta"}),(0,r.jsx)("option",{value:"rezervuota",children:"Rezervuota"}),(0,r.jsx)("option",{value:"atšaukta",children:"Atšaukta"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data nuo *"}),(0,r.jsx)("input",{type:"date",required:!0,value:c.from,onChange:a=>h("from",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data iki *"}),(0,r.jsx)("input",{type:"date",required:!0,value:c.to,onChange:a=>h("to",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Galutinė kaina *"}),(0,r.jsx)("input",{type:"number",required:!0,step:"0.01",min:"0",value:c.final_price,onChange:a=>h("final_price",parseFloat(a.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"0.00"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:c.viaduct,onChange:a=>h("viaduct",a.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,r.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Viadukas"})]}),(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:c.media_received,onChange:a=>h("media_received",a.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,r.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Medija gauta"})]}),(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:c.invoice_sent,onChange:a=>h("invoice_sent",a.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,r.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Sąskaita išsiųsta"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("button",{type:"button",onClick:b,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Atšaukti"}),(0,r.jsx)("button",{type:"submit",disabled:e,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:e?"Kuriama...":"Sukurti užsakymą"})]})]})]})})]})}let cn=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}),co=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}),cp=s.forwardRef(function({title:a,titleId:b,...c},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?s.createElement("title",{id:b},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"}))});class cq extends Error{constructor(a,b="FunctionsError",c){super(a),this.name=b,this.context=c}}class cr extends cq{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class cs extends cq{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class ct extends cq{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}!function(a){a.Any="any",a.ApNortheast1="ap-northeast-1",a.ApNortheast2="ap-northeast-2",a.ApSouth1="ap-south-1",a.ApSoutheast1="ap-southeast-1",a.ApSoutheast2="ap-southeast-2",a.CaCentral1="ca-central-1",a.EuCentral1="eu-central-1",a.EuWest1="eu-west-1",a.EuWest2="eu-west-2",a.EuWest3="eu-west-3",a.SaEast1="sa-east-1",a.UsEast1="us-east-1",a.UsWest1="us-west-1",a.UsWest2="us-west-2"}(g||(g={}));class cu{constructor(b,{headers:c={},customFetch:d,region:e=g.Any}={}){this.url=b,this.headers=c,this.region=e,this.fetch=(b=>{let c;return c=b||("undefined"==typeof fetch?(...b)=>a.A(59789).then(({default:a})=>a(...b)):fetch),(...a)=>c(...a)})(d)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a,b={}){var c,d,e,f,g;return d=this,e=void 0,f=void 0,g=function*(){try{let d,{headers:e,method:f,body:g}=b,h={},{region:i}=b;i||(i=this.region);let j=new URL(`${this.url}/${a}`);i&&"any"!==i&&(h["x-region"]=i,j.searchParams.set("forceFunctionRegion",i)),g&&(e&&!Object.prototype.hasOwnProperty.call(e,"Content-Type")||!e)&&("undefined"!=typeof Blob&&g instanceof Blob||g instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",d=g):"string"==typeof g?(h["Content-Type"]="text/plain",d=g):"undefined"!=typeof FormData&&g instanceof FormData?d=g:(h["Content-Type"]="application/json",d=JSON.stringify(g)));let k=yield this.fetch(j.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),e),body:d}).catch(a=>{throw new cr(a)}),l=k.headers.get("x-relay-error");if(l&&"true"===l)throw new cs(k);if(!k.ok)throw new ct(k);let m=(null!=(c=k.headers.get("Content-Type"))?c:"text/plain").split(";")[0].trim();return{data:"application/json"===m?yield k.json():"application/octet-stream"===m?yield k.blob():"text/event-stream"===m?k:"multipart/form-data"===m?yield k.formData():yield k.text(),error:null,response:k}}catch(a){return{data:null,error:a,response:a instanceof ct||a instanceof cs?a.context:void 0}}},new(f||(f=Promise))(function(a,b){function c(a){try{i(g.next(a))}catch(a){b(a)}}function h(a){try{i(g.throw(a))}catch(a){b(a)}}function i(b){var d;b.done?a(b.value):((d=b.value)instanceof f?d:new f(function(a){a(d)})).then(c,h)}i((g=g.apply(d,e||[])).next())})}}let{PostgrestClient:cv,PostgrestQueryBuilder:cw,PostgrestFilterBuilder:cx,PostgrestTransformBuilder:cy,PostgrestBuilder:cz,PostgrestError:cA}=a.i(79614).default,cB=class{static detectEnvironment(){var b;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==a.g.WebSocket)return{type:"native",constructor:a.g.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null==(b=navigator.userAgent)?void 0:b.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process&&process.versions&&process.versions.node){let a=parseInt(process.versions.node.split(".")[0]);return a>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let a=this.detectEnvironment();if(a.constructor)return a.constructor;let b=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(b+=`

Suggested solution: ${a.workaround}`),Error(b)}static createWebSocket(a,b){return new(this.getWebSocketConstructor())(a,b)}static isWebSocketSupported(){try{let a=this.detectEnvironment();return"native"===a.type||"ws"===a.type}catch(a){return!1}}};!function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"}(h||(h={})),function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"}(i||(i={})),function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"}(j||(j={})),(k||(k={})).websocket="websocket",function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"}(l||(l={}));class cC{constructor(){this.HEADER_LENGTH=1}decode(a,b){return a.constructor===ArrayBuffer?b(this._binaryDecode(a)):"string"==typeof a?b(JSON.parse(a)):b({})}_binaryDecode(a){let b=new DataView(a),c=new TextDecoder;return this._decodeBroadcast(a,b,c)}_decodeBroadcast(a,b,c){let d=b.getUint8(1),e=b.getUint8(2),f=this.HEADER_LENGTH+2,g=c.decode(a.slice(f,f+d));f+=d;let h=c.decode(a.slice(f,f+e));return f+=e,{ref:null,topic:g,event:h,payload:JSON.parse(c.decode(a.slice(f,a.byteLength)))}}}class cD{constructor(a,b){this.callback=a,this.timerCalc=b,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=b}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"}(m||(m={}));let cE=(a,b,c={})=>{var d;let e=null!=(d=c.skipTypes)?d:[];return Object.keys(b).reduce((c,d)=>(c[d]=cF(d,a,b,e),c),{})},cF=(a,b,c,d)=>{let e=b.find(b=>b.name===a),f=null==e?void 0:e.type,g=c[a];return f&&!d.includes(f)?cG(f,g):cH(g)},cG=(a,b)=>{if("_"===a.charAt(0))return cL(b,a.slice(1,a.length));switch(a){case m.bool:return cI(b);case m.float4:case m.float8:case m.int2:case m.int4:case m.int8:case m.numeric:case m.oid:return cJ(b);case m.json:case m.jsonb:return cK(b);case m.timestamp:return cM(b);case m.abstime:case m.date:case m.daterange:case m.int4range:case m.int8range:case m.money:case m.reltime:case m.text:case m.time:case m.timestamptz:case m.timetz:case m.tsrange:case m.tstzrange:default:return cH(b)}},cH=a=>a,cI=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},cJ=a=>{if("string"==typeof a){let b=parseFloat(a);if(!Number.isNaN(b))return b}return a},cK=a=>{if("string"==typeof a)try{return JSON.parse(a)}catch(a){console.log(`JSON parse error: ${a}`)}return a},cL=(a,b)=>{if("string"!=typeof a)return a;let c=a.length-1,d=a[c];if("{"===a[0]&&"}"===d){let d,e=a.slice(1,c);try{d=JSON.parse("["+e+"]")}catch(a){d=e?e.split(","):[]}return d.map(a=>cG(b,a))}return a},cM=a=>"string"==typeof a?a.replace(" ","T"):a,cN=a=>{let b=a;return(b=(b=b.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")+"/api/broadcast"};class cO{constructor(a,b,c={},d=1e4){this.channel=a,this.event=b,this.payload=c,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,b){var c;return this._hasReceived(a)&&b(null==(c=this.receivedResp)?void 0:c.response),this.recHooks.push({status:a,callback:b}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let a=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,b){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:b})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:b}){this.recHooks.filter(b=>b.status===a).forEach(a=>a.callback(b))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}!function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"}(n||(n={}));class cP{constructor(a,b){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let c=(null==b?void 0:b.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(c.state,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=cP.syncState(this.state,a,b,c),this.pendingDiffs.forEach(a=>{this.state=cP.syncDiff(this.state,a,b,c)}),this.pendingDiffs=[],d()}),this.channel._on(c.diff,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=cP.syncDiff(this.state,a,b,c),d())}),this.onJoin((a,b,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:b,newPresences:c})}),this.onLeave((a,b,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:b,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,b,c,d){let e=this.cloneDeep(a),f=this.transformState(b),g={},h={};return this.map(e,(a,b)=>{f[a]||(h[a]=b)}),this.map(f,(a,b)=>{let c=e[a];if(c){let d=b.map(a=>a.presence_ref),e=c.map(a=>a.presence_ref),f=b.filter(a=>0>e.indexOf(a.presence_ref)),i=c.filter(a=>0>d.indexOf(a.presence_ref));f.length>0&&(g[a]=f),i.length>0&&(h[a]=i)}else g[a]=b}),this.syncDiff(e,{joins:g,leaves:h},c,d)}static syncDiff(a,b,c,d){let{joins:e,leaves:f}={joins:this.transformState(b.joins),leaves:this.transformState(b.leaves)};return c||(c=()=>{}),d||(d=()=>{}),this.map(e,(b,d)=>{var e;let f=null!=(e=a[b])?e:[];if(a[b]=this.cloneDeep(d),f.length>0){let c=a[b].map(a=>a.presence_ref),d=f.filter(a=>0>c.indexOf(a.presence_ref));a[b].unshift(...d)}c(b,f,d)}),this.map(f,(b,c)=>{let e=a[b];if(!e)return;let f=c.map(a=>a.presence_ref);e=e.filter(a=>0>f.indexOf(a.presence_ref)),a[b]=e,d(b,e,c),0===e.length&&delete a[b]}),a}static map(a,b){return Object.getOwnPropertyNames(a).map(c=>b(c,a[c]))}static transformState(a){return Object.getOwnPropertyNames(a=this.cloneDeep(a)).reduce((b,c)=>{let d=a[c];return"metas"in d?b[c]=d.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):b[c]=d,b},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"}(o||(o={})),function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes",a.SYSTEM="system"}(p||(p={})),function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"}(q||(q={}));class cQ{constructor(a,b={config:{}},c){this.topic=a,this.params=b,this.socket=c,this.bindings={},this.state=i.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},b.config),this.timeout=this.socket.timeout,this.joinPush=new cO(this,j.join,this.params,this.timeout),this.rejoinTimer=new cD(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=i.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=i.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=i.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=i.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=i.errored,this.rejoinTimer.scheduleTimeout())}),this._on(j.reply,{},(a,b)=>{this._trigger(this._replyEventName(b),a)}),this.presence=new cP(this),this.broadcastEndpointURL=cN(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(a,b=this.timeout){var c,d;if(this.socket.isConnected()||this.socket.connect(),this.state==i.closed){let{config:{broadcast:e,presence:f,private:g}}=this.params,h=null!=(d=null==(c=this.bindings.postgres_changes)?void 0:c.map(a=>a.filter))?d:[],j=!!this.bindings[p.PRESENCE]&&this.bindings[p.PRESENCE].length>0,k={},l={broadcast:e,presence:Object.assign(Object.assign({},f),{enabled:j}),postgres_changes:h,private:g};this.socket.accessTokenValue&&(k.access_token=this.socket.accessTokenValue),this._onError(b=>null==a?void 0:a(q.CHANNEL_ERROR,b)),this._onClose(()=>null==a?void 0:a(q.CLOSED)),this.updateJoinPayload(Object.assign({config:l},k)),this.joinedOnce=!0,this._rejoin(b),this.joinPush.receive("ok",async({postgres_changes:b})=>{var c;if(this.socket.setAuth(),void 0===b){null==a||a(q.SUBSCRIBED);return}{let d=this.bindings.postgres_changes,e=null!=(c=null==d?void 0:d.length)?c:0,f=[];for(let c=0;c<e;c++){let e=d[c],{filter:{event:g,schema:h,table:j,filter:k}}=e,l=b&&b[c];if(l&&l.event===g&&l.schema===h&&l.table===j&&l.filter===k)f.push(Object.assign(Object.assign({},e),{id:l.id}));else{this.unsubscribe(),this.state=i.errored,null==a||a(q.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,a&&a(q.SUBSCRIBED);return}}).receive("error",b=>{this.state=i.errored,null==a||a(q.CHANNEL_ERROR,Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{null==a||a(q.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,b={}){return await this.send({type:"presence",event:"track",payload:a},b.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,b,c){return this.state===i.joined&&a===p.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,b,c)}async send(a,b={}){var c,d;if(this._canPush()||"broadcast"!==a.type)return new Promise(c=>{var d,e,f;let g=this._push(a.type,a,b.timeout||this.timeout);"broadcast"!==a.type||(null==(f=null==(e=null==(d=this.params)?void 0:d.config)?void 0:e.broadcast)?void 0:f.ack)||c("ok"),g.receive("ok",()=>c("ok")),g.receive("error",()=>c("error")),g.receive("timeout",()=>c("timed out"))});{let{event:e,payload:f}=a,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:f,private:this.private}]})};try{let a=await this._fetchWithTimeout(this.broadcastEndpointURL,g,null!=(c=b.timeout)?c:this.timeout);return await (null==(d=a.body)?void 0:d.cancel()),a.ok?"ok":"error"}catch(a){if("AbortError"===a.name)return"timed out";return"error"}}}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=i.leaving;let b=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(j.close,"leave",this._joinRef())};this.joinPush.destroy();let c=null;return new Promise(d=>{(c=new cO(this,j.leave,{},a)).receive("ok",()=>{b(),d("ok")}).receive("timeout",()=>{b(),d("timed out")}).receive("error",()=>{d("error")}),c.send(),this._canPush()||c.trigger("ok",{})}).finally(()=>{null==c||c.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=i.closed,this.bindings={}}async _fetchWithTimeout(a,b,c){let d=new AbortController,e=setTimeout(()=>d.abort(),c),f=await this.socket.fetch(a,Object.assign(Object.assign({},b),{signal:d.signal}));return clearTimeout(e),f}_push(a,b,c=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new cO(this,a,b,c);return this._canPush()?d.send():this._addToPushBuffer(d),d}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>100){let a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(a,b,c){return b}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,b,c){var d,e;let f=a.toLocaleLowerCase(),{close:g,error:h,leave:i,join:k}=j;if(c&&[g,h,i,k].indexOf(f)>=0&&c!==this._joinRef())return;let l=this._onMessage(f,b,c);if(b&&!l)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?null==(d=this.bindings.postgres_changes)||d.filter(a=>{var b,c,d;return(null==(b=a.filter)?void 0:b.event)==="*"||(null==(d=null==(c=a.filter)?void 0:c.event)?void 0:d.toLocaleLowerCase())===f}).map(a=>a.callback(l,c)):null==(e=this.bindings[f])||e.filter(a=>{var c,d,e,g,h,i;if(!["broadcast","presence","postgres_changes"].includes(f))return a.type.toLocaleLowerCase()===f;if("id"in a){let f=a.id,g=null==(c=a.filter)?void 0:c.event;return f&&(null==(d=b.ids)?void 0:d.includes(f))&&("*"===g||(null==g?void 0:g.toLocaleLowerCase())===(null==(e=b.data)?void 0:e.type.toLocaleLowerCase()))}{let c=null==(h=null==(g=null==a?void 0:a.filter)?void 0:g.event)?void 0:h.toLocaleLowerCase();return"*"===c||c===(null==(i=null==b?void 0:b.event)?void 0:i.toLocaleLowerCase())}}).map(a=>{if("object"==typeof l&&"ids"in l){let a=l.data,{schema:b,table:c,commit_timestamp:d,type:e,errors:f}=a;l=Object.assign(Object.assign({},{schema:b,table:c,commit_timestamp:d,eventType:e,new:{},old:{},errors:f}),this._getPayloadRecords(a))}a.callback(l,c)})}_isClosed(){return this.state===i.closed}_isJoined(){return this.state===i.joined}_isJoining(){return this.state===i.joining}_isLeaving(){return this.state===i.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,b,c){let d=a.toLocaleLowerCase(),e={type:d,filter:b,callback:c};return this.bindings[d]?this.bindings[d].push(e):this.bindings[d]=[e],this}_off(a,b){let c=a.toLocaleLowerCase();return this.bindings[c]&&(this.bindings[c]=this.bindings[c].filter(a=>{var d;return!((null==(d=a.type)?void 0:d.toLocaleLowerCase())===c&&cQ.isEqual(a.filter,b))})),this}static isEqual(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(let c in a)if(a[c]!==b[c])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(j.close,{},a)}_onError(a){this._on(j.error,{},b=>a(b))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=i.joining,this.joinPush.resend(a))}_getPayloadRecords(a){let b={new:{},old:{}};return("INSERT"===a.type||"UPDATE"===a.type)&&(b.new=cE(a.columns,a.record)),("UPDATE"===a.type||"DELETE"===a.type)&&(b.old=cE(a.columns,a.old_record)),b}}let cR=()=>{},cS={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},cT=[1e3,2e3,5e3,1e4],cU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class cV{constructor(b,c){var d;if(this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=cS.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cR,this.ref=0,this.reconnectTimer=null,this.logger=cR,this.conn=null,this.sendBuffer=[],this.serializer=new cC,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=b=>{let c;return c=b||("undefined"==typeof fetch?(...b)=>a.A(59789).then(({default:a})=>a(...b)).catch(a=>{throw Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...a)=>c(...a)},!(null==(d=null==c?void 0:c.params)?void 0:d.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=c.params.apikey,this.endPoint=`${b}/${k.websocket}`,this.httpEndpoint=cN(b),this._initializeOptions(c),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==c?void 0:c.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=cB.createWebSocket(this.endpointURL())}catch(b){this._setConnectionState("disconnected");let a=b.message;if(a.includes("Node.js"))throw Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(a,b){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let c=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(c),this._setConnectionState("disconnected")},a?this.conn.close(a,null!=b?b:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){let b=await a.unsubscribe();return 0===this.channels.length&&this.disconnect(),b}async removeAllChannels(){let a=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,b,c){this.logger(a,b,c)}connectionState(){switch(this.conn&&this.conn.readyState){case h.connecting:return l.Connecting;case h.open:return l.Open;case h.closing:return l.Closing;default:return l.Closed}}isConnected(){return this.connectionState()===l.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(a,b={config:{}}){let c=`realtime:${a}`,d=this.getChannels().find(a=>a.topic===c);if(d)return d;{let c=new cQ(`realtime:${a}`,b,this);return this.channels.push(c),c}}push(a){let{topic:b,event:c,payload:d,ref:e}=a,f=()=>{this.encode(a,a=>{var b;null==(b=this.conn)||b.send(a)})};this.log("push",`${b} ${c} (${e})`,d),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected())return void this.heartbeatCallback("disconnected");if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,null==(a=this.conn)||a.close(1e3,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||null==(a=this.reconnectTimer)||a.scheduleTimeout()},cS.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let b=this.channels.find(b=>b.topic===a&&(b._isJoined()||b._isJoining()));b&&(this.log("transport",`leaving duplicate topic "${a}"`),b.unsubscribe())}_remove(a){this.channels=this.channels.filter(b=>b.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,a=>{"phoenix"===a.topic&&"phx_reply"===a.event&&this.heartbeatCallback("ok"===a.payload.status?"ok":"error"),a.ref&&a.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:b,event:c,payload:d,ref:e}=a,f=e?`(${e})`:"",g=d.status||"";this.log("receive",`${g} ${b} ${c} ${f}`.trim(),d),this.channels.filter(a=>a._isMember(b)).forEach(a=>a._trigger(c,d,e)),this._triggerStateCallbacks("message",a)})}_clearTimer(a){var b;"heartbeat"===a&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===a&&(null==(b=this.reconnectTimer)||b.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this.workerRef.terminate()},this.workerRef.onmessage=a=>{"keepAlive"===a.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var b;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(b=this.reconnectTimer)||b.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(j.error))}_appendParams(a,b){if(0===Object.keys(b).length)return a;let c=a.match(/\?/)?"&":"?",d=new URLSearchParams(b);return`${a}${c}${d}`}_workerObjectUrl(a){let b;if(a)b=a;else{let a=new Blob([cU],{type:"application/javascript"});b=URL.createObjectURL(a)}return b}_setConnectionState(a,b=!1){this._connectionState=a,"connecting"===a?this._wasManualDisconnect=!1:"disconnecting"===a&&(this._wasManualDisconnect=b)}async _performAuth(a=null){let b;b=a||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=b&&(this.accessTokenValue=b,this.channels.forEach(a=>{b&&a.updateJoinPayload({access_token:b,version:"realtime-js/2.15.1"}),a.joinedOnce&&a._isJoined()&&a._push(j.access_token,{access_token:b})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(b=>{this.log("error",`error setting auth in ${a}`,b)})}_triggerStateCallbacks(a,b){try{this.stateChangeCallbacks[a].forEach(c=>{try{c(b)}catch(b){this.log("error",`error in ${a} callback`,b)}})}catch(b){this.log("error",`error triggering ${a} callbacks`,b)}}_setupReconnectionTimer(){this.reconnectTimer=new cD(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},cS.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var b,c,d,e,f,g,h,i;this.transport=null!=(b=null==a?void 0:a.transport)?b:null,this.timeout=null!=(c=null==a?void 0:a.timeout)?c:1e4,this.heartbeatIntervalMs=null!=(d=null==a?void 0:a.heartbeatIntervalMs)?d:cS.HEARTBEAT_INTERVAL,this.worker=null!=(e=null==a?void 0:a.worker)&&e,this.accessToken=null!=(f=null==a?void 0:a.accessToken)?f:null,(null==a?void 0:a.params)&&(this.params=a.params),(null==a?void 0:a.logger)&&(this.logger=a.logger),((null==a?void 0:a.logLevel)||(null==a?void 0:a.log_level))&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(g=null==a?void 0:a.reconnectAfterMs)?g:a=>cT[a-1]||1e4,this.encode=null!=(h=null==a?void 0:a.encode)?h:(a,b)=>b(JSON.stringify(a)),this.decode=null!=(i=null==a?void 0:a.decode)?i:this.serializer.decode.bind(this.serializer),this.worker&&(this.workerUrl=null==a?void 0:a.workerUrl)}}class cW extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function cX(a){return"object"==typeof a&&null!==a&&"__isStorageError"in a}class cY extends cW{constructor(a,b,c){super(a),this.name="StorageApiError",this.status=b,this.statusCode=c}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class cZ extends cW{constructor(a,b){super(a),this.name="StorageUnknownError",this.originalError=b}}let c$=b=>{let c;return c=b||("undefined"==typeof fetch?(...b)=>a.A(59789).then(({default:a})=>a(...b)):fetch),(...a)=>c(...a)},c_=a=>{if(Array.isArray(a))return a.map(a=>c_(a));if("function"==typeof a||a!==Object(a))return a;let b={};return Object.entries(a).forEach(([a,c])=>{b[a.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""))]=c_(c)}),b};var c0=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})};let c1=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a);function c2(b,c,d,e,f,g){return c0(this,void 0,void 0,function*(){return new Promise((h,i)=>{b(d,((a,b,c,d)=>{let e={method:a,headers:(null==b?void 0:b.headers)||{}};return"GET"!==a&&d?((a=>{if("object"!=typeof a||null===a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)})(d)?(e.headers=Object.assign({"Content-Type":"application/json"},null==b?void 0:b.headers),e.body=JSON.stringify(d)):e.body=d,(null==b?void 0:b.duplex)&&(e.duplex=b.duplex),Object.assign(Object.assign({},e),c)):e})(c,e,f,g)).then(a=>{if(!a.ok)throw a;return(null==e?void 0:e.noResolveJson)?a:a.json()}).then(a=>h(a)).catch(b=>c0(void 0,void 0,void 0,function*(){var c,d,f,g;let h=yield(c=void 0,d=void 0,f=void 0,g=function*(){return"undefined"==typeof Response?(yield a.A(59789)).Response:Response},new(f||(f=Promise))(function(a,b){function e(a){try{i(g.next(a))}catch(a){b(a)}}function h(a){try{i(g.throw(a))}catch(a){b(a)}}function i(b){var c;b.done?a(b.value):((c=b.value)instanceof f?c:new f(function(a){a(c)})).then(e,h)}i((g=g.apply(c,d||[])).next())}));b instanceof h&&!(null==e?void 0:e.noResolveJson)?b.json().then(a=>{let c=b.status||500,d=(null==a?void 0:a.statusCode)||c+"";i(new cY(c1(a),c,d))}).catch(a=>{i(new cZ(c1(a),a))}):i(new cZ(c1(b),b))}))})})}function c3(a,b,c,d){return c0(this,void 0,void 0,function*(){return c2(a,"GET",b,c,d)})}function c4(a,b,c,d,e){return c0(this,void 0,void 0,function*(){return c2(a,"POST",b,d,e,c)})}function c5(a,b,c,d,e){return c0(this,void 0,void 0,function*(){return c2(a,"PUT",b,d,e,c)})}function c6(a,b,c,d,e){return c0(this,void 0,void 0,function*(){return c2(a,"DELETE",b,d,e,c)})}var c7=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})};let c8={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},c9={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class da{constructor(a,b={},c,d){this.url=a,this.headers=b,this.bucketId=c,this.fetch=c$(d)}uploadOrUpdate(a,b,c,d){return c7(this,void 0,void 0,function*(){try{let e,f=Object.assign(Object.assign({},c9),d),g=Object.assign(Object.assign({},this.headers),"POST"===a&&{"x-upsert":String(f.upsert)}),h=f.metadata;"undefined"!=typeof Blob&&c instanceof Blob?((e=new FormData).append("cacheControl",f.cacheControl),h&&e.append("metadata",this.encodeMetadata(h)),e.append("",c)):"undefined"!=typeof FormData&&c instanceof FormData?((e=c).append("cacheControl",f.cacheControl),h&&e.append("metadata",this.encodeMetadata(h))):(e=c,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,h&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),(null==d?void 0:d.headers)&&(g=Object.assign(Object.assign({},g),d.headers));let i=this._removeEmptyFolders(b),j=this._getFinalPath(i),k=yield("PUT"==a?c5:c4)(this.fetch,`${this.url}/object/${j}`,e,Object.assign({headers:g},(null==f?void 0:f.duplex)?{duplex:f.duplex}:{}));return{data:{path:i,id:k.Id,fullPath:k.Key},error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}upload(a,b,c){return c7(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,b,c)})}uploadToSignedUrl(a,b,c,d){return c7(this,void 0,void 0,function*(){let e=this._removeEmptyFolders(a),f=this._getFinalPath(e),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",b);try{let a,b=Object.assign({upsert:c9.upsert},d),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(b.upsert)});"undefined"!=typeof Blob&&c instanceof Blob?((a=new FormData).append("cacheControl",b.cacheControl),a.append("",c)):"undefined"!=typeof FormData&&c instanceof FormData?(a=c).append("cacheControl",b.cacheControl):(a=c,f["cache-control"]=`max-age=${b.cacheControl}`,f["content-type"]=b.contentType);let h=yield c5(this.fetch,g.toString(),a,{headers:f});return{data:{path:e,fullPath:h.Key},error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(a,b){return c7(this,void 0,void 0,function*(){try{let c=this._getFinalPath(a),d=Object.assign({},this.headers);(null==b?void 0:b.upsert)&&(d["x-upsert"]="true");let e=yield c4(this.fetch,`${this.url}/object/upload/sign/${c}`,{},{headers:d}),f=new URL(this.url+e.url),g=f.searchParams.get("token");if(!g)throw new cW("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}update(a,b,c){return c7(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,b,c)})}move(a,b,c){return c7(this,void 0,void 0,function*(){try{return{data:yield c4(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}copy(a,b,c){return c7(this,void 0,void 0,function*(){try{return{data:{path:(yield c4(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}createSignedUrl(a,b,c){return c7(this,void 0,void 0,function*(){try{let d=this._getFinalPath(a),e=yield c4(this.fetch,`${this.url}/object/sign/${d}`,Object.assign({expiresIn:b},(null==c?void 0:c.transform)?{transform:c.transform}:{}),{headers:this.headers}),f=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{data:e={signedUrl:encodeURI(`${this.url}${e.signedURL}${f}`)},error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}createSignedUrls(a,b,c){return c7(this,void 0,void 0,function*(){try{let d=yield c4(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:b,paths:a},{headers:this.headers}),e=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{data:d.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${e}`):null})),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}download(a,b){return c7(this,void 0,void 0,function*(){let c=void 0!==(null==b?void 0:b.transform),d=this.transformOptsToQueryString((null==b?void 0:b.transform)||{}),e=d?`?${d}`:"";try{let b=this._getFinalPath(a),d=yield c3(this.fetch,`${this.url}/${c?"render/image/authenticated":"object"}/${b}${e}`,{headers:this.headers,noResolveJson:!0});return{data:yield d.blob(),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}info(a){return c7(this,void 0,void 0,function*(){let b=this._getFinalPath(a);try{let a=yield c3(this.fetch,`${this.url}/object/info/${b}`,{headers:this.headers});return{data:c_(a),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}exists(a){return c7(this,void 0,void 0,function*(){let b=this._getFinalPath(a);try{return yield function(a,b,c,d){return c0(this,void 0,void 0,function*(){return c2(a,"HEAD",b,Object.assign(Object.assign({},c),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${b}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(cX(a)&&a instanceof cZ){let b=a.originalError;if([400,404].includes(null==b?void 0:b.status))return{data:!1,error:a}}throw a}})}getPublicUrl(a,b){let c=this._getFinalPath(a),d=[],e=(null==b?void 0:b.download)?`download=${!0===b.download?"":b.download}`:"";""!==e&&d.push(e);let f=void 0!==(null==b?void 0:b.transform),g=this.transformOptsToQueryString((null==b?void 0:b.transform)||{});""!==g&&d.push(g);let h=d.join("&");return""!==h&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${f?"render/image":"object"}/public/${c}${h}`)}}}remove(a){return c7(this,void 0,void 0,function*(){try{return{data:yield c6(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}list(a,b,c){return c7(this,void 0,void 0,function*(){try{let d=Object.assign(Object.assign(Object.assign({},c8),b),{prefix:a||""});return{data:yield c4(this.fetch,`${this.url}/object/list/${this.bucketId}`,d,{headers:this.headers},c),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}listV2(a,b){return c7(this,void 0,void 0,function*(){try{let c=Object.assign({},a);return{data:yield c4(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,c,{headers:this.headers},b),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return"undefined"!=typeof Buffer?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){let b=[];return a.width&&b.push(`width=${a.width}`),a.height&&b.push(`height=${a.height}`),a.resize&&b.push(`resize=${a.resize}`),a.format&&b.push(`format=${a.format}`),a.quality&&b.push(`quality=${a.quality}`),b.join("&")}}let db={"X-Client-Info":"storage-js/2.11.0"};var dc=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})};class dd{constructor(a,b={},c,d){let e=new URL(a);(null==d?void 0:d.useNewHostname)&&/supabase\.(co|in|red)$/.test(e.hostname)&&!e.hostname.includes("storage.supabase.")&&(e.hostname=e.hostname.replace("supabase.","storage.supabase.")),this.url=e.href,this.headers=Object.assign(Object.assign({},db),b),this.fetch=c$(c)}listBuckets(){return dc(this,void 0,void 0,function*(){try{return{data:yield c3(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}getBucket(a){return dc(this,void 0,void 0,function*(){try{return{data:yield c3(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}createBucket(a,b={public:!1}){return dc(this,void 0,void 0,function*(){try{return{data:yield c4(this.fetch,`${this.url}/bucket`,{id:a,name:a,type:b.type,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}updateBucket(a,b){return dc(this,void 0,void 0,function*(){try{return{data:yield c5(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}emptyBucket(a){return dc(this,void 0,void 0,function*(){try{return{data:yield c4(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}deleteBucket(a){return dc(this,void 0,void 0,function*(){try{return{data:yield c6(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(a){if(cX(a))return{data:null,error:a};throw a}})}}class de extends dd{constructor(a,b={},c,d){super(a,b,c,d)}from(a){return new da(this.url,this.headers,a,this.fetch)}}let df="";df="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let dg={headers:{"X-Client-Info":`supabase-js-${df}/2.56.0`}},dh={schema:"public"},di={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dj={};var dk=a.i(23952);let dl="2.71.1",dm={"X-Client-Info":`gotrue-js/${dl}`},dn="X-Supabase-Api-Version",dp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},dq=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class dr extends Error{constructor(a,b,c){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=b,this.code=c}}function ds(a){return"object"==typeof a&&null!==a&&"__isAuthError"in a}class dt extends dr{constructor(a,b,c){super(a,b,c),this.name="AuthApiError",this.status=b,this.code=c}}class du extends dr{constructor(a,b){super(a),this.name="AuthUnknownError",this.originalError=b}}class dv extends dr{constructor(a,b,c,d){super(a,c,d),this.name=b,this.status=c}}class dw extends dv{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class dx extends dv{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class dy extends dv{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class dz extends dv{constructor(a,b=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=b}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class dA extends dv{constructor(a,b){super(a,"AuthRetryableFetchError",b,void 0)}}function dB(a){return ds(a)&&"AuthRetryableFetchError"===a.name}class dC extends dv{constructor(a,b,c){super(a,"AuthWeakPasswordError",b,"weak_password"),this.reasons=c}}class dD extends dv{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}let dE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),dF=" 	\n\r=".split(""),dG=(()=>{let a=Array(128);for(let b=0;b<a.length;b+=1)a[b]=-1;for(let b=0;b<dF.length;b+=1)a[dF[b].charCodeAt(0)]=-2;for(let b=0;b<dE.length;b+=1)a[dE[b].charCodeAt(0)]=b;return a})();function dH(a,b,c){if(null!==a)for(b.queue=b.queue<<8|a,b.queuedBits+=8;b.queuedBits>=6;)c(dE[b.queue>>b.queuedBits-6&63]),b.queuedBits-=6;else if(b.queuedBits>0)for(b.queue=b.queue<<6-b.queuedBits,b.queuedBits=6;b.queuedBits>=6;)c(dE[b.queue>>b.queuedBits-6&63]),b.queuedBits-=6}function dI(a,b,c){let d=dG[a];if(d>-1)for(b.queue=b.queue<<6|d,b.queuedBits+=6;b.queuedBits>=8;)c(b.queue>>b.queuedBits-8&255),b.queuedBits-=8;else if(-2===d)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}function dJ(a){let b=[],c=a=>{b.push(String.fromCodePoint(a))},d={utf8seq:0,codepoint:0},e={queue:0,queuedBits:0},f=a=>{!function(a,b,c){if(0===b.utf8seq){if(a<=127)return c(a);for(let c=1;c<6;c+=1)if((a>>7-c&1)==0){b.utf8seq=c;break}if(2===b.utf8seq)b.codepoint=31&a;else if(3===b.utf8seq)b.codepoint=15&a;else if(4===b.utf8seq)b.codepoint=7&a;else throw Error("Invalid UTF-8 sequence");b.utf8seq-=1}else if(b.utf8seq>0){if(a<=127)throw Error("Invalid UTF-8 sequence");b.codepoint=b.codepoint<<6|63&a,b.utf8seq-=1,0===b.utf8seq&&c(b.codepoint)}}(a,d,c)};for(let b=0;b<a.length;b+=1)dI(a.charCodeAt(b),e,f);return b.join("")}let dK=b=>{let c;return c=b||("undefined"==typeof fetch?(...b)=>a.A(59789).then(({default:a})=>a(...b)):fetch),(...a)=>c(...a)},dL=async(a,b,c)=>{await a.setItem(b,JSON.stringify(c))},dM=async(a,b)=>{let c=await a.getItem(b);if(!c)return null;try{return JSON.parse(c)}catch(a){return c}},dN=async(a,b)=>{await a.removeItem(b)};class dO{constructor(){this.promise=new dO.promiseConstructor((a,b)=>{this.resolve=a,this.reject=b})}}function dP(a){let b=a.split(".");if(3!==b.length)throw new dD("Invalid JWT structure");for(let a=0;a<b.length;a++)if(!dq.test(b[a]))throw new dD("JWT not in base64url format");return{header:JSON.parse(dJ(b[0])),payload:JSON.parse(dJ(b[1])),signature:function(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};for(let b=0;b<a.length;b+=1)dI(a.charCodeAt(b),c,d);return new Uint8Array(b)}(b[2]),raw:{header:b[0],payload:b[1]}}}async function dQ(a){return await new Promise(b=>{setTimeout(()=>b(null),a)})}function dR(a){return("0"+a.toString(16)).substr(-2)}async function dS(a){let b=new TextEncoder().encode(a);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",b))).map(a=>String.fromCharCode(a)).join("")}async function dT(a){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a):btoa(await dS(a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function dU(a,b,c=!1){let d=function(){let a=new Uint32Array(56);if("undefined"==typeof crypto){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",b=a.length,c="";for(let d=0;d<56;d++)c+=a.charAt(Math.floor(Math.random()*b));return c}return crypto.getRandomValues(a),Array.from(a,dR).join("")}(),e=d;c&&(e+="/PASSWORD_RECOVERY"),await dL(a,`${b}-code-verifier`,e);let f=await dT(d),g=d===f?"plain":"s256";return[f,g]}dO.promiseConstructor=Promise;let dV=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,dW=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function dX(a){if(!dW.test(a))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dY(){return new Proxy({},{get:(a,b)=>{if("__isUserNotAvailableProxy"===b)return!0;if("symbol"==typeof b){let a=b.toString();if("Symbol(Symbol.toPrimitive)"===a||"Symbol(Symbol.toStringTag)"===a||"Symbol(util.inspect.custom)"===a)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${b}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,b)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${b}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,b)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${b}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function dZ(a){return JSON.parse(JSON.stringify(a))}var d$=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c};let d_=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),d0=[502,503,504];async function d1(a){var b;let c,d;if(!("object"==typeof a&&null!==a&&"status"in a&&"ok"in a&&"json"in a&&"function"==typeof a.json))throw new dA(d_(a),0);if(d0.includes(a.status))throw new dA(d_(a),a.status);try{c=await a.json()}catch(a){throw new du(d_(a),a)}let e=function(a){let b=a.headers.get(dn);if(!b||!b.match(dV))return null;try{return new Date(`${b}T00:00:00.0Z`)}catch(a){return null}}(a);if(e&&e.getTime()>=dp["2024-01-01"].timestamp&&"object"==typeof c&&c&&"string"==typeof c.code?d=c.code:"object"==typeof c&&c&&"string"==typeof c.error_code&&(d=c.error_code),d){if("weak_password"===d)throw new dC(d_(c),a.status,(null==(b=c.weak_password)?void 0:b.reasons)||[]);else if("session_not_found"===d)throw new dw}else if("object"==typeof c&&c&&"object"==typeof c.weak_password&&c.weak_password&&Array.isArray(c.weak_password.reasons)&&c.weak_password.reasons.length&&c.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0))throw new dC(d_(c),a.status,c.weak_password.reasons);throw new dt(d_(c),a.status||500,d)}async function d2(a,b,c,d){var e;let f=Object.assign({},null==d?void 0:d.headers);f[dn]||(f[dn]=dp["2024-01-01"].name),(null==d?void 0:d.jwt)&&(f.Authorization=`Bearer ${d.jwt}`);let g=null!=(e=null==d?void 0:d.query)?e:{};(null==d?void 0:d.redirectTo)&&(g.redirect_to=d.redirectTo);let h=Object.keys(g).length?"?"+new URLSearchParams(g).toString():"",i=await d3(a,b,c+h,{headers:f,noResolveJson:null==d?void 0:d.noResolveJson},{},null==d?void 0:d.body);return(null==d?void 0:d.xform)?null==d?void 0:d.xform(i):{data:Object.assign({},i),error:null}}async function d3(a,b,c,d,e,f){let g,h=((a,b,c,d)=>{let e={method:a,headers:(null==b?void 0:b.headers)||{}};return"GET"===a?e:(e.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==b?void 0:b.headers),e.body=JSON.stringify(d),Object.assign(Object.assign({},e),c))})(b,d,e,f);try{g=await a(c,Object.assign({},h))}catch(a){throw console.error(a),new dA(d_(a),0)}if(g.ok||await d1(g),null==d?void 0:d.noResolveJson)return g;try{return await g.json()}catch(a){await d1(a)}}function d4(a){var b,c,d;let e=null;(d=a).access_token&&d.refresh_token&&d.expires_in&&(e=Object.assign({},a),a.expires_at||(e.expires_at=(c=a.expires_in,Math.round(Date.now()/1e3)+c)));return{data:{session:e,user:null!=(b=a.user)?b:a},error:null}}function d5(a){let b=d4(a);return!b.error&&a.weak_password&&"object"==typeof a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&"string"==typeof a.weak_password.message&&a.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0)&&(b.data.weak_password=a.weak_password),b}function d6(a){var b;return{data:{user:null!=(b=a.user)?b:a},error:null}}function d7(a){return{data:a,error:null}}function d8(a){let{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f}=a;return{data:{properties:{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f},user:Object.assign({},d$(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function d9(a){return a}let ea=["global","local","others"];var eb=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c};class ec{constructor({url:a="",headers:b={},fetch:c}){this.url=a,this.headers=b,this.fetch=dK(c),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(a,b=ea[0]){if(0>ea.indexOf(b))throw Error(`@supabase/auth-js: Parameter scope must be one of ${ea.join(", ")}`);try{return await d2(this.fetch,"POST",`${this.url}/logout?scope=${b}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(a){if(ds(a))return{data:null,error:a};throw a}}async inviteUserByEmail(a,b={}){try{return await d2(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:b.data},headers:this.headers,redirectTo:b.redirectTo,xform:d6})}catch(a){if(ds(a))return{data:{user:null},error:a};throw a}}async generateLink(a){try{let{options:b}=a,c=eb(a,["options"]),d=Object.assign(Object.assign({},c),b);return"newEmail"in c&&(d.new_email=null==c?void 0:c.newEmail,delete d.newEmail),await d2(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:d8,redirectTo:null==b?void 0:b.redirectTo})}catch(a){if(ds(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(a){try{return await d2(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:d6})}catch(a){if(ds(a))return{data:{user:null},error:a};throw a}}async listUsers(a){var b,c,d,e,f,g,h;try{let i={nextPage:null,lastPage:0,total:0},j=await d2(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(c=null==(b=null==a?void 0:a.page)?void 0:b.toString())?c:"",per_page:null!=(e=null==(d=null==a?void 0:a.perPage)?void 0:d.toString())?e:""},xform:d9});if(j.error)throw j.error;let k=await j.json(),l=null!=(f=j.headers.get("x-total-count"))?f:0,m=null!=(h=null==(g=j.headers.get("link"))?void 0:g.split(","))?h:[];return m.length>0&&(m.forEach(a=>{let b=parseInt(a.split(";")[0].split("=")[1].substring(0,1)),c=JSON.parse(a.split(";")[1].split("=")[1]);i[`${c}Page`]=b}),i.total=parseInt(l)),{data:Object.assign(Object.assign({},k),i),error:null}}catch(a){if(ds(a))return{data:{users:[]},error:a};throw a}}async getUserById(a){dX(a);try{return await d2(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:d6})}catch(a){if(ds(a))return{data:{user:null},error:a};throw a}}async updateUserById(a,b){dX(a);try{return await d2(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:b,headers:this.headers,xform:d6})}catch(a){if(ds(a))return{data:{user:null},error:a};throw a}}async deleteUser(a,b=!1){dX(a);try{return await d2(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:b},xform:d6})}catch(a){if(ds(a))return{data:{user:null},error:a};throw a}}async _listFactors(a){dX(a.userId);try{let{data:b,error:c}=await d2(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:b,error:c}}catch(a){if(ds(a))return{data:null,error:a};throw a}}async _deleteFactor(a){dX(a.userId),dX(a.id);try{return{data:await d2(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(a){if(ds(a))return{data:null,error:a};throw a}}}function ed(a={}){return{getItem:b=>a[b]||null,setItem:(b,c)=>{a[b]=c},removeItem:b=>{delete a[b]}}}globalThis;class ee extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(a){"undefined"!=typeof self&&(self.globalThis=self)}let ef={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:dm,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function eg(a,b,c){return await c()}let eh={};class ei{constructor(a){this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ei.nextInstanceID,ei.nextInstanceID+=1,this.instanceID;let b=Object.assign(Object.assign({},ef),a);this.logDebugMessages=!!b.debug,"function"==typeof b.debug&&(this.logger=b.debug),this.persistSession=b.persistSession,this.storageKey=b.storageKey,this.autoRefreshToken=b.autoRefreshToken,this.admin=new ec({url:b.url,headers:b.headers,fetch:b.fetch}),this.url=b.url,this.headers=b.headers,this.fetch=dK(b.fetch),this.lock=b.lock||eg,this.detectSessionInUrl=b.detectSessionInUrl,this.flowType=b.flowType,this.hasCustomAuthorizationHeader=b.hasCustomAuthorizationHeader,b.lock?this.lock=b.lock:this.lock=eg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(b.storage?this.storage=b.storage:(this.memoryStorage={},this.storage=ed(this.memoryStorage)),b.userStorage&&(this.userStorage=b.userStorage)):(this.memoryStorage={},this.storage=ed(this.memoryStorage)),this.initialize()}get jwks(){var a,b;return null!=(b=null==(a=eh[this.storageKey])?void 0:a.jwks)?b:{keys:[]}}set jwks(a){eh[this.storageKey]=Object.assign(Object.assign({},eh[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,b;return null!=(b=null==(a=eh[this.storageKey])?void 0:a.cachedAt)?b:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){eh[this.storageKey]=Object.assign(Object.assign({},eh[this.storageKey]),{cachedAt:a})}_debug(...a){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${dl}) ${new Date().toISOString()}`,...a),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{let a=function(a){let b={},c=new URL(a);if(c.hash&&"#"===c.hash[0])try{new URLSearchParams(c.hash.substring(1)).forEach((a,c)=>{b[c]=a})}catch(a){}return c.searchParams.forEach((a,c)=>{b[c]=a}),b}(window.location.href);return this._isImplicitGrantCallback(a)||await this._isPKCECallback(a),await this._recoverAndRefresh(),{error:null}}catch(a){if(ds(a))return{error:a};return{error:new du("Unexpected error during initialization",a)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var b,c,d;try{let{data:e,error:f}=await d2(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(c=null==(b=null==a?void 0:a.options)?void 0:b.data)?c:{},gotrue_meta_security:{captcha_token:null==(d=null==a?void 0:a.options)?void 0:d.captchaToken}},xform:d4});if(f||!e)return{data:{user:null,session:null},error:f};let g=e.session,h=e.user;return e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:h,session:g},error:null}}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(a){var b,c,d;try{let e;if("email"in a){let{email:c,password:d,options:f}=a,g=null,h=null;"pkce"===this.flowType&&([g,h]=await dU(this.storage,this.storageKey)),e=await d2(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==f?void 0:f.emailRedirectTo,body:{email:c,password:d,data:null!=(b=null==f?void 0:f.data)?b:{},gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken},code_challenge:g,code_challenge_method:h},xform:d4})}else if("phone"in a){let{phone:b,password:f,options:g}=a;e=await d2(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:f,data:null!=(c=null==g?void 0:g.data)?c:{},channel:null!=(d=null==g?void 0:g.channel)?d:"sms",gotrue_meta_security:{captcha_token:null==g?void 0:g.captchaToken}},xform:d4})}else throw new dy("You must provide either an email or phone number and a password");let{data:f,error:g}=e;if(g||!f)return{data:{user:null,session:null},error:g};let h=f.session,i=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:i,session:h},error:null}}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(a){try{let b;if("email"in a){let{email:c,password:d,options:e}=a;b=await d2(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:d5})}else if("phone"in a){let{phone:c,password:d,options:e}=a;b=await d2(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:d5})}else throw new dy("You must provide either an email or phone number and a password");let{data:c,error:d}=b;if(d)return{data:{user:null,session:null},error:d};if(!c||!c.session||!c.user)return{data:{user:null,session:null},error:new dx};return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign({user:c.user,session:c.session},c.weak_password?{weakPassword:c.weak_password}:null),error:d}}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOAuth(a){var b,c,d,e;return await this._handleProviderSignIn(a.provider,{redirectTo:null==(b=a.options)?void 0:b.redirectTo,scopes:null==(c=a.options)?void 0:c.scopes,queryParams:null==(d=a.options)?void 0:d.queryParams,skipBrowserRedirect:null==(e=a.options)?void 0:e.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){let{chain:b}=a;if("solana"===b)return await this.signInWithSolana(a);throw Error(`@supabase/auth-js: Unsupported chain "${b}"`)}async signInWithSolana(a){var b,c,d,e,f,g,h,i,j,k,l,m;let n,o;if("message"in a)n=a.message,o=a.signature;else{let{chain:l,wallet:m,statement:p,options:q}=a;if("object"!=typeof m||!(null==q?void 0:q.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");let r=new URL(null!=(b=null==q?void 0:q.url)?b:window.location.href);if("signIn"in m&&m.signIn){let a,b=await m.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==q?void 0:q.signInWithSolana),{version:"1",domain:r.host,uri:r.href}),p?{statement:p}:null));if(Array.isArray(b)&&b[0]&&"object"==typeof b[0])a=b[0];else if(b&&"object"==typeof b&&"signedMessage"in b&&"signature"in b)a=b;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in a&&"signature"in a&&("string"==typeof a.signedMessage||a.signedMessage instanceof Uint8Array)&&a.signature instanceof Uint8Array)n="string"==typeof a.signedMessage?a.signedMessage:new TextDecoder().decode(a.signedMessage),o=a.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in m)||"function"!=typeof m.signMessage||!("publicKey"in m)||"object"!=typeof m||!m.publicKey||!("toBase58"in m.publicKey)||"function"!=typeof m.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");n=[`${r.host} wants you to sign in with your Solana account:`,m.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${r.href}`,`Issued At: ${null!=(d=null==(c=null==q?void 0:q.signInWithSolana)?void 0:c.issuedAt)?d:new Date().toISOString()}`,...(null==(e=null==q?void 0:q.signInWithSolana)?void 0:e.notBefore)?[`Not Before: ${q.signInWithSolana.notBefore}`]:[],...(null==(f=null==q?void 0:q.signInWithSolana)?void 0:f.expirationTime)?[`Expiration Time: ${q.signInWithSolana.expirationTime}`]:[],...(null==(g=null==q?void 0:q.signInWithSolana)?void 0:g.chainId)?[`Chain ID: ${q.signInWithSolana.chainId}`]:[],...(null==(h=null==q?void 0:q.signInWithSolana)?void 0:h.nonce)?[`Nonce: ${q.signInWithSolana.nonce}`]:[],...(null==(i=null==q?void 0:q.signInWithSolana)?void 0:i.requestId)?[`Request ID: ${q.signInWithSolana.requestId}`]:[],...(null==(k=null==(j=null==q?void 0:q.signInWithSolana)?void 0:j.resources)?void 0:k.length)?["Resources",...q.signInWithSolana.resources.map(a=>`- ${a}`)]:[]].join("\n");let a=await m.signMessage(new TextEncoder().encode(n),"utf8");if(!a||!(a instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");o=a}}try{let{data:b,error:c}=await d2(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:n,signature:function(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};return a.forEach(a=>dH(a,c,d)),dH(null,c,d),b.join("")}(o)},(null==(l=a.options)?void 0:l.captchaToken)?{gotrue_meta_security:{captcha_token:null==(m=a.options)?void 0:m.captchaToken}}:null),xform:d4});if(c)throw c;if(!b||!b.session||!b.user)return{data:{user:null,session:null},error:new dx};return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:c}}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async _exchangeCodeForSession(a){let b=await dM(this.storage,`${this.storageKey}-code-verifier`),[c,d]=(null!=b?b:"").split("/");try{let{data:b,error:e}=await d2(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:c},xform:d4});if(await dN(this.storage,`${this.storageKey}-code-verifier`),e)throw e;if(!b||!b.session||!b.user)return{data:{user:null,session:null,redirectType:null},error:new dx};return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign(Object.assign({},b),{redirectType:null!=d?d:null}),error:e}}catch(a){if(ds(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(a){try{let{options:b,provider:c,token:d,access_token:e,nonce:f}=a,{data:g,error:h}=await d2(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:c,id_token:d,access_token:e,nonce:f,gotrue_meta_security:{captcha_token:null==b?void 0:b.captchaToken}},xform:d4});if(h)return{data:{user:null,session:null},error:h};if(!g||!g.session||!g.user)return{data:{user:null,session:null},error:new dx};return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:h}}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOtp(a){var b,c,d,e,f;try{if("email"in a){let{email:d,options:e}=a,f=null,g=null;"pkce"===this.flowType&&([f,g]=await dU(this.storage,this.storageKey));let{error:h}=await d2(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:null!=(b=null==e?void 0:e.data)?b:{},create_user:null==(c=null==e?void 0:e.shouldCreateUser)||c,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:null==e?void 0:e.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in a){let{phone:b,options:c}=a,{data:g,error:h}=await d2(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:b,data:null!=(d=null==c?void 0:c.data)?d:{},create_user:null==(e=null==c?void 0:c.shouldCreateUser)||e,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},channel:null!=(f=null==c?void 0:c.channel)?f:"sms"}});return{data:{user:null,session:null,messageId:null==g?void 0:g.message_id},error:h}}throw new dy("You must provide either an email or phone number.")}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(a){var b,c;try{let d,e;"options"in a&&(d=null==(b=a.options)?void 0:b.redirectTo,e=null==(c=a.options)?void 0:c.captchaToken);let{data:f,error:g}=await d2(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:e}}),redirectTo:d,xform:d4});if(g)throw g;if(!f)throw Error("An error occurred on token verification.");let h=f.session,i=f.user;return(null==h?void 0:h.access_token)&&(await this._saveSession(h),await this._notifyAllSubscribers("recovery"==a.type?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:i,session:h},error:null}}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(a){var b,c,d;try{let e=null,f=null;return"pkce"===this.flowType&&([e,f]=await dU(this.storage,this.storageKey)),await d2(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:null!=(c=null==(b=a.options)?void 0:b.redirectTo)?c:void 0}),(null==(d=null==a?void 0:a.options)?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:e,code_challenge_method:f}),headers:this.headers,xform:d7})}catch(a){if(ds(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{let{data:{session:b},error:c}=a;if(c)throw c;if(!b)throw new dw;let{error:d}=await d2(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:b.access_token});return{data:{user:null,session:null},error:d}})}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async resend(a){try{let b=`${this.url}/resend`;if("email"in a){let{email:c,type:d,options:e}=a,{error:f}=await d2(this.fetch,"POST",b,{headers:this.headers,body:{email:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},redirectTo:null==e?void 0:e.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in a){let{phone:c,type:d,options:e}=a,{data:f,error:g}=await d2(this.fetch,"POST",b,{headers:this.headers,body:{phone:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}}});return{data:{user:null,session:null,messageId:null==f?void 0:f.message_id},error:g}}throw new dy("You must provide either an email or phone number and a type")}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(a,b){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){let a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),c=(async()=>(await a,await b()))();return this.pendingInLock.push((async()=>{try{await c}catch(a){}})()),c}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let a=b();for(this.pendingInLock.push((async()=>{try{await a}catch(a){}})()),await a;this.pendingInLock.length;){let a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{let b=await this.__loadSession();return await a(b)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let a=null,b=await dM(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",b),null!==b&&(this._isValidSession(b)?a=b:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};let c=!!a.expires_at&&1e3*a.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${c?"":" not"} expired`,"expires_at",a.expires_at),!c){if(this.userStorage){let b=await dM(this.userStorage,this.storageKey+"-user");(null==b?void 0:b.user)?a.user=b.user:a.user=dY()}if(this.storage.isServer&&a.user){let b=this.suppressGetSessionWarning;a=new Proxy(a,{get:(a,c,d)=>(b||"user"!==c||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),b=!0,this.suppressGetSessionWarning=!0),Reflect.get(a,c,d))})}return{data:{session:a},error:null}}let{session:d,error:e}=await this._callRefreshToken(a.refresh_token);if(e)return{data:{session:null},error:e};return{data:{session:d},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{if(a)return await d2(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:d6});return await this._useSession(async a=>{var b,c,d;let{data:e,error:f}=a;if(f)throw f;return(null==(b=e.session)?void 0:b.access_token)||this.hasCustomAuthorizationHeader?await d2(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0,xform:d6}):{data:{user:null},error:new dw}})}catch(a){if(ds(a))return ds(a)&&"AuthSessionMissingError"===a.name&&(await this._removeSession(),await dN(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:a};throw a}}async updateUser(a,b={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,b))}async _updateUser(a,b={}){try{return await this._useSession(async c=>{let{data:d,error:e}=c;if(e)throw e;if(!d.session)throw new dw;let f=d.session,g=null,h=null;"pkce"===this.flowType&&null!=a.email&&([g,h]=await dU(this.storage,this.storageKey));let{data:i,error:j}=await d2(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==b?void 0:b.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:h}),jwt:f.access_token,xform:d6});if(j)throw j;return f.user=i.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(a){if(ds(a))return{data:{user:null},error:a};throw a}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new dw;let b=Date.now()/1e3,c=b,d=!0,e=null,{payload:f}=dP(a.access_token);if(f.exp&&(d=(c=f.exp)<=b),d){let{session:b,error:c}=await this._callRefreshToken(a.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!b)return{data:{user:null,session:null},error:null};e=b}else{let{data:d,error:f}=await this._getUser(a.access_token);if(f)throw f;e={access_token:a.access_token,refresh_token:a.refresh_token,user:d.user,token_type:"bearer",expires_in:c-b,expires_at:c},await this._saveSession(e),await this._notifyAllSubscribers("SIGNED_IN",e)}return{data:{user:e.user,session:e},error:null}}catch(a){if(ds(a))return{data:{session:null,user:null},error:a};throw a}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async b=>{var c;if(!a){let{data:d,error:e}=b;if(e)throw e;a=null!=(c=d.session)?c:void 0}if(!(null==a?void 0:a.refresh_token))throw new dw;let{session:d,error:e}=await this._callRefreshToken(a.refresh_token);return e?{data:{user:null,session:null},error:e}:d?{data:{user:d.user,session:d},error:null}:{data:{user:null,session:null},error:null}})}catch(a){if(ds(a))return{data:{user:null,session:null},error:a};throw a}}async _getSessionFromURL(a,b){try{throw new dz("No browser detected.")}catch(a){if(ds(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){let b=await dM(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&b)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return{error:e};let f=null==(c=d.session)?void 0:c.access_token;if(f){let{error:b}=await this.admin.signOut(f,a);if(b&&!(ds(b)&&"AuthApiError"===b.name&&(404===b.status||401===b.status||403===b.status)))return{error:b}}return"others"!==a&&(await this._removeSession(),await dN(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(a){let b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){let b=16*Math.random()|0;return("x"==a?b:3&b|8).toString(16)}),c={id:b,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",b),this.stateChangeEmitters.delete(b)}};return this._debug("#onAuthStateChange()","registered callback with id",b),this.stateChangeEmitters.set(b,c),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(b)})})(),{data:{subscription:c}}}async _emitInitialSession(a){return await this._useSession(async b=>{var c,d;try{let{data:{session:d},error:e}=b;if(e)throw e;await (null==(c=this.stateChangeEmitters.get(a))?void 0:c.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(b){await (null==(d=this.stateChangeEmitters.get(a))?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",b),console.error(b)}})}async resetPasswordForEmail(a,b={}){let c=null,d=null;"pkce"===this.flowType&&([c,d]=await dU(this.storage,this.storageKey,!0));try{return await d2(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:c,code_challenge_method:d,gotrue_meta_security:{captcha_token:b.captchaToken}},headers:this.headers,redirectTo:b.redirectTo})}catch(a){if(ds(a))return{data:null,error:a};throw a}}async getUserIdentities(){var a;try{let{data:b,error:c}=await this.getUser();if(c)throw c;return{data:{identities:null!=(a=b.user.identities)?a:[]},error:null}}catch(a){if(ds(a))return{data:null,error:a};throw a}}async linkIdentity(a){try{let{data:b,error:c}=await this._useSession(async b=>{var c,d,e,f,g;let{data:h,error:i}=b;if(i)throw i;let j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:null==(c=a.options)?void 0:c.redirectTo,scopes:null==(d=a.options)?void 0:d.scopes,queryParams:null==(e=a.options)?void 0:e.queryParams,skipBrowserRedirect:!0});return await d2(this.fetch,"GET",j,{headers:this.headers,jwt:null!=(g=null==(f=h.session)?void 0:f.access_token)?g:void 0})});if(c)throw c;return{data:{provider:a.provider,url:null==b?void 0:b.url},error:null}}catch(b){if(ds(b))return{data:{provider:a.provider,url:null},error:b};throw b}}async unlinkIdentity(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)throw f;return await d2(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0})})}catch(a){if(ds(a))return{data:null,error:a};throw a}}async _refreshAccessToken(a){let b=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(b,"begin");try{var c,d;let e=Date.now();return await (c=async c=>(c>0&&await dQ(200*Math.pow(2,c-1)),this._debug(b,"refreshing attempt",c),await d2(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:d4})),d=(a,b)=>{let c=200*Math.pow(2,a);return b&&dB(b)&&Date.now()+c-e<3e4},new Promise((a,b)=>{(async()=>{for(let e=0;e<1/0;e++)try{let b=await c(e);if(!d(e,null,b))return void a(b)}catch(a){if(!d(e,a))return void b(a)}})()}))}catch(a){if(this._debug(b,"error",a),ds(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(b,"end")}}_isValidSession(a){return"object"==typeof a&&null!==a&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,b){let c=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:b.redirectTo,scopes:b.scopes,queryParams:b.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",b,"url",c),{data:{provider:a,url:c},error:null}}async _recoverAndRefresh(){var a,b;let c="#_recoverAndRefresh()";this._debug(c,"begin");try{let d=await dM(this.storage,this.storageKey);if(d&&this.userStorage){let b=await dM(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!b&&(b={user:d.user},await dL(this.userStorage,this.storageKey+"-user",b)),d.user=null!=(a=null==b?void 0:b.user)?a:dY()}else if(d&&!d.user&&!d.user){let a=await dM(this.storage,this.storageKey+"-user");a&&(null==a?void 0:a.user)?(d.user=a.user,await dN(this.storage,this.storageKey+"-user"),await dL(this.storage,this.storageKey,d)):d.user=dY()}if(this._debug(c,"session from storage",d),!this._isValidSession(d)){this._debug(c,"session is not valid"),null!==d&&await this._removeSession();return}let e=(null!=(b=d.expires_at)?b:1/0)*1e3-Date.now()<9e4;if(this._debug(c,`session has${e?"":" not"} expired with margin of 90000s`),e){if(this.autoRefreshToken&&d.refresh_token){let{error:a}=await this._callRefreshToken(d.refresh_token);a&&(console.error(a),dB(a)||(this._debug(c,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(d.user&&!0===d.user.__isUserNotAvailableProxy)try{let{data:a,error:b}=await this._getUser(d.access_token);!b&&(null==a?void 0:a.user)?(d.user=a.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(c,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(c,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(a){this._debug(c,"error",a),console.error(a);return}finally{this._debug(c,"end")}}async _callRefreshToken(a){var b,c;if(!a)throw new dw;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let d=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new dO;let{data:b,error:c}=await this._refreshAccessToken(a);if(c)throw c;if(!b.session)throw new dw;await this._saveSession(b.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",b.session);let d={session:b.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(a){if(this._debug(d,"error",a),ds(a)){let c={session:null,error:a};return dB(a)||await this._removeSession(),null==(b=this.refreshingDeferred)||b.resolve(c),c}throw null==(c=this.refreshingDeferred)||c.reject(a),a}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(a,b,c=!0){let d=`#_notifyAllSubscribers(${a})`;this._debug(d,"begin",b,`broadcast = ${c}`);try{this.broadcastChannel&&c&&this.broadcastChannel.postMessage({event:a,session:b});let d=[],e=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(a,b)}catch(a){d.push(a)}});if(await Promise.all(e),d.length>0){for(let a=0;a<d.length;a+=1)console.error(d[a]);throw d[0]}}finally{this._debug(d,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;let b=Object.assign({},a),c=b.user&&!0===b.user.__isUserNotAvailableProxy;if(this.userStorage){!c&&b.user&&await dL(this.userStorage,this.storageKey+"-user",{user:b.user});let a=Object.assign({},b);delete a.user;let d=dZ(a);await dL(this.storage,this.storageKey,d)}else{let a=dZ(b);await dL(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await dN(this.storage,this.storageKey),await dN(this.storage,this.storageKey+"-code-verifier"),await dN(this.storage,this.storageKey+"-user"),this.userStorage&&await dN(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()"),this.visibilityChangedCallback,this.visibilityChangedCallback=null}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let a=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=a,a&&"object"==typeof a&&"function"==typeof a.unref?a.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let a=Date.now();try{return await this._useSession(async b=>{let{data:{session:c}}=b;if(!c||!c.refresh_token||!c.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let d=Math.floor((1e3*c.expires_at-a)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),d<=3&&await this._callRefreshToken(c.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof ee)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){return this._debug("#_handleVisibilityChange()"),this.autoRefreshToken&&this.startAutoRefresh(),!1}async _onVisibilityChanged(a){let b=`#_onVisibilityChanged(${a})`;this._debug(b,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState)return void this._debug(b,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,b,c){let d=[`provider=${encodeURIComponent(b)}`];if((null==c?void 0:c.redirectTo)&&d.push(`redirect_to=${encodeURIComponent(c.redirectTo)}`),(null==c?void 0:c.scopes)&&d.push(`scopes=${encodeURIComponent(c.scopes)}`),"pkce"===this.flowType){let[a,b]=await dU(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(b)}`});d.push(c.toString())}if(null==c?void 0:c.queryParams){let a=new URLSearchParams(c.queryParams);d.push(a.toString())}return(null==c?void 0:c.skipBrowserRedirect)&&d.push(`skip_http_redirect=${c.skipBrowserRedirect}`),`${a}?${d.join("&")}`}async _unenroll(a){try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;return e?{data:null,error:e}:await d2(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token})})}catch(a){if(ds(a))return{data:null,error:a};throw a}}async _enroll(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)return{data:null,error:f};let g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},"phone"===a.factorType?{phone:a.phone}:{issuer:a.issuer}),{data:h,error:i}=await d2(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:null==(c=null==e?void 0:e.session)?void 0:c.access_token});return i?{data:null,error:i}:("totp"===a.factorType&&(null==(d=null==h?void 0:h.totp)?void 0:d.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(a){if(ds(a))return{data:null,error:a};throw a}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return{data:null,error:e};let{data:f,error:g}=await d2(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:{code:a.code,challenge_id:a.challengeId},headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),{data:f,error:g})})}catch(a){if(ds(a))return{data:null,error:a};throw a}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;return e?{data:null,error:e}:await d2(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:{channel:a.channel},headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token})})}catch(a){if(ds(a))return{data:null,error:a};throw a}})}async _challengeAndVerify(a){let{data:b,error:c}=await this._challenge({factorId:a.factorId});return c?{data:null,error:c}:await this._verify({factorId:a.factorId,challengeId:b.id,code:a.code})}async _listFactors(){let{data:{user:a},error:b}=await this.getUser();if(b)return{data:null,error:b};let c=(null==a?void 0:a.factors)||[],d=c.filter(a=>"totp"===a.factor_type&&"verified"===a.status),e=c.filter(a=>"phone"===a.factor_type&&"verified"===a.status);return{data:{all:c,totp:d,phone:e},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async a=>{var b,c;let{data:{session:d},error:e}=a;if(e)return{data:null,error:e};if(!d)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:f}=dP(d.access_token),g=null;f.aal&&(g=f.aal);let h=g;return(null!=(c=null==(b=d.user.factors)?void 0:b.filter(a=>"verified"===a.status))?c:[]).length>0&&(h="aal2"),{data:{currentLevel:g,nextLevel:h,currentAuthenticationMethods:f.amr||[]},error:null}}))}async fetchJwk(a,b={keys:[]}){let c=b.keys.find(b=>b.kid===a);if(c)return c;let d=Date.now();if((c=this.jwks.keys.find(b=>b.kid===a))&&this.jwks_cached_at+6e5>d)return c;let{data:e,error:f}=await d2(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return e.keys&&0!==e.keys.length&&(this.jwks=e,this.jwks_cached_at=d,c=e.keys.find(b=>b.kid===a))?c:null}async getClaims(a,b={}){try{let c=a;if(!c){let{data:a,error:b}=await this.getSession();if(b||!a.session)return{data:null,error:b};c=a.session.access_token}let{header:d,payload:e,signature:f,raw:{header:g,payload:h}}=dP(c);(null==b?void 0:b.allowExpired)||function(a){if(!a)throw Error("Missing exp claim");if(a<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(e.exp);let i=!d.alg||d.alg.startsWith("HS")||!d.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(d.kid,(null==b?void 0:b.keys)?{keys:b.keys}:null==b?void 0:b.jwks);if(!i){let{error:a}=await this.getUser(c);if(a)throw a;return{data:{claims:e,header:d,signature:f},error:null}}let j=function(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(d.alg),k=await crypto.subtle.importKey("jwk",i,j,!0,["verify"]);if(!await crypto.subtle.verify(j,k,f,function(a){let b=[];return!function(a,b){for(let c=0;c<a.length;c+=1){let d=a.charCodeAt(c);if(d>55295&&d<=56319){let b=(d-55296)*1024&65535;d=(a.charCodeAt(c+1)-56320&65535|b)+65536,c+=1}!function(a,b){if(a<=127)return b(a);if(a<=2047){b(192|a>>6),b(128|63&a);return}if(a<=65535){b(224|a>>12),b(128|a>>6&63),b(128|63&a);return}if(a<=1114111){b(240|a>>18),b(128|a>>12&63),b(128|a>>6&63),b(128|63&a);return}throw Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}(d,b)}}(a,a=>b.push(a)),new Uint8Array(b)}(`${g}.${h}`)))throw new dD("Invalid JWT signature");return{data:{claims:e,header:d,signature:f},error:null}}catch(a){if(ds(a))return{data:null,error:a};throw a}}}ei.nextInstanceID=0;let ej=ei;class ek extends ej{constructor(a){super(a)}}(function(){if("undefined"==typeof process)return!1;let a=process.version;if(null==a)return!1;let b=a.match(/^v(\d+)\./);return!!b&&18>=parseInt(b[1],10)})()&&console.warn(`⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217`);let el=t.supabase.url,em=t.supabase.anonKey;if(!el||!em)throw Error("Missing Supabase environment variables");let en=new class a{constructor(a,b,c){var d,e,f;if(this.supabaseUrl=a,this.supabaseKey=b,!a)throw Error("supabaseUrl is required.");if(!b)throw Error("supabaseKey is required.");let g=new URL(function(a){return a.endsWith("/")?a:a+"/"}(a));this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);let h=`sb-${g.hostname.split(".")[0]}-auth-token`,i=function(a,b){var c,d;let{db:e,auth:f,realtime:g,global:h}=a,{db:i,auth:j,realtime:k,global:l}=b,m={db:Object.assign(Object.assign({},i),e),auth:Object.assign(Object.assign({},j),f),realtime:Object.assign(Object.assign({},k),g),storage:{},global:Object.assign(Object.assign(Object.assign({},l),h),{headers:Object.assign(Object.assign({},null!=(c=null==l?void 0:l.headers)?c:{}),null!=(d=null==h?void 0:h.headers)?d:{})}),accessToken:()=>{var a,b,c,d;return a=this,b=void 0,d=function*(){return""},new(c=void 0,c=Promise)(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})}};return a.accessToken?m.accessToken=a.accessToken:delete m.accessToken,m}(null!=c?c:{},{db:dh,realtime:dj,auth:Object.assign(Object.assign({},di),{storageKey:h}),global:dg});this.storageKey=null!=(d=i.auth.storageKey)?d:"",this.headers=null!=(e=i.global.headers)?e:{},i.accessToken?(this.accessToken=i.accessToken,this.auth=new Proxy({},{get:(a,b)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(f=i.auth)?f:{},this.headers,i.global.fetch),this.fetch=((a,b,c)=>{let d=(a=>{let b;return b=a||("undefined"==typeof fetch?dk.default:fetch),(...a)=>b(...a)})(c),e="undefined"==typeof Headers?dk.Headers:Headers;return(c,f)=>(function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})})(void 0,void 0,void 0,function*(){var g;let h=null!=(g=yield b())?g:a,i=new e(null==f?void 0:f.headers);return i.has("apikey")||i.set("apikey",a),i.has("Authorization")||i.set("Authorization",`Bearer ${h}`),d(c,Object.assign(Object.assign({},f),{headers:i}))})})(b,this._getAccessToken.bind(this),i.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},i.realtime)),this.rest=new cv(new URL("rest/v1",g).href,{headers:this.headers,schema:i.db.schema,fetch:this.fetch}),this.storage=new de(this.storageUrl.href,this.headers,this.fetch,null==c?void 0:c.storage),i.accessToken||this._listenForAuthEvents()}get functions(){return new cu(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,b={},c={}){return this.rest.rpc(a,b,c)}channel(a,b={config:{}}){return this.realtime.channel(a,b)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var a,b,c,d,e,f;return c=this,d=void 0,e=void 0,f=function*(){if(this.accessToken)return yield this.accessToken();let{data:c}=yield this.auth.getSession();return null!=(b=null==(a=c.session)?void 0:a.access_token)?b:this.supabaseKey},new(e||(e=Promise))(function(a,b){function g(a){try{i(f.next(a))}catch(a){b(a)}}function h(a){try{i(f.throw(a))}catch(a){b(a)}}function i(b){var c;b.done?a(b.value):((c=b.value)instanceof e?c:new e(function(a){a(c)})).then(g,h)}i((f=f.apply(c,d||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,storageKey:e,flowType:f,lock:g,debug:h},i,j){let k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ek({url:this.authUrl.href,headers:Object.assign(Object.assign({},k),i),storageKey:e,autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,flowType:f,lock:g,debug:h,fetch:j,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(a){return new cV(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},null==a?void 0:a.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,b)=>{this._handleTokenChanged(a,"CLIENT",null==b?void 0:b.access_token)})}_handleTokenChanged(a,b,c){("TOKEN_REFRESHED"===a||"SIGNED_IN"===a)&&this.changedAccessToken!==c?this.changedAccessToken=c:"SIGNED_OUT"===a&&(this.realtime.setAuth(),"STORAGE"==b&&this.auth.signOut(),this.changedAccessToken=void 0)}}(el,em,void 0);class eo{static async getComments(a){let{data:b,error:c}=await en.from("comments").select("*").eq("order_id",a).order("created_at",{ascending:!1});if(c)throw c;let d=await this.getPrintscreensForOrder(a);return(b||[]).map(a=>({...a,printscreens:d}))}static async getPrintscreensForOrder(a){try{let{data:b,error:c}=await en.from("file_attachments").select("*").eq("order_id",a).order("created_at",{ascending:!1});if(c)return console.error("❌ Failed to load printscreens:",c),[];return(b||[]).filter(a=>a.file_type&&a.file_type.startsWith("image/"))}catch(a){return console.error("❌ Error loading printscreens:",a),[]}}static async addComment(a){let{data:b,error:c}=await en.from("comments").insert([{...a,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(c)throw c;return b}static async updateComment(a,b){let{data:c,error:d}=await en.from("comments").update({text:b,updated_at:new Date().toISOString()}).eq("id",a).select().single();if(d)throw d;return c}static async deleteComment(a){let{error:b}=await en.from("comments").delete().eq("id",a);if(b)throw b}static async getReminders(a){let{data:b,error:c}=await en.from("reminders").select("*").eq("order_id",a).order("due_date",{ascending:!0});if(c)throw c;return b||[]}static async addReminder(a,b){let{data:c,error:d}=await en.from("reminders").insert([{order_id:a,...b,created_at:new Date().toISOString()}]).select().single();if(d)throw d;return c}static async updateReminder(a,b){let{data:c,error:d}=await en.from("reminders").update(b).eq("id",a).select().single();if(d)throw d;return c}static async deleteReminder(a){let{error:b}=await en.from("reminders").delete().eq("id",a);if(b)throw b}static async getFiles(a){let{data:b,error:c}=await en.from("file_attachments").select("*").eq("order_id",a).order("created_at",{ascending:!1});if(c)throw c;return b||[]}static async uploadFileToStorage(a,b){console.log("🔍 Starting file upload to Storage...");try{let c=`${Date.now()}_${b.name}`,d=`${a}/${c}`;console.log("📤 Uploading to Storage:",d);let{error:e}=await en.storage.from("files").upload(d,b);if(e)throw console.error("❌ Storage upload failed:",e),e;let{data:f}=en.storage.from("files").getPublicUrl(d);if(!f.publicUrl)throw Error("Failed to get public URL");let g={order_id:a,filename:b.name,file_url:f.publicUrl,file_type:b.type||"application/octet-stream",created_at:new Date().toISOString()};console.log("📤 Saving metadata to DB:",g);let{data:h,error:i}=await en.from("file_attachments").insert([g]).select().single();if(i)throw console.error("❌ Failed to save metadata:",i),i;return console.log("✅ File uploaded successfully:",b.name),{id:h.id,order_id:a,filename:b.name,file_url:f.publicUrl,file_type:b.type||"application/octet-stream",created_at:h.created_at}}catch(a){throw console.error("❌ Upload failed:",a),a}}static async uploadPrintscreen(a,b){try{let c=`printscreen_${Date.now()}_${b.name}`,d=`${a}/printscreens/${c}`,{error:e}=await en.storage.from("files").upload(d,b);if(e)throw e;let{data:f}=en.storage.from("files").getPublicUrl(d);if(!f.publicUrl)throw Error("Failed to get public URL");let g={order_id:a,filename:b.name,file_url:f.publicUrl,file_type:b.type||"image/png",created_at:new Date().toISOString()},{data:h,error:i}=await en.from("file_attachments").insert([g]).select().single();if(i)throw i;return{id:h.id,order_id:a,filename:b.name,file_url:f.publicUrl,file_type:b.type||"image/png",created_at:h.created_at}}catch(a){throw console.error("Printscreen upload failed:",a),a}}static async deleteFile(a){let{data:b,error:c}=await en.from("file_attachments").select("file_url").eq("id",a).single();if(c)throw c;let d=new URL(b.file_url).pathname.split("/"),e=d.findIndex(a=>"files"===a),f=d.slice(e+1).join("/"),{error:g}=await en.storage.from("files").remove([f]);if(g)throw g;let{error:h}=await en.from("file_attachments").delete().eq("id",a);if(h)throw h}}function ep({order:a,isOpen:b,onClose:c}){let d,[e,f]=(0,s.useState)("details"),[g,h]=(0,s.useState)([]),[i,j]=(0,s.useState)([]),[k,l]=(0,s.useState)([]),[m,n]=(0,s.useState)(""),[o,p]=(0,s.useState)({title:"",due_date:"",is_completed:!1});(0,s.useEffect)(()=>{let c=async()=>{if(a)try{let[b,c,d]=await Promise.all([eo.getComments(a.id),eo.getReminders(a.id),eo.getFiles(a.id)]);h(b),j(c),l(d)}catch(a){console.error("Failed to load order data:",a)}};a&&b&&c()},[a,b]);let q=async()=>{if(a&&m.trim())try{let b=await eo.addComment({order_id:a.id,text:m});h(a=>[b,...a]),n("")}catch(a){console.error("Failed to add comment:",a)}},t=async()=>{if(a&&o.title.trim()&&o.due_date)try{let b=await eo.addReminder(a.id,{title:o.title,due_date:o.due_date,is_completed:!1});j(a=>[...a,b]),p({title:"",due_date:"",is_completed:!1})}catch(a){console.error("Failed to add reminder:",a)}},u=async b=>{if(a&&b.target.files?.length)try{let c=b.target.files[0],d=await eo.uploadFileToStorage(a.id,c);l(a=>[d,...a])}catch(a){console.error("Failed to upload file:",a)}},v=a=>{try{return ae(new Date(a),"yyyy-MM-dd")}catch{return a}};return a?(0,r.jsxs)(ck,{open:b,onClose:c,className:"relative z-50",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)(ck.Panel,{className:"mx-auto max-w-4xl w-full h-[90vh] bg-white dark:bg-gray-800 rounded-xl shadow-2xl flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)(ck.Title,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Užsakymo detalės: ",a.client]}),(0,r.jsx)("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,r.jsx)(cl,{className:"w-6 h-6"})})]}),(0,r.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"details",label:"Detalės",icon:null},{id:"comments",label:"Komentarai",icon:cn},{id:"reminders",label:"Priminimai",icon:co},{id:"files",label:"Failai",icon:cp}].map(a=>(0,r.jsx)("button",{onClick:()=>f(a.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${e===a.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[a.icon&&(0,r.jsx)(a.icon,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:a.label})]})},a.id))})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:["details"===e&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Pagrindinė informacija"}),(0,r.jsxs)("dl",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Klientas"}),(0,r.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:a.client})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Agentūra"}),(0,r.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:a.agency||"-"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Užsakymo Nr."}),(0,r.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:a.invoice_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Statusas"}),(0,r.jsx)("dd",{children:(0,r.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a.approved?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:a.approved?"Patvirtinta":"Nepatvirtinta"})})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Datos ir kaina"}),(0,r.jsxs)("dl",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Data nuo"}),(0,r.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:v(a.from)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Data iki"}),(0,r.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:v(a.to)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Galutinė kaina"}),(0,r.jsx)("dd",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(d=a.final_price,new Intl.NumberFormat("lt-LT",{style:"currency",currency:"EUR"}).format(d))})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Papildoma informacija"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:a.viaduct,readOnly:!0,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Viadukas"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:a.media_received,readOnly:!0,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Medija gauta"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:a.invoice_sent,readOnly:!0,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Sąskaita išsiųsta"})]})]})]})]}),"comments"===e&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("input",{type:"text",value:m,onChange:a=>n(a.target.value),placeholder:"Pridėti komentarą...",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"}),(0,r.jsx)("button",{onClick:q,disabled:!m.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Pridėti"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[g.map(a=>(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:a.text}),(0,r.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:v(a.created_at)})]})},a.id)),0===g.length&&(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"Komentarų nėra"})]})]}),"reminders"===e&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Pridėti priminimą"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,r.jsx)("input",{type:"text",value:o.title,onChange:a=>p(b=>({...b,title:a.target.value})),placeholder:"Pavadinimas",className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"}),(0,r.jsx)("input",{type:"date",value:o.due_date,onChange:a=>p(b=>({...b,due_date:a.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),(0,r.jsx)("button",{onClick:t,disabled:!o.title.trim()||!o.due_date,className:"mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Pridėti priminimą"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[i.map(a=>(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white",children:a.title}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Iki: ",v(a.due_date)]})]}),(0,r.jsx)("input",{type:"checkbox",checked:a.is_completed,onChange:async b=>{try{await eo.updateReminder(a.id,{is_completed:b.target.checked}),j(c=>c.map(c=>c.id===a.id?{...c,is_completed:b.target.checked}:c))}catch(a){console.error("Failed to update reminder:",a)}},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})]})},a.id)),0===i.length&&(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"Priminimų nėra"})]})]}),"files"===e&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Pridėti failą"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"file",onChange:u,accept:".jpg,.jpeg,.png,.pdf,.xls,.xlsx",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"}),(0,r.jsx)(cp,{className:"w-5 h-5 text-gray-400"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[k.map(a=>(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(cp,{className:"w-8 h-8 text-gray-400"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:a.filename}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:v(a.created_at)})]})]}),(0,r.jsxs)("div",{className:"mt-3 flex space-x-2",children:[(0,r.jsx)("a",{href:a.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Peržiūrėti"}),(0,r.jsx)("button",{onClick:async()=>{try{await eo.deleteFile(a.id),l(b=>b.filter(b=>b.id!==a.id))}catch(a){console.error("Failed to delete file:",a)}},className:"text-sm text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:"Ištrinti"})]})]},a.id)),0===k.length&&(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8 col-span-full",children:"Failų nėra"})]})]})]})]})})]}):null}var eq=a.i(71987);function er({order:a,isOpen:b,onClose:c,onOrderUpdated:d}){let[e,f]=(0,s.useState)({}),[g,h]=(0,s.useState)([]),[i,j]=(0,s.useState)([]),[k,l]=(0,s.useState)([]),[m,n]=(0,s.useState)(!1),[o,p]=(0,s.useState)(""),[q,t]=(0,s.useState)(""),[u,v]=(0,s.useState)(""),[x,y]=(0,s.useState)([]),[z,A]=(0,s.useState)(null),B=async()=>{if(a)try{let b=await w.getQuoteByOrderId(a.invoice_id);A(b)}catch(b){console.log("No quote found for order:",a.invoice_id)}};(0,s.useEffect)(()=>{a&&(f({client:a.client,agency:a.agency,invoice_id:a.invoice_id,from:a.from,to:a.to,final_price:a.final_price||0,approved:a.approved,media_received:a.media_received,invoice_sent:a.invoice_sent,viaduct:a.viaduct}),B())},[a]),(0,s.useEffect)(()=>{if(b){let a=document.querySelector('[role="dialog"]');a&&a.focus()}},[b]);let C=(0,s.useCallback)(async()=>{if(a)try{let b=(await eo.getComments(a.id)).sort((a,b)=>new Date(b.created_at).getTime()-new Date(a.created_at).getTime());h(b)}catch(a){console.error("Error loading comments:",a)}},[a]),D=(0,s.useCallback)(async()=>{if(a)try{let b=await eo.getReminders(a.id);j(b)}catch(a){console.error("Error loading reminders:",a)}},[a]),E=(0,s.useCallback)(async()=>{if(a)try{let b=await eo.getPrintscreensForOrder(a.id);l(b),y([])}catch(a){console.error("Error loading print screens:",a)}},[a]);(0,s.useEffect)(()=>{if(a&&b){C();let a=setTimeout(()=>{D(),E()},500);return()=>clearTimeout(a)}},[a,b,C,D,E]);let F=(a,b)=>{f(c=>({...c,[a]:b}))},G=async()=>{if(a){n(!0);try{let b=await w.updateOrder(a.id,e);d(b),c()}catch(a){console.error("Error updating order:",a)}finally{n(!1)}}},H=async()=>{if(a&&confirm("Ar tikrai norite ištrinti šį užsakymą?"))try{await w.deleteOrder(a.id),c()}catch(a){console.error("Error deleting order:",a)}},I=async()=>{if(a&&o.trim())try{let b=await eo.addComment({order_id:a.id,text:o.trim()});h(a=>[b,...a]),p("");let c=document.querySelector('[contenteditable="true"]');c&&(c.textContent="")}catch(d){console.error("Error adding comment:",d);let b={id:`temp-${Date.now()}`,text:o.trim(),created_at:new Date().toISOString(),order_id:a.id};h(a=>[b,...a]),p("");let c=document.querySelector('[contenteditable="true"]');c&&(c.textContent="")}},J=async()=>{if(a&&q&&u.trim())try{let b=new Date(q).toISOString().split("T")[0],c=await eo.addReminder(a.id,{due_date:b,title:u.trim(),is_completed:!1});j(a=>[...a,c]),t(""),v("")}catch(c){console.error("Error adding reminder:",c);let b={id:`temp-${Date.now()}`,due_date:q,title:u.trim(),is_completed:!1,order_id:a.id,created_at:new Date().toISOString()};j(a=>[...a,b]),t(""),v("")}},K=async a=>{try{await eo.deleteReminder(a),j(b=>b.filter(b=>b.id!==a))}catch(a){console.error("Error deleting reminder:",a)}},L=a=>{window.open(a.file_url,"_blank")},M=async b=>{let c=b.clipboardData?.items;if(c&&a)for(let d=0;d<c.length;d++){let e=c[d];if(e.type.startsWith("image/")){b.preventDefault();let c=e.getAsFile();if(!c)continue;try{let b=await eo.uploadPrintscreen(a.id,c);y(a=>[...a,b])}catch(a){console.error("Error uploading printscreen:",a)}}}},N=a=>{try{return new Date(a).toISOString().split("T")[0]}catch{return a}},O=a=>{try{let b=new Date(a),c=new Date(b.getFullYear(),0,4),d=c.getDay()||7,e=new Date(c);e.setDate(c.getDate()-d+1);let f=Math.floor((b.getTime()-e.getTime())/864e5),g=Math.ceil((f+1)/7);return`W${g}`}catch{return""}},P=e.from?O(e.from):"",Q=e.to?O(e.to):"",R=P&&Q?`${P} → ${Q}`:P||Q||"";return b&&a?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true",onKeyDown:a=>{"Escape"===a.key&&c()},tabIndex:0,children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:a.client}),(0,r.jsxs)("p",{className:"text-gray-600",children:[a.agency," | ",a.invoice_id]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Media"}),(0,r.jsx)("button",{type:"button",onClick:()=>F("media_received",!e.media_received),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${e.media_received?"bg-green-300":"bg-gray-200"}`,children:(0,r.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.media_received?"translate-x-6":"translate-x-1"}`})})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Sąskaita"}),(0,r.jsx)("button",{type:"button",onClick:()=>F("invoice_sent",!e.invoice_sent),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${e.invoice_sent?"bg-green-300":"bg-gray-200"}`,children:(0,r.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.invoice_sent?"translate-x-6":"translate-x-1"}`})})]}),(0,r.jsx)("button",{type:"button",onClick:c,className:"text-gray-400 hover:text-gray-600 transition-colors ml-4",children:(0,r.jsx)(cl,{className:"w-6 h-6"})})]})]}),(0,r.jsxs)("div",{className:"p-6 space-y-3",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pavadinimas"}),(0,r.jsx)("input",{type:"text",value:e.client||"",onChange:a=>F("client",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statusas"}),(0,r.jsxs)("select",{value:e.approved?"taip":"ne",onChange:a=>F("approved","taip"===a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"ne",children:"Nepatvirtinta"}),(0,r.jsx)("option",{value:"taip",children:"Patvirtinta"}),(0,r.jsx)("option",{value:"rezervuota",children:"Rezervuota"}),(0,r.jsx)("option",{value:"atšaukta",children:"Atšaukta"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transliacijų laikotarpis"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"text",value:e.from?N(e.from):"",onChange:a=>F("from",a.target.value),pattern:"\\d{4}-\\d{2}-\\d{2}",placeholder:"yyyy-mm-dd",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsx)("span",{className:"text-gray-500",children:"→"}),(0,r.jsx)("input",{type:"text",value:e.to?N(e.to):"",onChange:a=>F("to",a.target.value),pattern:"\\d{4}-\\d{2}-\\d{2}",placeholder:"yyyy-mm-dd",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,r.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,r.jsx)("span",{className:"font-normal",children:"Savaitės:"})," ",(0,r.jsx)("span",{className:"font-semibold",children:R})]})})]}),e.from&&e.to&&e.final_price&&(0,r.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[((a,b,c)=>{try{if(!a||!b||!c)return[];let d=a.split(" ")[0],e=b.split(" ")[0],[f,g,h]=d.split("-").map(Number),[i,j,k]=e.split("-").map(Number),l=new Date(f,g-1,h),m=new Date(i,j-1,k);if(isNaN(l.getTime())||isNaN(m.getTime()))return[];let n=0,o=new Date(l);for(;o<=m;){n++;let a=new Date(o);a.setDate(a.getDate()+1),o=a}let p=[],q=["sausis","vasaris","kovas","balandis","gegužė","birželis","liepa","rugpjūtis","rugsėjis","spalis","lapkritis","gruodis"],r=new Date(l),s=new Date(m);for(;r<=s;){let a=r.getMonth()+1,b=r.getFullYear(),c=`${b}-${a}`,d=p.find(a=>a.month===c);d||(d={month:c,year:b,days:0,amount:0,monthName:q[a-1]},p.push(d)),d.days++,r.setDate(r.getDate()+1)}return p.forEach(a=>{a.amount=a.days/n*c}),p.map(a=>({month:parseInt(a.month.split("-")[1]),year:a.year,monthName:a.monthName,days:a.days,amount:a.amount}))}catch(a){return console.error("Error in calculateMonthlyDistribution:",a),[]}})(e.from,e.to,e.final_price).map(a=>(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[a.monthName.charAt(0).toUpperCase()+a.monthName.slice(1)," ",a.year," (",a.days," d.) → ",a.amount.toFixed(2),"€"]},a.month)),(0,r.jsx)("div",{className:"pt-3 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900 flex items-center",children:[(0,r.jsx)("span",{className:"font-normal",children:"Viso:"})," ",(0,r.jsxs)("span",{className:"font-semibold",children:[e.final_price?.toFixed(2),"€"]}),z&&(0,r.jsx)("button",{onClick:()=>{let b=a?.viaduct?z.viaduct_link:z.link;window.open(b,"_blank")},className:"ml-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Atidaryti skaičiuoklę",children:"🔗"})]})})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Komentaras"}),(0,r.jsx)("div",{contentEditable:!0,onInput:a=>p(a.currentTarget.textContent||""),onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),I())},onPaste:M,"data-placeholder":"Įveskite komentarą... (Enter - išsaugoti, Cmd+V - printscreen)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-24 resize-none min-h-[6rem] overflow-y-auto",style:{whiteSpace:"pre-wrap"}}),g.length>0&&(0,r.jsx)("div",{className:"mt-4 space-y-2",children:g.map(a=>(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:new Date(a.created_at).toLocaleString("lt-LT")}),(0,r.jsx)("div",{className:"text-sm text-gray-900",children:a.text})]},a.id))})]}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Printscreens"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[x.map(a=>(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(eq.default,{src:a.file_url,alt:"Printscreen",width:64,height:64,className:"w-16 h-16 object-cover rounded border cursor-pointer hover:opacity-80",onClick:()=>L(a)}),(0,r.jsx)("button",{type:"button",onClick:async()=>{try{await eo.deleteFile(a.id),y(b=>b.filter(b=>b.id!==a.id)),l(b=>b.filter(b=>b.id!==a.id))}catch(a){console.error("Error deleting printscreen:",a)}},className:"absolute -top-1 -right-1 w-4 h-4 bg-black text-white rounded-full text-xs hover:bg-gray-800 flex items-center justify-center",children:"×"})]},a.id)),k.map(a=>(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(eq.default,{src:a.file_url,alt:"Printscreen",width:64,height:64,className:"w-16 h-16 object-cover rounded border cursor-pointer hover:opacity-80",onClick:()=>L(a)}),(0,r.jsx)("button",{type:"button",onClick:async()=>{try{await eo.deleteFile(a.id),l(b=>b.filter(b=>b.id!==a.id))}catch(a){console.error("Error deleting printscreen:",a)}},className:"absolute -top-1 -right-1 w-4 h-4 bg-black text-white rounded-full text-xs hover:bg-gray-800 flex items-center justify-center",children:"×"})]},a.id)),0===x.length&&0===k.length&&(0,r.jsx)("div",{className:"text-sm text-gray-400 italic",children:"Cmd+V į komentaro lauką pridėti printscreen"})]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data"}),(0,r.jsx)("input",{type:"date",value:q,onChange:a=>t(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priminimo žinutė"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("input",{type:"text",value:u,onChange:a=>v(a.target.value),placeholder:"Įveskite priminimo žinutę...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsx)("button",{type:"button",onClick:J,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Pridėti"})]})]})]}),i.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Priminimai"}),(0,r.jsx)("div",{className:"space-y-2",children:i.map(a=>(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:new Date(a.due_date).toLocaleDateString("lt-LT")}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:a.title})]}),(0,r.jsx)("button",{type:"button",onClick:()=>K(a.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Ištrinti"})]},a.id))})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[(0,r.jsx)("button",{type:"button",onClick:H,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Ištrinti"}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:c,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Uždaryti"}),(0,r.jsx)("button",{type:"button",onClick:G,disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:m?"Išsaugoma...":"Išsaugoti"})]})]})]})}):null}function es({onClose:a,onOpenEditModal:b}){let[c,d]=(0,s.useState)([]),[e,f]=(0,s.useState)(!0),[g,h]=(0,s.useState)({});(0,s.useEffect)(()=>{i()},[]);let i=async()=>{try{let{data:a,error:b}=await en.from("reminders").select("*").eq("is_completed",!1).order("due_date",{ascending:!0});if(b)throw b;if(d(a||[]),a&&a.length>0){let b=[...new Set(a.map(a=>a.order_id))],c={};for(let a of b)try{let b=await w.getOrder(a);c[a]=b.client}catch(b){console.error(`Error loading order ${a}:`,b),c[a]="Nežinomas klientas"}h(c)}}catch(a){console.error("Error loading reminders:",a)}finally{f(!1)}};return e?(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 bg-white rounded-xl shadow-2xl border border-gray-100 p-6 max-w-sm backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-500 border-t-transparent"}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Kraunama priminimai..."})]})}):0===c.length?null:(0,r.jsxs)("div",{className:"fixed top-4 right-4 z-50 space-y-3 max-w-sm",children:[c.map(a=>(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl shadow-xl p-5 backdrop-blur-sm hover:shadow-2xl transition-all duration-300 cursor-pointer hover:bg-gray-50",onClick:()=>b(a.order_id),children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-red-400 to-pink-500 rounded-full flex items-center justify-center shadow-lg",children:(0,r.jsx)("span",{className:"text-white text-lg",children:"!"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("h4",{className:"text-xs text-gray-600",children:"Priminimas"}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Aktyvus"})]}),(0,r.jsx)("p",{className:"text-sm font-bold text-gray-800 mb-3 leading-relaxed",children:a.title}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[(0,r.jsx)("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:"Klientas:"}),(0,r.jsx)("span",{className:"text-gray-800",children:g[a.order_id]||"Kraunama..."})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[(0,r.jsx)("span",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:"Data:"}),(0,r.jsx)("span",{className:"text-gray-800",children:new Date(a.due_date).toLocaleDateString("lt-LT")})]})]})]})]})},a.id)),(0,r.jsx)("div",{className:"flex justify-end pt-2",children:(0,r.jsxs)("button",{onClick:a,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 bg-white/80 hover:bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 backdrop-blur-sm",children:[(0,r.jsx)("span",{children:"Uždaryti"}),(0,r.jsx)("svg",{className:"ml-1.5 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]})}function et(){let[a,b]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),[e,f]=(0,s.useState)(null),[g,h]=(0,s.useState)(""),[i,j]=(0,s.useState)(!0),[k,l]=(0,s.useState)(0),[m,n]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let a=localStorage.getItem("darkMode");null!==a&&n(JSON.parse(a))},[]),(0,s.useEffect)(()=>{localStorage.setItem("darkMode",JSON.stringify(m)),m?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[m]);let o=new Date,p=String(o.getMonth()+1).padStart(2,"0"),q=o.getFullYear(),[t,u]=(0,s.useState)({status:"taip",month:p,year:q.toString(),client:"",agency:"",media_received:"",invoice_sent:""}),v=async a=>{try{let b=await w.getOrder(a);f(b)}catch(a){console.error("Error loading order for edit:",a)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,r.jsx)(aj,{onAddOrder:()=>b(!0),isDarkMode:m,onToggleDarkMode:()=>{n(!m)}}),(0,r.jsxs)("main",{className:"container mx-auto px-4 py-6",children:[(0,r.jsx)(am,{searchQuery:g,onSearchChange:h,filters:t,onFiltersChange:u}),(0,r.jsx)(af,{searchQuery:g,filters:t,onEditOrder:a=>{f(a)}},k)]}),(0,r.jsx)(cm,{isOpen:a,onClose:()=>b(!1)}),(0,r.jsx)(ep,{order:c,isOpen:!!c,onClose:()=>d(null)}),(0,r.jsx)(er,{order:e,isOpen:!!e,onClose:()=>f(null),onOrderUpdated:()=>{l(a=>a+1),f(null)}}),i&&(0,r.jsx)(es,{onClose:()=>j(!1),onOpenEditModal:v})]})}}];

//# sourceMappingURL=_e3caa228._.js.map