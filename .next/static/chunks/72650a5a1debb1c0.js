(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,14595,(e,t,r)=>{"use strict";var n=e.r(71645),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,c=n.useDebugValue;r.useSyncExternalStoreWithSelector=function(e,t,r,n,u){var d=s(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;var f=i(e,(d=l(function(){function e(e){if(!o){if(o=!0,i=e,e=n(e),void 0!==u&&h.hasValue){var t=h.value;if(u(t,e))return s=t}return s=e}if(t=s,a(i,e))return t;var r=n(e);return void 0!==u&&u(t,r)?(i=e,t):(i=e,s=r)}var i,s,o=!1,l=void 0===r?null:r;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,r,n,u]))[0],d[1]);return o(function(){h.hasValue=!0,h.value=f},[f]),c(f),f}},13027,(e,t,r)=>{"use strict";t.exports=e.r(14595)},54385,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}},43173,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let a=n(e.r(6085)),i=n(e.r(54385));r.default=class{throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n,a;let s=null,o=null,l=null,c=e.status,u=e.statusText;if(e.ok){if("HEAD"!==this.method){let r=await e.text();""===r||(o="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null==(t=this.headers.get("Accept"))?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}let a=null==(r=this.headers.get("Prefer"))?void 0:r.match(/count=(exact|planned|estimated)/),i=null==(n=e.headers.get("content-range"))?void 0:n.split("/");a&&i&&i.length>1&&(l=parseInt(i[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(s={code:"PGRST116",details:"Results contain ".concat(o.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,u="Not Acceptable"):o=1===o.length?o[0]:null)}else{let t=await e.text();try{s=JSON.parse(t),Array.isArray(s)&&404===e.status&&(o=[],s=null,c=200,u="OK")}catch(r){404===e.status&&""===t?(c=204,u="No Content"):s={message:t}}if(s&&this.isMaybeSingle&&(null==(a=null==s?void 0:s.details)?void 0:a.includes("0 rows"))&&(s=null,c=200,u="OK"),s&&this.shouldThrowOnError)throw new i.default(s)}return{error:s,data:o,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,n;return{error:{message:"".concat(null!=(t=null==e?void 0:e.name)?t:"FetchError",": ").concat(null==e?void 0:e.message),details:"".concat(null!=(r=null==e?void 0:e.stack)?r:""),hint:"",code:"".concat(null!=(n=null==e?void 0:e.code)?n:"")},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!=(t=e.shouldThrowOnError)&&t,this.signal=e.signal,this.isMaybeSingle=null!=(r=e.isMaybeSingle)&&r,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=a.default:this.fetch=fetch}}},82191,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let a=n(e.r(43173));class i extends a.default{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a?"".concat(a,".order"):"order",s=this.url.searchParams.get(i);return this.url.searchParams.set(i,"".concat(s?"".concat(s,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===r?"":r?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.url.searchParams.set(void 0===r?"limit":"".concat(r,".limit"),"".concat(e)),this}range(e,t){let{foreignTable:r,referencedTable:n=r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=void 0===n?"offset":"".concat(n,".offset"),i=void 0===n?"limit":"".concat(n,".limit");return this.url.searchParams.set(a,"".concat(e)),this.url.searchParams.set(i,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){var e;let{analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!=(e=this.headers.get("Accept"))?e:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(s,'; for="').concat(l,'"; options=').concat(o,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}}r.default=i},14633,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let a=n(e.r(82191));class i extends a.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(r,")")),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:r,type:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";return"plain"===n?a="pl":"phrase"===n?a="ph":"websearch"===n&&(a="w"),this.url.searchParams.append(e,"".concat(a,"fts").concat(void 0===r?"":"(".concat(r,")"),".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,r]=e;this.url.searchParams.append(t,"eq.".concat(r))}),this}not(e,t,r){return this.url.searchParams.append(e,"not.".concat(t,".").concat(r)),this}or(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.url.searchParams.append(r?"".concat(r,".or"):"or","(".concat(e,")")),this}filter(e,t,r){return this.url.searchParams.append(e,"".concat(t,".").concat(r)),this}}r.default=i},38290,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let a=n(e.r(14633));r.default=class{select(e){let{head:t=!1,count:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer","count=".concat(r)),new a.default({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e){var t;let{count:r,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r&&this.headers.append("Prefer","count=".concat(r)),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!=(t=this.fetch)?t:fetch})}upsert(e){var t;let{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.headers.append("Prefer","resolution=".concat(n?"ignore":"merge","-duplicates")),void 0!==r&&this.url.searchParams.set("on_conflict",r),i&&this.headers.append("Prefer","count=".concat(i)),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!=(t=this.fetch)?t:fetch})}update(e){var t;let{count:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r&&this.headers.append("Prefer","count=".concat(r)),new a.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!=(t=this.fetch)?t:fetch})}delete(){var e;let{count:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t&&this.headers.append("Prefer","count=".concat(t)),new a.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!=(e=this.fetch)?e:fetch})}constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}}},2259,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let a=n(e.r(38290)),i=n(e.r(14633));class s{from(e){let t=new URL("".concat(this.url,"/").concat(e));return new a.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new s(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){var t;let r,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:s=!1,get:o=!1,count:l}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=new URL("".concat(this.url,"/rpc/").concat(e));s||o?(r=s?"HEAD":"GET",Object.entries(a).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return[t,Array.isArray(r)?"{".concat(r.join(","),"}"):"".concat(r)]}).forEach(e=>{let[t,r]=e;c.searchParams.append(t,r)})):(r="POST",n=a);let u=new Headers(this.headers);return l&&u.set("Prefer","count=".concat(l)),new i.default({method:r,url:c,headers:u,schema:this.schemaName,body:n,fetch:null!=(t=this.fetch)?t:fetch})}constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=n}}r.default=s},82215,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PostgrestError=r.PostgrestBuilder=r.PostgrestTransformBuilder=r.PostgrestFilterBuilder=r.PostgrestQueryBuilder=r.PostgrestClient=void 0;let a=n(e.r(2259));r.PostgrestClient=a.default;let i=n(e.r(38290));r.PostgrestQueryBuilder=i.default;let s=n(e.r(14633));r.PostgrestFilterBuilder=s.default;let o=n(e.r(82191));r.PostgrestTransformBuilder=o.default;let l=n(e.r(43173));r.PostgrestBuilder=l.default;let c=n(e.r(54385));r.PostgrestError=c.default,r.default={PostgrestClient:a.default,PostgrestQueryBuilder:i.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}},67034,(e,t,r)=>{!function(){var e={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,i=l(e),s=i[0],o=i[1],c=new a((s+o)*3/4-o),u=0,d=o>0?s-4:s;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===o&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===o&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,i=[],s=0,o=n-a;s<o;s+=16383)i.push(function(e,t,n){for(var a,i=[],s=t;s<n;s+=3)a=(e[s]<<16&0xff0000)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(r[a>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return i.join("")}(e,s,s+16383>o?o:s+16383));return 1===a?i.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===a&&i.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),i.join("")};for(var r=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=i.length;s<o;++s)r[s]=i[s],n[i.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n[45]=62,n[95]=63},72:function(e,t,r){"use strict";var n=r(675),a=r(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function s(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e){var n=e,a=t;if(("string"!=typeof a||""===a)&&(a="utf8"),!o.isEncoding(a))throw TypeError("Unknown encoding: "+a);var i=0|f(n,a),l=s(i),c=l.write(n,a);return c!==i&&(l=l.slice(0,c)),l}if(ArrayBuffer.isView(e))return d(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(C(e,ArrayBuffer)||e&&C(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(C(e,SharedArrayBuffer)||e&&C(e.buffer,SharedArrayBuffer)))return function(e,t,r){var n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),o.prototype),n}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var u=e.valueOf&&e.valueOf();if(null!=u&&u!==e)return o.from(u,t,r);var g=function(e){if(o.isBuffer(e)){var t=0|h(e.length),r=s(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?s(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(g)return g;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),s(e<0?0:0|h(e))}function d(e){for(var t=e.length<0?0:0|h(e.length),r=s(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=0x7fffffff,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return(c(e),e<=0)?s(e):void 0!==t?"string"==typeof r?s(e).fill(t,r):s(e).fill(t):s(e)},o.allocUnsafe=function(e){return u(e)},o.allocUnsafeSlow=function(e){return u(e)};function h(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function f(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||C(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return S(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(a)return n?-1:S(e).length;t=(""+t).toLowerCase(),a=!0}}function g(e,t,r){var a,i,s,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var a="",i=t;i<r;++i)a+=P[e[i]];return a}(this,t,r);case"utf8":case"utf-8":return v(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(127&e[a]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(e[a]);return n}(this,t,r);case"base64":return a=this,i=t,s=r,0===i&&s===a.length?n.fromByteArray(a):n.fromByteArray(a.slice(i,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),a="",i=0;i<n.length;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}(this,t,r);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function p(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,a){var i;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(i=r*=1)!=i&&(r=a?0:e.length-1),r<0&&(r=e.length+r),r>=e.length)if(a)return -1;else r=e.length-1;else if(r<0)if(!a)return -1;else r=0;if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,a);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(a)return Uint8Array.prototype.indexOf.call(e,t,r);else return Uint8Array.prototype.lastIndexOf.call(e,t,r);return y(e,[t],r,n,a)}throw TypeError("val must be string, number or Buffer")}function y(e,t,r,n,a){var i,s=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;s=2,o/=2,l/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(a){var u=-1;for(i=r;i<o;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*s}else -1!==u&&(i-=i-u),u=-1}else for(r+l>o&&(r=o-l),i=r;i>=0;i--){for(var d=!0,h=0;h<l;h++)if(c(e,i+h)!==c(t,h)){d=!1;break}if(d)return i}return -1}o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(C(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),C(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,a=0,i=Math.min(r,n);a<i;++a)if(e[a]!==t[a]){r=e[a],n=t[a];break}return r<n?-1:+(n<r)},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,n=o.allocUnsafe(t),a=0;for(r=0;r<e.length;++r){var i=e[r];if(C(i,Uint8Array)&&(i=o.from(i)),!o.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(n,a),a+=i.length}return n},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?v(this,0,e):g.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},i&&(o.prototype[i]=o.prototype.inspect),o.prototype.compare=function(e,t,r,n,a){if(C(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),t<0||r>e.length||n<0||a>this.length)throw RangeError("out of range index");if(n>=a&&t>=r)return 0;if(n>=a)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,a>>>=0,this===e)return 0;for(var i=a-n,s=r-t,l=Math.min(i,s),c=this.slice(n,a),u=e.slice(t,r),d=0;d<l;++d)if(c[d]!==u[d]){i=c[d],s=u[d];break}return i<s?-1:+(s<i)},o.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)};function v(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;a<r;){var i,s,o,l,c=e[a],u=null,d=c>239?4:c>223?3:c>191?2:1;if(a+d<=r)switch(d){case 1:c<128&&(u=c);break;case 2:(192&(i=e[a+1]))==128&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[a+1],s=e[a+2],(192&i)==128&&(192&s)==128&&(l=(15&c)<<12|(63&i)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[a+1],s=e[a+2],o=e[a+3],(192&i)==128&&(192&s)==128&&(192&o)==128&&(l=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),a+=d}var h=n,f=h.length;if(f<=4096)return String.fromCharCode.apply(String,h);for(var g="",p=0;p<f;)g+=String.fromCharCode.apply(String,h.slice(p,p+=4096));return g}function b(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function w(e,t,r,n,a,i){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function x(e,t,r,n,a,i){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function k(e,t,r,n,i){return t*=1,r>>>=0,i||x(e,t,r,4,34028234663852886e22,-34028234663852886e22),a.write(e,t,r,n,23,4),r+4}function _(e,t,r,n,i){return t*=1,r>>>=0,i||x(e,t,r,8,17976931348623157e292,-17976931348623157e292),a.write(e,t,r,n,52,8),r+8}o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var a,i,s,o,l,c,u,d,h=this.length-t;if((void 0===r||r>h)&&(r=h),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var f=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var a=e.length-r;n?(n=Number(n))>a&&(n=a):n=a;var i=t.length;n>i/2&&(n=i/2);for(var s=0;s<n;++s){var o,l=parseInt(t.substr(2*s,2),16);if((o=l)!=o)break;e[r+s]=l}return s}(this,e,t,r);case"utf8":case"utf-8":return a=t,i=r,T(S(e,this.length-a),this,a,i);case"ascii":return s=t,o=r,T(E(e),this,s,o);case"latin1":case"binary":return function(e,t,r,n){return T(E(t),e,r,n)}(this,e,t,r);case"base64":return l=t,c=r,T(N(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,d=r,T(function(e,t){for(var r,n,a=[],i=0;i<e.length&&!((t-=2)<0);++i)n=(r=e.charCodeAt(i))>>8,a.push(r%256),a.push(n);return a}(e,this.length-u),this,u,d);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n},o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e+--t],a=1;t>0&&(a*=256);)n+=this[e+--t]*a;return n},o.prototype.readUInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n>=(a*=128)&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=t,a=1,i=this[e+--n];n>0&&(a*=256);)i+=this[e+--n]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},o.prototype.readInt8=function(e,t){return(e>>>=0,t||b(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||b(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||b(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||b(e,4,this.length),a.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||b(e,4,this.length),a.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||b(e,8,this.length),a.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||b(e,8,this.length),a.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var a=Math.pow(2,8*r)-1;w(this,e,t,r,a,0)}var i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var a=Math.pow(2,8*r)-1;w(this,e,t,r,a,0)}var i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var a=Math.pow(2,8*r-1);w(this,e,t,r,a-1,-a)}var i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var a=Math.pow(2,8*r-1);w(this,e,t,r,a-1,-a)}var i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return _(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return _(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var a=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var i=a-1;i>=0;--i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return a},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){var a,i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var s=o.isBuffer(e)?e:o.from(e,n),l=s.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=s[a%l]}return this};var j=/[^+/0-9A-Za-z-_]/g;function S(e,t){t=t||1/0;for(var r,n=e.length,a=null,i=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!a){if(r>56319||s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}a=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),a=r;continue}r=(a-55296<<10|r-56320)+65536}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return i}function E(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function N(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function T(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length)&&!(a>=e.length);++a)t[a+r]=e[a];return a}function C(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var P=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var n=16*r,a=0;a<16;++a)t[n+a]=e[r]+e[a];return t}()},783:function(e,t){t.read=function(e,t,r,n,a){var i,s,o=8*a-n-1,l=(1<<o)-1,c=l>>1,u=-7,d=r?a-1:0,h=r?-1:1,f=e[t+d];for(d+=h,i=f&(1<<-u)-1,f>>=-u,u+=o;u>0;i=256*i+e[t+d],d+=h,u-=8);for(s=i&(1<<-u)-1,i>>=-u,u+=n;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===i)i=1-c;else{if(i===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),i-=c}return(f?-1:1)*s*Math.pow(2,i-n)},t.write=function(e,t,r,n,a,i){var s,o,l,c=8*i-a-1,u=(1<<c)-1,d=u>>1,h=5960464477539062e-23*(23===a),f=n?0:i-1,g=n?1:-1,p=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(o=+!!isNaN(t),s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(s++,l/=2),s+d>=u?(o=0,s=u):s+d>=1?(o=(t*l-1)*Math.pow(2,a),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,a),s=0));a>=8;e[r+f]=255&o,f+=g,o/=256,a-=8);for(s=s<<a|o,c+=a;c>0;e[r+f]=255&s,f+=g,s/=256,c-=8);e[r+f-g]|=128*p}}},r={};function n(t){var a=r[t];if(void 0!==a)return a.exports;var i=r[t]={exports:{}},s=!0;try{e[t](i,i.exports,n),s=!1}finally{s&&delete r[t]}return i.exports}n.ab="/ROOT/node_modules/next/dist/compiled/buffer/",t.exports=n(72)}()},67423,(e,t,r)=>{"use strict";function n(e){let{widthInt:t,heightInt:r,blurWidth:n,blurHeight:a,blurDataURL:i,objectFit:s}=e,o=n?40*n:t,l=a?40*a:r,c=o&&l?"viewBox='0 0 "+o+" "+l+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+c+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(c?"none":"contain"===s?"xMidYMid":"cover"===s?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+i+"'/%3E%3C/svg%3E"}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImageBlurSvg",{enumerable:!0,get:function(){return n}})},87690,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{VALID_LOADERS:function(){return n},imageConfigDefault:function(){return a}});let n=["default","imgix","cloudinary","akamai","custom"],a={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:void 0,unoptimized:!1}},8927,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImgProps",{enumerable:!0,get:function(){return l}}),e.r(33525);let n=e.r(67423),a=e.r(87690),i=["-moz-initial","fill","none","scale-down",void 0];function s(e){return void 0!==e.default}function o(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function l(e,t){var r,l;let c,u,d,{src:h,sizes:f,unoptimized:g=!1,priority:p=!1,loading:m,className:y,quality:v,width:b,height:w,fill:x=!1,style:k,overrideSrc:_,onLoad:j,onLoadingComplete:S,placeholder:E="empty",blurDataURL:N,fetchPriority:T,decoding:C="async",layout:P,objectFit:O,objectPosition:A,lazyBoundary:R,lazyRoot:I,...L}=e,{imgConf:M,showAltText:D,blurComplete:U,defaultLoader:F}=t,B=M||a.imageConfigDefault;if("allSizes"in B)c=B;else{let e=[...B.deviceSizes,...B.imageSizes].sort((e,t)=>e-t),t=B.deviceSizes.sort((e,t)=>e-t),n=null==(r=B.qualities)?void 0:r.sort((e,t)=>e-t);c={...B,allSizes:e,deviceSizes:t,qualities:n}}if(void 0===F)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let q=L.loader||F;delete L.loader,delete L.srcSet;let W="__next_img_default"in q;if(W){if("custom"===c.loader)throw Object.defineProperty(Error('Image with src "'+h+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader'),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let e=q;q=t=>{let{config:r,...n}=t;return e(n)}}if(P){"fill"===P&&(x=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[P];e&&(k={...k,...e});let t={responsive:"100vw",fill:"100vw"}[P];t&&!f&&(f=t)}let z="",H=o(b),K=o(w);if((l=h)&&"object"==typeof l&&(s(l)||void 0!==l.src)){let e=s(h)?h.default:h;if(!e.src)throw Object.defineProperty(Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(e)),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!e.height||!e.width)throw Object.defineProperty(Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(e)),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(u=e.blurWidth,d=e.blurHeight,N=N||e.blurDataURL,z=e.src,!x)if(H||K){if(H&&!K){let t=H/e.width;K=Math.round(e.height*t)}else if(!H&&K){let t=K/e.height;H=Math.round(e.width*t)}}else H=e.width,K=e.height}let G=!p&&("lazy"===m||void 0===m);(!(h="string"==typeof h?h:z)||h.startsWith("data:")||h.startsWith("blob:"))&&(g=!0,G=!1),c.unoptimized&&(g=!0),W&&!c.dangerouslyAllowSVG&&h.split("?",1)[0].endsWith(".svg")&&(g=!0);let V=o(v),J=Object.assign(x?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:O,objectPosition:A}:{},D?{}:{color:"transparent"},k),Y=U||"empty"===E?null:"blur"===E?'url("data:image/svg+xml;charset=utf-8,'+(0,n.getImageBlurSvg)({widthInt:H,heightInt:K,blurWidth:u,blurHeight:d,blurDataURL:N||"",objectFit:J.objectFit})+'")':'url("'+E+'")',Q=i.includes(J.objectFit)?"fill"===J.objectFit?"100% 100%":"cover":J.objectFit,X=Y?{backgroundSize:Q,backgroundPosition:J.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:Y}:{},$=function(e){let{config:t,src:r,unoptimized:n,width:a,quality:i,sizes:s,loader:o}=e;if(n)return{src:r,srcSet:void 0,sizes:void 0};let{widths:l,kind:c}=function(e,t,r){let{deviceSizes:n,allSizes:a}=e;if(r){let e=/(^|\s)(1?\d?\d)vw/g,t=[];for(let n;n=e.exec(r);)t.push(parseInt(n[2]));if(t.length){let e=.01*Math.min(...t);return{widths:a.filter(t=>t>=n[0]*e),kind:"w"}}return{widths:a,kind:"w"}}return"number"!=typeof t?{widths:n,kind:"w"}:{widths:[...new Set([t,2*t].map(e=>a.find(t=>t>=e)||a[a.length-1]))],kind:"x"}}(t,a,s),u=l.length-1;return{sizes:s||"w"!==c?s:"100vw",srcSet:l.map((e,n)=>o({config:t,src:r,quality:i,width:e})+" "+("w"===c?e:n+1)+c).join(", "),src:o({config:t,src:r,quality:i,width:l[u]})}}({config:c,src:h,unoptimized:g,width:H,quality:V,sizes:f,loader:q});return{props:{...L,loading:G?"lazy":m,fetchPriority:T,width:H,height:K,decoding:C,className:y,style:{...J,...X},sizes:$.sizes,srcSet:$.srcSet,src:_||$.src},meta:{unoptimized:g,priority:p,placeholder:E,fill:x}}}},98879,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return o}});let n=e.r(71645),a="undefined"==typeof window,i=a?()=>{}:n.useLayoutEffect,s=a?()=>{}:n.useEffect;function o(e){let{headManager:t,reduceComponentsToState:r}=e;function o(){if(t&&t.mountedInstances){let a=n.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(r(a,e))}}if(a){var l;null==t||null==(l=t.mountedInstances)||l.add(e.children),o()}return i(()=>{var r;return null==t||null==(r=t.mountedInstances)||r.add(e.children),()=>{var r;null==t||null==(r=t.mountedInstances)||r.delete(e.children)}}),i(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),s(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},58908,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"AmpStateContext",{enumerable:!0,get:function(){return n}});let n=e.r(55682)._(e.r(71645)).default.createContext({})},15986,(e,t,r)=>{"use strict";function n(e){let{ampFirst:t=!1,hybrid:r=!1,hasQuery:n=!1}=void 0===e?{}:e;return t||r&&n}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isInAmpMode",{enumerable:!0,get:function(){return n}})},25633,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{default:function(){return p},defaultHead:function(){return d}});let n=e.r(55682),a=e.r(90809),i=e.r(43476),s=a._(e.r(71645)),o=n._(e.r(98879)),l=e.r(58908),c=e.r(42732),u=e.r(15986);function d(e){void 0===e&&(e=!1);let t=[(0,i.jsx)("meta",{charSet:"utf-8"},"charset")];return e||t.push((0,i.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),t}function h(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===s.default.Fragment?e.concat(s.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}e.r(33525);let f=["name","httpEquiv","charSet","itemProp"];function g(e,t){let{inAmpMode:r}=t;return e.reduce(h,[]).reverse().concat(d(r).reverse()).filter(function(){let e=new Set,t=new Set,r=new Set,n={};return a=>{let i=!0,s=!1;if(a.key&&"number"!=typeof a.key&&a.key.indexOf("$")>0){s=!0;let t=a.key.slice(a.key.indexOf("$")+1);e.has(t)?i=!1:e.add(t)}switch(a.type){case"title":case"base":t.has(a.type)?i=!1:t.add(a.type);break;case"meta":for(let e=0,t=f.length;e<t;e++){let t=f[e];if(a.props.hasOwnProperty(t))if("charSet"===t)r.has(t)?i=!1:r.add(t);else{let e=a.props[t],r=n[t]||new Set;("name"!==t||!s)&&r.has(e)?i=!1:(r.add(e),n[t]=r)}}}return i}}()).reverse().map((e,t)=>{let r=e.key||t;return s.default.cloneElement(e,{key:r})})}let p=function(e){let{children:t}=e,r=(0,s.useContext)(l.AmpStateContext),n=(0,s.useContext)(c.HeadManagerContext);return(0,i.jsx)(o.default,{reduceComponentsToState:g,headManager:n,inAmpMode:(0,u.isInAmpMode)(r),children:t})};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18556,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ImageConfigContext",{enumerable:!0,get:function(){return i}});let n=e.r(55682)._(e.r(71645)),a=e.r(87690),i=n.default.createContext(a.imageConfigDefault)},65856,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RouterContext",{enumerable:!0,get:function(){return n}});let n=e.r(55682)._(e.r(71645)).default.createContext(null)},1948,(e,t,r)=>{"use strict";function n(e){var t;let{config:r,src:n,width:a,quality:i}=e,s=i||(null==(t=r.qualities)?void 0:t.reduce((e,t)=>Math.abs(t-75)<Math.abs(e-75)?t:e))||75;return r.path+"?url="+encodeURIComponent(n)+"&w="+a+"&q="+s+(n.startsWith("/_next/static/media/"),"")}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return a}}),n.__next_img_default=!0;let a=n},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return a}});let n=e.r(71645);function a(e,t){let r=(0,n.useRef)(null),a=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=r.current;e&&(r.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(r.current=i(e,n)),t&&(a.current=i(t,n))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},5500,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return w}});let n=e.r(55682),a=e.r(90809),i=e.r(43476),s=a._(e.r(71645)),o=n._(e.r(74080)),l=n._(e.r(25633)),c=e.r(8927),u=e.r(87690),d=e.r(18556);e.r(33525);let h=e.r(65856),f=n._(e.r(1948)),g=e.r(18581),p={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function m(e,t,r,n,a,i,s){let o=null==e?void 0:e.src;e&&e["data-loaded-src"]!==o&&(e["data-loaded-src"]=o,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&a(!0),null==r?void 0:r.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let n=!1,a=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>n,isPropagationStopped:()=>a,persist:()=>{},preventDefault:()=>{n=!0,t.preventDefault()},stopPropagation:()=>{a=!0,t.stopPropagation()}})}(null==n?void 0:n.current)&&n.current(e)}}))}function y(e){return s.use?{fetchPriority:e}:{fetchpriority:e}}"undefined"==typeof window&&(globalThis.__NEXT_IMAGE_IMPORTED=!0);let v=(0,s.forwardRef)((e,t)=>{let{src:r,srcSet:n,sizes:a,height:o,width:l,decoding:c,className:u,style:d,fetchPriority:h,placeholder:f,loading:p,unoptimized:v,fill:b,onLoadRef:w,onLoadingCompleteRef:x,setBlurComplete:k,setShowAltText:_,sizesInput:j,onLoad:S,onError:E,...N}=e,T=(0,s.useCallback)(e=>{e&&(E&&(e.src=e.src),e.complete&&m(e,f,w,x,k,v,j))},[r,f,w,x,k,E,v,j]),C=(0,g.useMergedRef)(t,T);return(0,i.jsx)("img",{...N,...y(h),loading:p,width:l,height:o,decoding:c,"data-nimg":b?"fill":"1",className:u,style:d,sizes:a,srcSet:n,src:r,ref:C,onLoad:e=>{m(e.currentTarget,f,w,x,k,v,j)},onError:e=>{_(!0),"empty"!==f&&k(!0),E&&E(e)}})});function b(e){let{isAppRouter:t,imgAttributes:r}=e,n={as:"image",imageSrcSet:r.srcSet,imageSizes:r.sizes,crossOrigin:r.crossOrigin,referrerPolicy:r.referrerPolicy,...y(r.fetchPriority)};return t&&o.default.preload?(o.default.preload(r.src,n),null):(0,i.jsx)(l.default,{children:(0,i.jsx)("link",{rel:"preload",href:r.srcSet?void 0:r.src,...n},"__nimg-"+r.src+r.srcSet+r.sizes)})}let w=(0,s.forwardRef)((e,t)=>{let r=(0,s.useContext)(h.RouterContext),n=(0,s.useContext)(d.ImageConfigContext),a=(0,s.useMemo)(()=>{var e;let t=p||n||u.imageConfigDefault,r=[...t.deviceSizes,...t.imageSizes].sort((e,t)=>e-t),a=t.deviceSizes.sort((e,t)=>e-t),i=null==(e=t.qualities)?void 0:e.sort((e,t)=>e-t);return{...t,allSizes:r,deviceSizes:a,qualities:i}},[n]),{onLoad:o,onLoadingComplete:l}=e,g=(0,s.useRef)(o);(0,s.useEffect)(()=>{g.current=o},[o]);let m=(0,s.useRef)(l);(0,s.useEffect)(()=>{m.current=l},[l]);let[y,w]=(0,s.useState)(!1),[x,k]=(0,s.useState)(!1),{props:_,meta:j}=(0,c.getImgProps)(e,{defaultLoader:f.default,imgConf:a,blurComplete:y,showAltText:x});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v,{..._,unoptimized:j.unoptimized,placeholder:j.placeholder,fill:j.fill,onLoadRef:g,onLoadingCompleteRef:m,setBlurComplete:w,setShowAltText:k,sizesInput:e.sizes,ref:t}),j.priority?(0,i.jsx)(b,{isAppRouter:!r,imgAttributes:_}):null]})});("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},94909,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{default:function(){return l},getImageProps:function(){return o}});let n=e.r(55682),a=e.r(8927),i=e.r(5500),s=n._(e.r(1948));function o(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:s.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=i.Image},57688,(e,t,r)=>{t.exports=e.r(94909)},52683,e=>{"use strict";e.s(["default",()=>aN],52683);var t,r,n,a,i,s,o,l,c,u,d,h,f,g,p,m,y=e.i(43476),v=e.i(71645);function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=e.i(47167);let x={pocketbase:{url:w.default.env.NEXT_PUBLIC_POCKETBASE_URL||"https://get.piksel.lt",collection:"orders"},supabase:{url:w.default.env.NEXT_PUBLIC_SUPABASE_URL||"https://titkwifsatjemnquyrij.supabase.co",anonKey:w.default.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"sb_publishable_bXgkXQ6_FY3CdnPRHZ-onA_p-bjSFM_"},app:{name:"Piksel Orders",description:"Modernus užsakymų valdymo sistema"}},k=x.pocketbase.url,_=x.pocketbase.collection;class j{static async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(k,"/api/collections/").concat(_).concat(e),n=new AbortController,a=setTimeout(()=>n.abort(),1e4);try{let e=await fetch(r,{headers:{"Content-Type":"application/json","Cache-Control":"max-age=300",...t.headers},signal:n.signal,...t});if(clearTimeout(a),!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(e){if(clearTimeout(a),e instanceof Error&&"AbortError"===e.name)throw console.error("⏰ PocketBase request timeout:",r),Error("Request timeout");throw console.error("❌ PocketBase request failed:",e),e}}static async makeRequestWithRetry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;try{return await this.makeRequest(e,t)}catch(n){if(r>0&&n instanceof Error&&"Request timeout"!==n.message)return console.log("🔄 Retrying request (".concat(r," attempts left)...")),await new Promise(e=>setTimeout(e,1e3)),this.makeRequestWithRetry(e,t,r-1);throw n}}static async processQueue(){if(!this.isProcessingQueue&&0!==this.requestQueue.length){for(this.isProcessingQueue=!0;this.requestQueue.length>0;){let e=this.requestQueue.shift();if(e)try{await e()}catch(e){console.error("❌ Queue request failed")}}this.isProcessingQueue=!1}}static queueRequest(e){return new Promise((t,r)=>{this.requestQueue.push(async()=>{try{let r=await e();t(r)}catch(e){r(e)}}),this.processQueue()})}static async getOrders(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{page:t=1,perPage:r=25,sort:n="-updated",filter:a=""}=e,i=new URLSearchParams({page:t.toString(),perPage:r.toString(),sort:n,...a&&{filter:a}}),s="/records?".concat(i);console.log("🌐 PocketBase request URL:",s),console.log("🌐 PocketBase filter:",a);let o=await this.makeRequestWithRetry(s);return console.log("📦 PocketBase raw response:",o),{items:o.items||[],totalItems:o.totalItems||0,totalPages:o.totalPages||0}}static async getOrder(e){return this.makeRequestWithRetry("/records/".concat(e))}static async searchOrders(e){return this.queueRequest(async()=>(await this.makeRequestWithRetry('/records?filter=(client~"'.concat(e,'" || agency~"').concat(e,'" || invoice_id~"').concat(e,'")&perPage=25'))).items||[])}static async updateOrder(e,t){return this.makeRequestWithRetry("/records/".concat(e),{method:"PATCH",body:JSON.stringify(t)})}static async deleteOrder(e){await this.makeRequestWithRetry("/records/".concat(e),{method:"DELETE"})}static async getQuoteByOrderId(e){try{var t;let r="".concat(k,'/api/collections/quotes/records?filter=order_id="').concat(e,'"&perPage=1');console.log("🔍 Trying to fetch quote from:",r);let n=await fetch(r,{headers:{"Content-Type":"application/json","Cache-Control":"max-age=600"},signal:AbortSignal.timeout(5e3)});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return(null==(t=(await n.json()).items)?void 0:t[0])||null}catch(t){return console.log("No quote found for order:",e),null}}static async getOrdersBatch(e){if(0===e.length)return[];let t=[];for(let r=0;r<e.length;r+=10){let n=e.slice(r,r+10).map(e=>'id="'.concat(e,'"')).join(" || ");try{let e=await this.makeRequestWithRetry("/records?filter=(".concat(n,")&perPage=").concat(10));t.push(...e.items||[])}catch(e){console.error("❌ Batch request failed:",e)}}return t}static async healthCheck(){try{return(await fetch("".concat(k,"/api/health"),{signal:AbortSignal.timeout(3e3)})).ok}catch(e){return!1}}}b(j,"connectionPool",new Map),b(j,"requestQueue",[]),b(j,"isProcessingQueue",!1);let S={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function E(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}let N={date:E({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:E({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:E({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},T={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function C(e){return(t,r)=>{let n;if("formatting"===((null==r?void 0:r.context)?String(r.context):"standalone")&&e.formattingValues){let t=e.defaultFormattingWidth||e.defaultWidth,a=(null==r?void 0:r.width)?String(r.width):t;n=e.formattingValues[a]||e.formattingValues[t]}else{let t=e.defaultWidth,a=(null==r?void 0:r.width)?String(r.width):e.defaultWidth;n=e.values[a]||e.values[t]}return n[e.argumentCallback?e.argumentCallback(t):t]}}function P(e){return function(t){let r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.width,i=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;let o=s[0],l=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?function(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}(l,e=>e.test(o)):function(e,t){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}(l,e=>e.test(o));return r=e.valueCallback?e.valueCallback(c):c,{value:r=n.valueCallback?n.valueCallback(r):r,rest:t.slice(o.length)}}}let O={code:"en-US",formatDistance:(e,t,r)=>{let n,a=S[e];if(n="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),null==r?void 0:r.addSuffix)if(r.comparison&&r.comparison>0)return"in "+n;else return n+" ago";return n},formatLong:N,formatRelative:(e,t,r,n)=>T[e],localize:{ordinalNumber:(e,t)=>{let r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:C({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:C({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:C({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:C({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:C({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:function(e){return function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;let a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];return{value:s=r.valueCallback?r.valueCallback(s):s,rest:t.slice(a.length)}}}({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:P({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:P({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:P({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:P({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:P({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},A={},R=Symbol.for("constructDateFrom");function I(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&R in e?e[R](t):e instanceof Date?new e.constructor(t):new Date(t)}function L(e,t){return I(t||e,e)}function M(e){let t=L(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),e-r}function D(e,t){let r=L(e,null==t?void 0:t.in);return r.setHours(0,0,0,0),r}function U(e,t){var r,n,a,i,s,o,l,c;let u=null!=(c=null!=(l=null!=(o=null!=(s=null==t?void 0:t.weekStartsOn)?s:null==t||null==(n=t.locale)||null==(r=n.options)?void 0:r.weekStartsOn)?o:A.weekStartsOn)?l:null==(i=A.locale)||null==(a=i.options)?void 0:a.weekStartsOn)?c:0,d=L(e,null==t?void 0:t.in),h=d.getDay();return d.setDate(d.getDate()-(7*(h<u)+h-u)),d.setHours(0,0,0,0),d}function F(e,t){return U(e,{...t,weekStartsOn:1})}function B(e,t){let r=L(e,null==t?void 0:t.in),n=r.getFullYear(),a=I(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);let i=F(a),s=I(r,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);let o=F(s);return r.getTime()>=i.getTime()?n+1:r.getTime()>=o.getTime()?n:n-1}function q(e,t){var r,n,a,i,s,o,l,c;let u=L(e,null==t?void 0:t.in),d=u.getFullYear(),h=null!=(c=null!=(l=null!=(o=null!=(s=null==t?void 0:t.firstWeekContainsDate)?s:null==t||null==(n=t.locale)||null==(r=n.options)?void 0:r.firstWeekContainsDate)?o:A.firstWeekContainsDate)?l:null==(i=A.locale)||null==(a=i.options)?void 0:a.firstWeekContainsDate)?c:1,f=I((null==t?void 0:t.in)||e,0);f.setFullYear(d+1,0,h),f.setHours(0,0,0,0);let g=U(f,t),p=I((null==t?void 0:t.in)||e,0);p.setFullYear(d,0,h),p.setHours(0,0,0,0);let m=U(p,t);return+u>=+g?d+1:+u>=+m?d:d-1}function W(e,t){let r=Math.abs(e).toString().padStart(t,"0");return(e<0?"-":"")+r}let z={y(e,t){let r=e.getFullYear(),n=r>0?r:1-r;return W("yy"===t?n%100:n,t.length)},M(e,t){let r=e.getMonth();return"M"===t?String(r+1):W(r+1,2)},d:(e,t)=>W(e.getDate(),t.length),a(e,t){let r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return"am"===r?"a.m.":"p.m."}},h:(e,t)=>W(e.getHours()%12||12,t.length),H:(e,t)=>W(e.getHours(),t.length),m:(e,t)=>W(e.getMinutes(),t.length),s:(e,t)=>W(e.getSeconds(),t.length),S(e,t){let r=t.length;return W(Math.trunc(e.getMilliseconds()*Math.pow(10,r-3)),t.length)}},H={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},K={G:function(e,t,r){let n=+(e.getFullYear()>0);switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if("yo"===t){let t=e.getFullYear();return r.ordinalNumber(t>0?t:1-t,{unit:"year"})}return z.y(e,t)},Y:function(e,t,r,n){let a=q(e,n),i=a>0?a:1-a;return"YY"===t?W(i%100,2):"Yo"===t?r.ordinalNumber(i,{unit:"year"}):W(i,t.length)},R:function(e,t){return W(B(e),t.length)},u:function(e,t){return W(e.getFullYear(),t.length)},Q:function(e,t,r){let n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return W(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){let n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return W(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){let n=e.getMonth();switch(t){case"M":case"MM":return z.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){let n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return W(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){let a=function(e,t){let r=L(e,null==t?void 0:t.in);return Math.round((U(r,t)-function(e,t){var r,n,a,i,s,o,l,c;let u=null!=(c=null!=(l=null!=(o=null!=(s=null==t?void 0:t.firstWeekContainsDate)?s:null==t||null==(n=t.locale)||null==(r=n.options)?void 0:r.firstWeekContainsDate)?o:A.firstWeekContainsDate)?l:null==(i=A.locale)||null==(a=i.options)?void 0:a.firstWeekContainsDate)?c:1,d=q(e,t),h=I((null==t?void 0:t.in)||e,0);return h.setFullYear(d,0,u),h.setHours(0,0,0,0),U(h,t)}(r,t))/6048e5)+1}(e,n);return"wo"===t?r.ordinalNumber(a,{unit:"week"}):W(a,t.length)},I:function(e,t,r){let n=function(e,t){let r=L(e,void 0);return Math.round((F(r)-function(e,t){let r=B(e,void 0),n=I(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),F(n)}(r))/6048e5)+1}(e);return"Io"===t?r.ordinalNumber(n,{unit:"week"}):W(n,t.length)},d:function(e,t,r){return"do"===t?r.ordinalNumber(e.getDate(),{unit:"date"}):z.d(e,t)},D:function(e,t,r){let n=function(e,t){let r=L(e,void 0);return function(e,t,r){let[n,a]=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];let a=I.bind(null,e||r.find(e=>"object"==typeof e));return r.map(a)}(void 0,e,t),i=D(n),s=D(a);return Math.round((i-M(i)-(s-M(s)))/864e5)}(r,function(e,t){let r=L(e,void 0);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}(r))+1}(e);return"Do"===t?r.ordinalNumber(n,{unit:"dayOfYear"}):W(n,t.length)},E:function(e,t,r){let n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){let a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return W(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){let a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return W(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){let n=e.getDay(),a=0===n?7:n;switch(t){case"i":return String(a);case"ii":return W(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){let n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){let n,a=e.getHours();switch(n=12===a?H.noon:0===a?H.midnight:a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){let n,a=e.getHours();switch(n=a>=17?H.evening:a>=12?H.afternoon:a>=4?H.morning:H.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),r.ordinalNumber(t,{unit:"hour"})}return z.h(e,t)},H:function(e,t,r){return"Ho"===t?r.ordinalNumber(e.getHours(),{unit:"hour"}):z.H(e,t)},K:function(e,t,r){let n=e.getHours()%12;return"Ko"===t?r.ordinalNumber(n,{unit:"hour"}):W(n,t.length)},k:function(e,t,r){let n=e.getHours();return(0===n&&(n=24),"ko"===t)?r.ordinalNumber(n,{unit:"hour"}):W(n,t.length)},m:function(e,t,r){return"mo"===t?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):z.m(e,t)},s:function(e,t,r){return"so"===t?r.ordinalNumber(e.getSeconds(),{unit:"second"}):z.s(e,t)},S:function(e,t){return z.S(e,t)},X:function(e,t,r){let n=e.getTimezoneOffset();if(0===n)return"Z";switch(t){case"X":return V(n);case"XXXX":case"XX":return J(n);default:return J(n,":")}},x:function(e,t,r){let n=e.getTimezoneOffset();switch(t){case"x":return V(n);case"xxxx":case"xx":return J(n);default:return J(n,":")}},O:function(e,t,r){let n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+G(n,":");default:return"GMT"+J(n,":")}},z:function(e,t,r){let n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+G(n,":");default:return"GMT"+J(n,":")}},t:function(e,t,r){return W(Math.trunc(e/1e3),t.length)},T:function(e,t,r){return W(+e,t.length)}};function G(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return 0===i?r+String(a):r+String(a)+t+W(i,2)}function V(e,t){return e%60==0?(e>0?"-":"+")+W(Math.abs(e)/60,2):J(e,t)}function J(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=Math.abs(e);return(e>0?"-":"+")+W(Math.trunc(r/60),2)+t+W(r%60,2)}let Y=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Q=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},X={p:Q,P:(e,t)=>{let r,n=e.match(/(P+)(p+)?/)||[],a=n[1],i=n[2];if(!i)return Y(e,t);switch(a){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",Y(a,t)).replace("{{time}}",Q(i,t))}},$=/^D+$/,Z=/^Y+$/,ee=["D","DD","YY","YYYY"],et=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,er=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,en=/^'([^]*?)'?$/,ea=/''/g,ei=/[a-zA-Z]/;function es(e,t,r){var n,a,i,s,o,l,c,u,d,h,f,g,p,m,y,v,b,w;let x=null!=(h=null!=(d=null==r?void 0:r.locale)?d:A.locale)?h:O,k=null!=(m=null!=(p=null!=(g=null!=(f=null==r?void 0:r.firstWeekContainsDate)?f:null==r||null==(a=r.locale)||null==(n=a.options)?void 0:n.firstWeekContainsDate)?g:A.firstWeekContainsDate)?p:null==(s=A.locale)||null==(i=s.options)?void 0:i.firstWeekContainsDate)?m:1,_=null!=(w=null!=(b=null!=(v=null!=(y=null==r?void 0:r.weekStartsOn)?y:null==r||null==(l=r.locale)||null==(o=l.options)?void 0:o.weekStartsOn)?v:A.weekStartsOn)?b:null==(u=A.locale)||null==(c=u.options)?void 0:c.weekStartsOn)?w:0,j=L(e,null==r?void 0:r.in);if(!(j instanceof Date||"object"==typeof j&&"[object Date]"===Object.prototype.toString.call(j))&&"number"!=typeof j||isNaN(+L(j)))throw RangeError("Invalid time value");let S=t.match(er).map(e=>{let t=e[0];return"p"===t||"P"===t?(0,X[t])(e,x.formatLong):e}).join("").match(et).map(e=>{if("''"===e)return{isToken:!1,value:"'"};let t=e[0];if("'"===t)return{isToken:!1,value:function(e){let t=e.match(en);return t?t[1].replace(ea,"'"):e}(e)};if(K[t])return{isToken:!0,value:e};if(t.match(ei))throw RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});x.localize.preprocessor&&(S=x.localize.preprocessor(j,S));let E={firstWeekContainsDate:k,weekStartsOn:_,locale:x};return S.map(n=>{if(!n.isToken)return n.value;let a=n.value;return(!(null==r?void 0:r.useAdditionalWeekYearTokens)&&Z.test(a)||!(null==r?void 0:r.useAdditionalDayOfYearTokens)&&$.test(a))&&function(e,t,r){let n=function(e,t,r){let n="Y"===e[0]?"years":"days of the month";return"Use `".concat(e.toLowerCase(),"` instead of `").concat(e,"` (in `").concat(t,"`) for formatting ").concat(n," to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md")}(e,t,r);if(console.warn(n),ee.includes(e))throw RangeError(n)}(a,t,String(e)),(0,K[a[0]])(j,a,x.localize,E)}).join("")}function eo(e){let{searchQuery:t,filters:r,onEditOrder:n}=e,[a,i]=(0,v.useState)([]),[s,o]=(0,v.useState)(!0),[l,c]=(0,v.useState)(1),[u,d]=(0,v.useState)(1),[h,f]=(0,v.useState)(0),[g,p]=(0,v.useState)(0),[m,b]=(0,v.useState)("updated"),[w,x]=(0,v.useState)("desc"),k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9e5,[t,r]=(0,v.useState)(new Map),n=(0,v.useRef)(void 0);(0,v.useEffect)(()=>(n.current=setInterval(()=>{r(e=>{let t=Date.now(),r=new Map;for(let[n,a]of e)t-a.timestamp<=a.ttl&&r.set(n,a);return r})},3e5),()=>{n.current&&clearInterval(n.current)}),[]);let a=(0,v.useCallback)(e=>{let n=t.get(e);return n?Date.now()-n.timestamp>n.ttl?(r(t=>{let r=new Map(t);return r.delete(e),r}),null):(r(t=>{let r=new Map(t),n=r.get(e);return n&&r.set(e,{...n,accessCount:n.accessCount+1}),r}),n.data):null},[t]),i=(0,v.useCallback)((t,n,a)=>{r(r=>{let i=new Map(r);if(i.size>100){let e=Array.from(i.entries());e.sort((e,t)=>e[1].accessCount-t[1].accessCount),e.slice(0,20).forEach(e=>{let[t]=e;return i.delete(t)})}return i.set(t,{data:n,timestamp:Date.now(),ttl:a||e,accessCount:1}),i})},[e]);return{get:a,set:i,clear:(0,v.useCallback)(()=>{r(new Map)},[]),remove:(0,v.useCallback)(e=>{r(t=>{let r=new Map(t);return r.delete(e),r})},[])}}(6e5),_=(0,v.useCallback)(async e=>{let t="sum_".concat(e),r=k.get(t);if(r)return void p(r);try{let r=(await j.getOrders({page:1,perPage:100,sort:"-updated",filter:e})).items.filter(e=>e.approved).reduce((e,t)=>e+(t.final_price||0),0);k.set(t,r,6e5),p(r)}catch(e){p(0)}},[k]),S=async e=>{try{let t={...e,invoice_sent:!e.invoice_sent};await j.updateOrder(e.id,t),i(t=>t.map(t=>t.id===e.id?{...t,invoice_sent:!t.invoice_sent}:t))}catch(e){console.error("Error updating invoice status:",e)}},E=(0,v.useCallback)(e=>{let n=[...e];if(t.trim()){let e=t.toLowerCase();n=n.filter(t=>t.client.toLowerCase().includes(e)||t.agency.toLowerCase().includes(e)||t.invoice_id.toLowerCase().includes(e))}return r.status&&("taip"===r.status?n=n.filter(e=>!0===e.approved):"ne"===r.status&&(n=n.filter(e=>!1===e.approved))),r.client&&(n=n.filter(e=>e.client.toLowerCase().includes(r.client.toLowerCase()))),r.agency&&(n=n.filter(e=>e.agency.toLowerCase().includes(r.agency.toLowerCase()))),r.media_received&&("true"===r.media_received?n=n.filter(e=>!0===e.media_received):"false"===r.media_received&&(n=n.filter(e=>!1===e.media_received))),r.month&&r.year&&(n=n.filter(e=>{let t=new Date(e.from),n=t.getMonth()+1,a=t.getFullYear();return n===parseInt(r.month)&&a===parseInt(r.year)})),n},[t,r]),N=(0,v.useCallback)(e=>[...e].sort((e,t)=>{let r,n;switch(m){case"client":case"agency":case"invoice_id":var a,i;r=(null==(a=e[m])?void 0:a.toLowerCase())||"",n=(null==(i=t[m])?void 0:i.toLowerCase())||"";break;case"final_price":r=Number(e.final_price)||0,n=Number(t.final_price)||0;break;case"from":case"to":case"updated":r=new Date(e[m]),n=new Date(t[m]);break;case"approved":r=+!!e.approved,n=+!!t.approved;break;case"media_received":r=+!!e.media_received,n=+!!t.media_received;break;default:r=e[m],n=t[m]}return r<n?"asc"===w?-1:1:r>n?"asc"===w?1:-1:0}),[m,w]),T=(0,v.useCallback)(()=>{let e=[];if(console.log("🔍 Building filter string with:",{searchQuery:t,filters:r}),t.trim()&&(t.toLowerCase().startsWith("viad")?(e.push('(client~"'.concat(t,'" || agency~"').concat(t,'" || invoice_id~"').concat(t,'" || viaduct=true)')),console.log('🔍 Added viaduct filter for "viad" search'),console.log('🔍 Search query starts with "viad", adding viaduct=true filter')):(e.push('(client~"'.concat(t,'" || agency~"').concat(t,'" || invoice_id~"').concat(t,'")')),console.log("🔍 Regular search filter added")),console.log("🔍 Search query:",t)),r.status&&("taip"===r.status?(e.push("approved=true"),console.log("🔍 Added status filter: approved=true")):"ne"===r.status&&(e.push("approved=false"),console.log("🔍 Added status filter: approved=false"))),r.client.trim()&&(e.push('client~"'.concat(r.client,'"')),console.log("🔍 Added client filter:",r.client)),r.agency.trim()&&(e.push('agency~"'.concat(r.agency,'"')),console.log("🔍 Added agency filter:",r.agency)),r.media_received&&("true"===r.media_received?(e.push("media_received=true"),console.log("🔍 Added media filter: media_received=true")):"false"===r.media_received&&(e.push("media_received=false"),console.log("🔍 Added media filter: media_received=false"))),r.month&&r.year){let t="".concat(r.year,"-").concat(r.month.padStart(2,"0"),"-01"),n="".concat(r.year,"-").concat(r.month.padStart(2,"0"),"-31");e.push('(from<="'.concat(n,'" && to>="').concat(t,'")')),console.log("🔍 Added date filter:",{startDate:t,endDate:n,month:r.month,year:r.year})}if(0===e.length)return console.log("🔍 No filters applied, returning empty string"),"";let n=e.join(" && ");return console.log("🔍 Final filter string:",n),n},[t,r]),C=e=>{m===e?x(e=>"asc"===e?"desc":"asc"):(b(e),x("asc"))},P=e=>m!==e?(0,y.jsx)("svg",{className:"w-3 h-3 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})}):"asc"===w?(0,y.jsx)("svg",{className:"w-3 h-3 text-blue-500 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 9l4-4 4 4"})}):(0,y.jsx)("svg",{className:"w-3 h-3 text-blue-500 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 15l4 4 4-4"})}),O=e=>{try{return es(new Date(e),"yyyy-MM-dd")}catch(t){return e}};return((0,v.useEffect)(()=>{(async()=>{try{o(!0);let e=T();console.log("🔍 PocketBase filter string:",e),console.log("🔍 Current filters:",r),console.log("🔍 Search query:",t),console.log("🔍 Sort field:",m,"direction:",w);let n=await j.getOrders({page:l,perPage:20,sort:"".concat("desc"===w?"-":"").concat(m),filter:e});console.log("✅ PocketBase response:",n),console.log("🔍 Filter string sent to PocketBase:",e),console.log("🔍 Current filters:",r),console.log("🔍 Search query:",t);let a=n.items.find(e=>e.client.includes("GO3")||e.client.includes("Viadukai"));a?(console.log("🔍 Found GO3 - Viadukai order:",a),console.log("🔍 Order dates:",{from:a.from,to:a.to}),console.log("🔍 Order approved:",a.approved),console.log("🔍 Order viaduct:",a.viaduct),console.log("🔍 All orders from PocketBase:",n.items),console.log("🔍 Orders with viaduct=true:",n.items.filter(e=>e.viaduct))):console.log("❌ GO3 - Viadukai order not found in response"),console.log("🔍 All orders from PocketBase:",n.items),console.log("🔍 Orders with viaduct=true:",n.items.filter(e=>e.viaduct)),console.log("🔍 Orders with viaduct=false:",n.items.filter(e=>!e.viaduct)),i(n.items),d(n.totalPages),f(n.totalItems),_(e)}catch(t){console.error("❌ Failed to fetch orders:",t);let e=N(E([{id:"1",client:"Ansamblis LIETUVA",agency:"PUBLICIS GROUPE",invoice_id:"3481",approved:!0,viaduct:!1,from:"2025-08-25",to:"2025-09-07",media_received:!0,final_price:1150.64,invoice_sent:!1,updated:"2025-08-22T13:37:44Z"},{id:"2",client:"Perlas momentinės 08 25-08 31",agency:"Open",invoice_id:"3545",approved:!0,viaduct:!1,from:"2025-08-25",to:"2025-08-31",media_received:!0,final_price:5618.25,invoice_sent:!1,updated:"2025-08-22T13:34:37Z"},{id:"3",client:"CCC back to school",agency:"OMG",invoice_id:"3546",approved:!1,viaduct:!0,from:"2025-09-08",to:"2025-09-14",media_received:!1,final_price:282.33,invoice_sent:!1,updated:"2025-08-22T13:23:39Z"},{id:"4",client:"Maxima",agency:"DDB",invoice_id:"3547",approved:!0,viaduct:!1,from:"2025-09-01",to:"2025-09-15",media_received:!0,final_price:1250,invoice_sent:!0,updated:"2025-08-22T14:00:00Z"},{id:"5",client:"Lidl",agency:"McCann",invoice_id:"3548",approved:!1,viaduct:!0,from:"2025-09-10",to:"2025-09-20",media_received:!1,final_price:890.5,invoice_sent:!1,updated:"2025-08-22T14:30:00Z"}]));i(e),d(1),f(e.length)}finally{o(!1)}})()},[l,t,r,m,w,T,E,N]),s)?(0,y.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-8",children:(0,y.jsxs)("div",{className:"flex items-center justify-center",children:[(0,y.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,y.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Kraunama..."})]})}):(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,y.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Užsakymai (",h,")",g>0&&(0,y.jsxs)("span",{className:"ml-2 text-sm font-normal text-green-600 dark:text-green-400",children:["- Suma: €",g.toLocaleString("lt-LT",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),m&&(0,y.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Rūšiuojama pagal: ",(0,y.jsx)("span",{className:"font-medium",children:m}),"(","asc"===w?"didėjimo":"mažėjimo"," tvarka)"]})]}),(0,y.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Puslapis ",l," iš ",u]})]})}),(0,y.jsx)("div",{className:"overflow-x-auto",children:(0,y.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,y.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("client"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Klientas"}),P("client")]})}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("agency"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Agentūra"}),P("agency")]})}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("invoice_id"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Užsakymo Nr."}),P("invoice_id")]})}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("approved"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Statusas"}),P("approved")]})}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("from"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Data nuo"}),P("from")]})}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("to"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Data iki"}),P("to")]})}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("media_received"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Media gautas"}),P("media_received")]})}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("final_price"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Kaina"}),P("final_price")]})}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>C("invoice_sent"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)("span",{children:"Sąskaita"}),P("invoice_sent")]})})]})}),(0,y.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:a.map(e=>{let t;return(0,y.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors",onClick:()=>n(e),children:[(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsxs)("div",{children:[e.viaduct&&(0,y.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Viadukai"}),(0,y.jsxs)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.client,(e=>{if(!e.approved||e.media_received)return!1;try{let t=new Date(e.from),r=new Date,n=t.getTime()-r.getTime();return 2>=Math.ceil(n/864e5)}catch(e){return!1}})(e)&&(0,y.jsx)("span",{className:"ml-2 text-red-600 animate-pulse",children:"⚠️"})]})]})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.agency||"-"})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:e.invoice_id})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.approved?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:e.approved?"Patvirtinta":"Nepatvirtinta"})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:O(e.from)})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:O(e.to)})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.media_received?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:e.media_received?"Taip":"Ne"})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(t=e.final_price,new Intl.NumberFormat("lt-LT",{style:"currency",currency:"EUR"}).format(t))})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e)},className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(e.invoice_sent?"bg-green-300":"bg-gray-200"),children:(0,y.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(e.invoice_sent?"translate-x-6":"translate-x-1")})})})]},e.id)})})]})}),u>1&&(0,y.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Rodoma ",(l-1)*20+1," - ",Math.min(20*l,h)," iš ",h," rezultatų"]}),(0,y.jsxs)("div",{className:"flex space-x-2",children:[(0,y.jsx)("button",{onClick:()=>c(Math.max(1,l-1)),disabled:1===l,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Ankstesnis"}),(0,y.jsx)("button",{onClick:()=>c(Math.min(u,l+1)),disabled:l===u,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Sekantis"})]})]})})]})}let el=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"}))}),ec=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"}))}),eu=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});function ed(e){let{onAddOrder:t,isDarkMode:r,onToggleDarkMode:n}=e;return(0,y.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:(0,y.jsx)("div",{className:"container mx-auto px-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,y.jsx)("div",{className:"flex items-center space-x-4",children:(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:(0,y.jsx)("span",{className:"text-white font-bold text-xl",children:"P"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Piksel Orders"}),(0,y.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Užsakymų valdymas"})]})]})}),(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsx)("button",{onClick:n,className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:r?(0,y.jsx)(el,{className:"w-5 h-5"}):(0,y.jsx)(ec,{className:"w-5 h-5"})}),(0,y.jsxs)("button",{onClick:t,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-medium rounded-lg hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl",children:[(0,y.jsx)(eu,{className:"w-5 h-5 mr-2"}),"Pridėti užsakymą"]})]})]})})})}let eh=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}),ef=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))});function eg(e){var t,r,n,a;let{searchQuery:i,onSearchChange:s,filters:o,onFiltersChange:l}=e,c=[{value:"01",label:"Sausis"},{value:"02",label:"Vasaris"},{value:"03",label:"Kovas"},{value:"04",label:"Balandis"},{value:"05",label:"Gegužė"},{value:"06",label:"Birželis"},{value:"07",label:"Liepa"},{value:"08",label:"Rugpjūtis"},{value:"09",label:"Rugsėjis"},{value:"10",label:"Spalis"},{value:"11",label:"Lapkritis"},{value:"12",label:"Gruodis"}],u=Array.from({length:5},(e,t)=>new Date().getFullYear()-2+t),d=[{value:"",label:"Visi statusai"},{value:"taip",label:"Patvirtinta"},{value:"ne",label:"Nepatvirtinta"},{value:"rezervuota",label:"Rezervuota"},{value:"atšaukta",label:"Atšaukta"}],h=[{value:"",label:"Visi media"},{value:"true",label:"Media gautas"},{value:"false",label:"Media negautas"}],f=(e,t)=>{l({...o,[e]:t})};return(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6",children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Paieška"}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(eh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,y.jsx)("input",{type:"text",placeholder:"Ieškoti pagal klientą, agentūrą, užsakymo Nr...",value:i,onChange:e=>s(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Filtrai"}),("taip"===o.status||o.month||o.year)&&(0,y.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-3 py-2 rounded-md",children:["ℹ️ Aktyvūs filtrai: ","taip"===o.status?"Patvirtinta, ":"",o.month?"".concat(null==(t=c.find(e=>e.value===o.month))?void 0:t.label,", "):"",o.year?"".concat(o.year," metai"):""]}),(0,y.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,y.jsx)("select",{value:o.status,onChange:e=>f("status",e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm",children:d.map(e=>(0,y.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,y.jsxs)("select",{value:o.month,onChange:e=>f("month",e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm",children:[(0,y.jsx)("option",{value:"",children:"Visi mėnesiai"}),c.map(e=>(0,y.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,y.jsxs)("select",{value:o.year,onChange:e=>f("year",e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm",children:[(0,y.jsx)("option",{value:"",children:"Visi metai"}),u.map(e=>(0,y.jsx)("option",{value:e.toString(),children:e},e))]}),(0,y.jsx)("select",{value:o.media_received,onChange:e=>f("media_received",e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm",children:h.map(e=>(0,y.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,y.jsx)("input",{type:"text",placeholder:"Klientas",value:o.client,onChange:e=>f("client",e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm"}),(0,y.jsx)("input",{type:"text",placeholder:"Agentūra",value:o.agency,onChange:e=>f("agency",e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white text-sm"})]})]})]}),(o.status||o.month||o.year||o.client||o.agency)&&(0,y.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(ef,{className:"w-4 h-4 text-gray-500"}),(0,y.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Aktyvūs filtrai:"}),(0,y.jsxs)("div",{className:"flex flex-wrap gap-2",children:[o.status&&(0,y.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:["Statusas: ",null==(r=d.find(e=>e.value===o.status))?void 0:r.label,(0,y.jsx)("button",{onClick:()=>f("status",""),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]}),o.month&&(0,y.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:["Mėnuo: ",null==(n=c.find(e=>e.value===o.month))?void 0:n.label,(0,y.jsx)("button",{onClick:()=>f("month",""),className:"ml-1 text-green-600 hover:text-green-800",children:"×"})]}),o.year&&(0,y.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",children:["Metai: ",o.year,(0,y.jsx)("button",{onClick:()=>f("year",""),className:"ml-1 text-purple-600 hover:text-purple-800",children:"×"})]}),o.client&&(0,y.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",children:["Klientas: ",o.client,(0,y.jsx)("button",{onClick:()=>f("client",""),className:"ml-1 text-orange-600 hover:text-orange-800",children:"×"})]}),o.agency&&(0,y.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200",children:["Agentūra: ",o.agency,(0,y.jsx)("button",{onClick:()=>f("agency",""),className:"ml-1 text-indigo-600 hover:text-indigo-800",children:"×"})]}),o.media_received&&(0,y.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200",children:["Media: ",null==(a=h.find(e=>e.value===o.media_received))?void 0:a.label,(0,y.jsx)("button",{onClick:()=>f("media_received",""),className:"ml-1 text-teal-600 hover:text-teal-800",children:"×"})]})]})]})})]})}var ep=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(ep||{}),em=Object.defineProperty,ey=(e,t,r)=>(((e,t,r)=>t in e?em(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r),r);let ev=new class{set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"undefined"==typeof window||"undefined"==typeof document?"server":"client"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}constructor(){ey(this,"current",this.detect()),ey(this,"handoffState","pending"),ey(this,"currentId",0)}},eb=(e,t)=>{ev.isServer?(0,v.useEffect)(e,t):(0,v.useLayoutEffect)(e,t)};function ew(e){let t=(0,v.useRef)(e);return eb(()=>{t.current=e},[e]),t}function ex(e,t,r,n){let a=ew(r);(0,v.useEffect)(()=>{function r(e){a.current(e)}return(e=null!=e?e:window).addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)},[e,t,n])}class ek extends Map{get(e){let t=super.get(e);return void 0===t&&(t=this.factory(e),this.set(e,t)),t}constructor(e){super(),this.factory=e}}function e_(e){"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))}function ej(){let e=[],t={addEventListener:(e,r,n,a)=>(e.addEventListener(r,n,a),t.add(()=>e.removeEventListener(r,n,a))),requestAnimationFrame(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];let a=requestAnimationFrame(...r);return t.add(()=>cancelAnimationFrame(a))},nextFrame(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.requestAnimationFrame(()=>t.requestAnimationFrame(...r))},setTimeout(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];let a=setTimeout(...r);return t.add(()=>clearTimeout(a))},microTask(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];let a={current:!0};return e_(()=>{a.current&&r[0]()}),t.add(()=>{a.current=!1})},style(e,t,r){let n=e.style.getPropertyValue(t);return Object.assign(e.style,{[t]:r}),this.add(()=>{Object.assign(e.style,{[t]:n})})},group(e){let t=ej();return e(t),this.add(()=>t.dispose())},add:t=>(e.includes(t)||e.push(t),()=>{let r=e.indexOf(t);if(r>=0)for(let t of e.splice(r,1))t()}),dispose(){for(let t of e.splice(0))t()}};return t}var eS=Object.defineProperty,eE=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},eN=(e,t,r)=>(eE(e,t,"read from private field"),r?r.call(e):t.get(e)),eT=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},eC=(e,t,r,n)=>(eE(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);class eP{dispose(){this.disposables.dispose()}get state(){return eN(this,t)}subscribe(e,r){if(ev.isServer)return()=>{};let a={selector:e,callback:r,current:e(eN(this,t))};return eN(this,n).add(a),this.disposables.add(()=>{eN(this,n).delete(a)})}on(e,t){return ev.isServer?()=>{}:(eN(this,r).get(e).add(t),this.disposables.add(()=>{eN(this,r).get(e).delete(t)}))}send(e){let a=this.reduce(eN(this,t),e);if(a!==eN(this,t)){for(let e of(eC(this,t,a),eN(this,n))){let r=e.selector(eN(this,t));eO(e.current,r)||(e.current=r,e.callback(r))}for(let n of eN(this,r).get(e.type))n(eN(this,t),e)}}constructor(e){eT(this,t,{}),eT(this,r,new ek(()=>new Set)),eT(this,n,new Set),((e,t,r)=>((e,t,r)=>t in e?eS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r))(this,"disposables",ej()),eC(this,t,e),ev.isServer&&this.disposables.microTask(()=>{this.dispose()})}}function eO(e,t){return!!Object.is(e,t)||"object"==typeof e&&null!==e&&"object"==typeof t&&null!==t&&(Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&eA(e[Symbol.iterator](),t[Symbol.iterator]()):e instanceof Map&&t instanceof Map||e instanceof Set&&t instanceof Set?e.size===t.size&&eA(e.entries(),t.entries()):!!(eR(e)&&eR(t))&&eA(Object.entries(e)[Symbol.iterator](),Object.entries(t)[Symbol.iterator]()))}function eA(e,t){for(;;){let r=e.next(),n=t.next();if(r.done&&n.done)return!0;if(r.done||n.done||!Object.is(r.value,n.value))return!1}}function eR(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);return null===t||null===Object.getPrototypeOf(t)}function eI(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(e in t){let r=t[e];return"function"==typeof r?r(...n):r}let i=Error('Tried to handle "'.concat(e,'" but there is no handler defined. Only defined handlers are: ').concat(Object.keys(t).map(e=>'"'.concat(e,'"')).join(", "),"."));throw Error.captureStackTrace&&Error.captureStackTrace(i,eI),i}t=new WeakMap,r=new WeakMap,n=new WeakMap;var eL=Object.defineProperty,eM=(e,t,r)=>(((e,t,r)=>t in e?eL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r),r),eD=(e=>(e[e.Push=0]="Push",e[e.Pop=1]="Pop",e))(eD||{});let eU={0(e,t){let r=t.id,n=e.stack,a=e.stack.indexOf(r);if(-1!==a){let t=e.stack.slice();return t.splice(a,1),t.push(r),n=t,{...e,stack:n}}return{...e,stack:[...e.stack,r]}},1(e,t){let r=t.id,n=e.stack.indexOf(r);if(-1===n)return e;let a=e.stack.slice();return a.splice(n,1),{...e,stack:a}}};class eF extends eP{static new(){return new eF({stack:[]})}reduce(e,t){return eI(t.type,eU,e,t)}constructor(){super(...arguments),eM(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),eM(this,"selectors",{isTop:(e,t)=>e.stack[e.stack.length-1]===t,inStack:(e,t)=>e.stack.includes(t)})}}let eB=new ek(()=>eF.new());var eq=e.i(13027);let eW=function(e){let t=ew(e);return v.default.useCallback(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.current(...r)},[t])};function ez(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eO;return(0,eq.useSyncExternalStoreWithSelector)(eW(t=>e.subscribe(eH,t)),eW(()=>e.state),eW(()=>e.state),eW(t),r)}function eH(e){return e}function eK(e,t){let r=(0,v.useId)(),n=eB.get(t),[a,i]=ez(n,(0,v.useCallback)(e=>[n.selectors.isTop(e,r),n.selectors.inStack(e,r)],[n,r]));return eb(()=>{if(e)return n.actions.push(r),()=>n.actions.pop(r)},[n,e,r]),!!e&&(!i||a)}function eG(e){var t,r;return ev.isServer?null:e?"ownerDocument"in e?e.ownerDocument:"current"in e?null!=(r=null==(t=e.current)?void 0:t.ownerDocument)?r:document:null:document}let eV=new Map,eJ=new Map;function eY(e){var t;let r=null!=(t=eJ.get(e))?t:0;return eJ.set(e,r+1),0!==r||(eV.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0),()=>(function(e){var t;let r=null!=(t=eJ.get(e))?t:1;if(1===r?eJ.delete(e):eJ.set(e,r-1),1!==r)return;let n=eV.get(e);n&&(null===n["aria-hidden"]?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",n["aria-hidden"]),e.inert=n.inert,eV.delete(e))})(e)}function eQ(e){return"object"==typeof e&&null!==e&&"nodeType"in e}function eX(e){return eQ(e)&&"tagName"in e}function e$(e){return eX(e)&&"accessKey"in e}function eZ(e){return eX(e)&&"tabIndex"in e}let e0=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>"".concat(e,":not([tabindex='-1'])")).join(","),e1=["[data-autofocus]"].map(e=>"".concat(e,":not([tabindex='-1'])")).join(",");var e2=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(e2||{}),e5=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(e5||{}),e3=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(e3||{}),e6=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(e6||{}),e4=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(e4||{});function e8(e){null==e||e.focus({preventScroll:!0})}function e7(e,t){var r,n,a;let{sorted:i=!0,relativeTo:s=null,skipElements:o=[]}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,c=Array.isArray(e)?i?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;return e.slice().sort((e,r)=>{let n=t(e),a=t(r);if(null===n||null===a)return 0;let i=n.compareDocumentPosition(a);return i&Node.DOCUMENT_POSITION_FOLLOWING?-1:i&Node.DOCUMENT_POSITION_PRECEDING?1:0})}(e):e:64&t?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return null==e?[]:Array.from(e.querySelectorAll(e1)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}(e):function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return null==e?[]:Array.from(e.querySelectorAll(e0)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}(e);o.length>0&&c.length>1&&(c=c.filter(e=>!o.some(t=>null!=t&&"current"in t?(null==t?void 0:t.current)===e:t===e))),s=null!=s?s:l.activeElement;let u=(()=>{if(5&t)return 1;if(10&t)return -1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=(()=>{if(1&t)return 0;if(2&t)return Math.max(0,c.indexOf(s))-1;if(4&t)return Math.max(0,c.indexOf(s))+1;if(8&t)return c.length-1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=32&t?{preventScroll:!0}:{},f=0,g=c.length,p;do{if(f>=g||f+g<=0)return 0;let e=d+f;if(16&t)e=(e+g)%g;else{if(e<0)return 3;if(e>=g)return 1}null==(p=c[e])||p.focus(h),f+=u}while(p!==l.activeElement)return 6&t&&null!=(a=null==(n=null==(r=p)?void 0:r.matches)?void 0:n.call(r,"textarea,input"))&&a&&p.select(),2}function e9(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function te(){return e9()||/Android/gi.test(window.navigator.userAgent)}function tt(e,t,r,n){let a=ew(r);(0,v.useEffect)(()=>{if(e)return document.addEventListener(t,r,n),()=>document.removeEventListener(t,r,n);function r(e){a.current(e)}},[e,t,n])}function tr(e,t,r,n){let a=ew(r);(0,v.useEffect)(()=>{if(e)return window.addEventListener(t,r,n),()=>window.removeEventListener(t,r,n);function r(e){a.current(e)}},[e,t,n])}function tn(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,v.useMemo)(()=>eG(...t),[...t])}function ta(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Array.from(new Set(t.flatMap(e=>"string"==typeof e?e.split(" "):[]))).filter(Boolean).join(" ")}"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{1===e.detail?delete document.documentElement.dataset.headlessuiFocusVisible:0===e.detail&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));var ti=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(ti||{}),ts=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(ts||{});function to(){let e,t,r=(e=(0,v.useRef)([]),t=(0,v.useCallback)(t=>{for(let r of e.current)null!=r&&("function"==typeof r?r(t):r.current=t)},[]),function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];if(!n.every(e=>null==e))return e.current=n,t});return(0,v.useCallback)(e=>(function(e){let{ourProps:t,theirProps:r,slot:n,defaultTag:a,features:i,visible:s=!0,name:o,mergeRefs:l}=e;l=null!=l?l:tc;let c=tu(r,t);if(s)return tl(c,n,a,o,l);let u=null!=i?i:0;if(2&u){let{static:e=!1,...t}=c;if(e)return tl(t,n,a,o,l)}if(1&u){let{unmount:e=!0,...t}=c;return eI(+!e,{0:()=>null,1:()=>tl({...t,hidden:!0,style:{display:"none"}},n,a,o,l)})}return tl(c,n,a,o,l)})({mergeRefs:r,...e}),[r])}function tl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,{as:i=r,children:s,refName:o="ref",...l}=tf(e,["unmount","static"]),c=void 0!==e.ref?{[o]:e.ref}:{},u="function"==typeof s?s(t):s;"className"in l&&l.className&&"function"==typeof l.className&&(l.className=l.className(t)),l["aria-labelledby"]&&l["aria-labelledby"]===l.id&&(l["aria-labelledby"]=void 0);let d={};if(t){let e=!1,r=[];for(let[n,a]of Object.entries(t))"boolean"==typeof a&&(e=!0),!0===a&&r.push(n.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())));if(e)for(let e of(d["data-headlessui-state"]=r.join(" "),r))d["data-".concat(e)]=""}if(i===v.Fragment&&(Object.keys(th(l)).length>0||Object.keys(th(d)).length>0))if(!(0,v.isValidElement)(u)||Array.isArray(u)&&u.length>1){if(Object.keys(th(l)).length>0)throw Error(['Passing props on "Fragment"!\n',"The current component <".concat(n,' /> is rendering a "Fragment".'),"However we need to passthrough the following props:",Object.keys(th(l)).concat(Object.keys(th(d))).map(e=>"  - ".concat(e)).join("\n"),"\nYou can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(e=>"  - ".concat(e)).join("\n")].join("\n"))}else{var h;let e=u.props,t=null==e?void 0:e.className,r="function"==typeof t?function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return ta(t(...r),l.className)}:ta(t,l.className),n=tu(u.props,th(tf(l,["ref"])));for(let e in d)e in n&&delete d[e];return(0,v.cloneElement)(u,Object.assign({},n,d,c,{ref:a((h=u,v.default.version.split(".")[0]>="19"?h.props.ref:h.ref),c.ref)},r?{className:r}:{}))}return(0,v.createElement)(i,Object.assign({},tf(l,["ref"]),i!==v.Fragment&&c,i!==v.Fragment&&d),u)}function tc(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.every(e=>null==e)?void 0:e=>{for(let r of t)null!=r&&("function"==typeof r?r(e):r.current=e)}}function tu(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)return{};if(1===t.length)return t[0];let n={},a={};for(let e of t)for(let t in e)t.startsWith("on")&&"function"==typeof e[t]?(null!=a[t]||(a[t]=[]),a[t].push(e[t])):n[t]=e[t];if(n.disabled||n["aria-disabled"])for(let e in a)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(e)&&(a[e]=[e=>{var t;return null==(t=null==e?void 0:e.preventDefault)?void 0:t.call(e)}]);for(let e in a)Object.assign(n,{[e](t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(let r of a[e]){if((t instanceof Event||(null==t?void 0:t.nativeEvent)instanceof Event)&&t.defaultPrevented)return;r(t,...n)}}});return n}function td(e){var t;return Object.assign((0,v.forwardRef)(e),{displayName:null!=(t=e.displayName)?t:e.name})}function th(e){let t=Object.assign({},e);for(let e in t)void 0===t[e]&&delete t[e];return t}function tf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Object.assign({},e);for(let e of t)e in r&&delete r[e];return r}var tg=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(tg||{});let tp=td(function(e,t){var r;let{features:n=1,...a}=e,i={ref:t,"aria-hidden":(2&n)==2||(null!=(r=a["aria-hidden"])?r:void 0),hidden:(4&n)==4||void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(4&n)==4&&(2&n)!=2&&{display:"none"}}};return to()({ourProps:i,theirProps:a,slot:{},defaultTag:"span",name:"Hidden"})}),tm=(0,v.createContext)(null);function ty(e){let{children:t,node:r}=e,[n,a]=(0,v.useState)(null),i=tv(null!=r?r:n);return v.default.createElement(tm.Provider,{value:i},t,null===i&&v.default.createElement(tp,{features:tg.Hidden,ref:e=>{var t,r;if(e){for(let n of null!=(r=null==(t=eG(e))?void 0:t.querySelectorAll("html > *, body > *"))?r:[])if(n!==document.body&&n!==document.head&&eX(n)&&null!=n&&n.contains(e)){a(n);break}}}}))}function tv(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!=(e=(0,v.useContext)(tm))?e:t}let tb=function(e,t){let r=e(),n=new Set;return{getSnapshot:()=>r,subscribe:e=>(n.add(e),()=>n.delete(e)),dispatch(e){for(var a=arguments.length,i=Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];let o=t[e].call(r,...i);o&&(r=o,n.forEach(e=>e()))}}}(()=>new Map,{PUSH(e,t){var r;let n=null!=(r=this.get(e))?r:{doc:e,count:0,d:ej(),meta:new Set};return n.count++,n.meta.add(t),this.set(e,n),this},POP(e,t){let r=this.get(e);return r&&(r.count--,r.meta.delete(t)),this},SCROLL_PREVENT(e){let t,{doc:r,d:n,meta:a}=e,i={doc:r,d:n,meta:function(e){let t={};for(let r of e)Object.assign(t,r(t));return t}(a)},s=[e9()?{before(e){let{doc:t,d:r,meta:n}=e;function a(e){return n.containers.flatMap(e=>e()).some(t=>t.contains(e))}r.microTask(()=>{var e;if("auto"!==window.getComputedStyle(t.documentElement).scrollBehavior){let e=ej();e.style(t.documentElement,"scrollBehavior","auto"),r.add(()=>r.microTask(()=>e.dispose()))}let n=null!=(e=window.scrollY)?e:window.pageYOffset,i=null;r.addEventListener(t,"click",e=>{if(eZ(e.target))try{let r=e.target.closest("a");if(!r)return;let{hash:n}=new URL(r.href),s=t.querySelector(n);eZ(s)&&!a(s)&&(i=s)}catch(e){}},!0),r.addEventListener(t,"touchstart",e=>{var t;if(eZ(e.target)&&eX(t=e.target)&&"style"in t)if(a(e.target)){let t=e.target;for(;t.parentElement&&a(t.parentElement);)t=t.parentElement;r.style(t,"overscrollBehavior","contain")}else r.style(e.target,"touchAction","none")}),r.addEventListener(t,"touchmove",e=>{if(eZ(e.target)){var t;if(!(e$(t=e.target)&&"INPUT"===t.nodeName))if(a(e.target)){let t=e.target;for(;t.parentElement&&""!==t.dataset.headlessuiPortal&&!(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth);)t=t.parentElement;""===t.dataset.headlessuiPortal&&e.preventDefault()}else e.preventDefault()}},{passive:!1}),r.add(()=>{var e;n!==(null!=(e=window.scrollY)?e:window.pageYOffset)&&window.scrollTo(0,n),i&&i.isConnected&&(i.scrollIntoView({block:"nearest"}),i=null)})})}}:{},{before(e){var r;let{doc:n}=e,a=n.documentElement;t=Math.max(0,(null!=(r=n.defaultView)?r:window).innerWidth-a.clientWidth)},after(e){let{doc:r,d:n}=e,a=r.documentElement,i=Math.max(0,a.clientWidth-a.offsetWidth),s=Math.max(0,t-i);n.style(a,"paddingRight","".concat(s,"px"))}},{before(e){let{doc:t,d:r}=e;r.style(t.documentElement,"overflow","hidden")}}];s.forEach(e=>{let{before:t}=e;return null==t?void 0:t(i)}),s.forEach(e=>{let{after:t}=e;return null==t?void 0:t(i)})},SCROLL_ALLOW(e){let{d:t}=e;t.dispose()},TEARDOWN(e){let{doc:t}=e;this.delete(t)}});function tw(){let e,t=(e="undefined"==typeof document,"useSyncExternalStore"in v&&(0,v.useSyncExternalStore)(()=>()=>{},()=>!1,()=>!e)),[r,n]=v.useState(ev.isHandoffComplete);return r&&!1===ev.isHandoffComplete&&n(!1),v.useEffect(()=>{!0!==r&&n(!0)},[r]),v.useEffect(()=>ev.handoff(),[]),!t&&r}tb.subscribe(()=>{let e=tb.getSnapshot(),t=new Map;for(let[r]of e)t.set(r,r.documentElement.style.overflow);for(let r of e.values()){let e="hidden"===t.get(r.doc),n=0!==r.count;(n&&!e||!n&&e)&&tb.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),0===r.count&&tb.dispatch("TEARDOWN",r)}});let tx=Symbol();function tk(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=(0,v.useRef)(t);(0,v.useEffect)(()=>{n.current=t},[t]);let a=eW(e=>{for(let t of n.current)null!=t&&("function"==typeof t?t(e):t.current=e)});return t.every(e=>null==e||(null==e?void 0:e[tx]))?void 0:a}let t_=(0,v.createContext)(()=>{});function tj(e){let{value:t,children:r}=e;return v.default.createElement(t_.Provider,{value:t},r)}let tS=(0,v.createContext)(null);tS.displayName="OpenClosedContext";var tE=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(tE||{});function tN(){return(0,v.useContext)(tS)}function tT(e){let{value:t,children:r}=e;return v.default.createElement(tS.Provider,{value:t},r)}function tC(e){let{children:t}=e;return v.default.createElement(tS.Provider,{value:null},t)}let tP=(0,v.createContext)(!1);function tO(e){return v.default.createElement(tP.Provider,{value:e.force},e.children)}let tA=(0,v.createContext)(void 0),tR=(0,v.createContext)(null);tR.displayName="DescriptionContext";let tI=Object.assign(td(function(e,t){let r=(0,v.useId)(),n=(0,v.useContext)(tA),{id:a="headlessui-description-".concat(r),...i}=e,s=function e(){let t=(0,v.useContext)(tR);if(null===t){let t=Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,e),t}return t}(),o=tk(t);eb(()=>s.register(a),[a,s.register]);let l=n||!1,c=(0,v.useMemo)(()=>({...s.slot,disabled:l}),[s.slot,l]),u={ref:o,...s.props,id:a};return to()({ourProps:u,theirProps:i,slot:c,defaultTag:"p",name:s.name||"Description"})}),{});function tL(){let[e]=(0,v.useState)(ej);return(0,v.useEffect)(()=>()=>e.dispose(),[e]),e}function tM(){let e=(0,v.useRef)(!1);return eb(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function tD(e){let t=eW(e),r=(0,v.useRef)(!1);(0,v.useEffect)(()=>(r.current=!1,()=>{r.current=!0,e_(()=>{r.current&&t()})}),[t])}var tU=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(tU||{});function tF(e,t){let r=(0,v.useRef)([]),n=eW(e);(0,v.useEffect)(()=>{let e=[...r.current];for(let[a,i]of t.entries())if(r.current[a]!==i){let a=n(t,e);return r.current=t,a}},[n,...t])}let tB=[];function tq(e){if(!e)return new Set;if("function"==typeof e)return new Set(e());let t=new Set;for(let r of e.current)eX(r.current)&&t.add(r.current);return t}!function(e){function t(){"loading"!==document.readyState&&(e(),document.removeEventListener("DOMContentLoaded",t))}"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("DOMContentLoaded",t),t())}(()=>{function e(e){if(!eZ(e.target)||e.target===document.body||tB[0]===e.target)return;let t=e.target;t=t.closest(e0),tB.unshift(null!=t?t:e.target),(tB=tB.filter(e=>null!=e&&e.isConnected)).splice(10)}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});var tW=(e=>(e[e.None=0]="None",e[e.InitialFocus=1]="InitialFocus",e[e.TabLock=2]="TabLock",e[e.FocusLock=4]="FocusLock",e[e.RestoreFocus=8]="RestoreFocus",e[e.AutoFocus=16]="AutoFocus",e))(tW||{});let tz=Object.assign(td(function(e,t){let r,n=(0,v.useRef)(null),a=tk(n,t),{initialFocus:i,initialFocusFallback:s,containers:o,features:l=15,...c}=e;tw()||(l=0);let u=tn(n);!function(e,t){let{ownerDocument:r}=t,n=!!(8&e),a=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,v.useRef)(tB.slice());return tF((e,r)=>{let[n]=e,[a]=r;!0===a&&!1===n&&e_(()=>{t.current.splice(0)}),!1===a&&!0===n&&(t.current=tB.slice())},[e,tB,t]),eW(()=>{var e;return null!=(e=t.current.find(e=>null!=e&&e.isConnected))?e:null})}(n);tF(()=>{n||(null==r?void 0:r.activeElement)===(null==r?void 0:r.body)&&e8(a())},[n]),tD(()=>{n&&e8(a())})}(l,{ownerDocument:u});let d=function(e,t){let{ownerDocument:r,container:n,initialFocus:a,initialFocusFallback:i}=t,s=(0,v.useRef)(null),o=eK(!!(1&e),"focus-trap#initial-focus"),l=tM();return tF(()=>{if(0===e)return;if(!o){null!=i&&i.current&&e8(i.current);return}let t=n.current;t&&e_(()=>{if(!l.current)return;let n=null==r?void 0:r.activeElement;if(null!=a&&a.current){if((null==a?void 0:a.current)===n){s.current=n;return}}else if(t.contains(n)){s.current=n;return}if(null!=a&&a.current)e8(a.current);else{if(16&e){if(e7(t,e2.First|e2.AutoFocus)!==e5.Error)return}else if(e7(t,e2.First)!==e5.Error)return;if(null!=i&&i.current&&(e8(i.current),(null==r?void 0:r.activeElement)===i.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}s.current=null==r?void 0:r.activeElement})},[i,o,e]),s}(l,{ownerDocument:u,container:n,initialFocus:i,initialFocusFallback:s});!function(e,t){let{ownerDocument:r,container:n,containers:a,previousActiveElement:i}=t,s=tM(),o=!!(4&e);ex(null==r?void 0:r.defaultView,"focus",e=>{if(!o||!s.current)return;let t=tq(a);e$(n.current)&&t.add(n.current);let r=i.current;if(!r)return;let l=e.target;e$(l)?tH(t,l)?(i.current=l,e8(l)):(e.preventDefault(),e.stopPropagation(),e8(r)):e8(i.current)},!0)}(l,{ownerDocument:u,container:n,containers:o,previousActiveElement:d});let h=(r=(0,v.useRef)(0),tr(!0,"keydown",e=>{"Tab"===e.key&&(r.current=+!!e.shiftKey)},!0),r),f=eW(e=>{if(!e$(n.current))return;let t=n.current;eI(h.current,{[tU.Forwards]:()=>{e7(t,e2.First,{skipElements:[e.relatedTarget,s]})},[tU.Backwards]:()=>{e7(t,e2.Last,{skipElements:[e.relatedTarget,s]})}})}),g=eK(!!(2&l),"focus-trap#tab-lock"),p=tL(),m=(0,v.useRef)(!1),y=to();return v.default.createElement(v.default.Fragment,null,g&&v.default.createElement(tp,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:f,features:tg.Focusable}),y({ourProps:{ref:a,onKeyDown(e){"Tab"==e.key&&(m.current=!0,p.requestAnimationFrame(()=>{m.current=!1}))},onBlur(e){if(!(4&l))return;let t=tq(o);e$(n.current)&&t.add(n.current);let r=e.relatedTarget;eZ(r)&&"true"!==r.dataset.headlessuiFocusGuard&&(tH(t,r)||(m.current?e7(n.current,eI(h.current,{[tU.Forwards]:()=>e2.Next,[tU.Backwards]:()=>e2.Previous})|e2.WrapAround,{relativeTo:e.target}):eZ(e.target)&&e8(e.target)))}},theirProps:c,defaultTag:"div",name:"FocusTrap"}),g&&v.default.createElement(tp,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:f,features:tg.Focusable}))}),{features:tW});function tH(e,t){for(let r of e)if(r.contains(t))return!0;return!1}var tK=e.i(74080);let tG=v.Fragment,tV=td(function(e,t){let{ownerDocument:r=null,...n}=e,a=(0,v.useRef)(null),i=tk(function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return Object.assign(e,{[tx]:t})}(e=>{a.current=e}),t),s=tn(a),o=null!=r?r:s,l=function(e){let t=(0,v.useContext)(tP),r=(0,v.useContext)(tY),[n,a]=(0,v.useState)(()=>{var n;if(!t&&null!==r)return null!=(n=r.current)?n:null;if(ev.isServer)return null;let a=null==e?void 0:e.getElementById("headlessui-portal-root");if(a)return a;if(null===e)return null;let i=e.createElement("div");return i.setAttribute("id","headlessui-portal-root"),e.body.appendChild(i)});return(0,v.useEffect)(()=>{null!==n&&(null!=e&&e.body.contains(n)||null==e||e.body.appendChild(n))},[n,e]),(0,v.useEffect)(()=>{t||null!==r&&a(r.current)},[r,a,t]),n}(o),[c]=(0,v.useState)(()=>{var e;return ev.isServer?null:null!=(e=null==o?void 0:o.createElement("div"))?e:null}),u=(0,v.useContext)(tQ),d=tw();eb(()=>{!l||!c||l.contains(c)||(c.setAttribute("data-headlessui-portal",""),l.appendChild(c))},[l,c]),eb(()=>{if(c&&u)return u.register(c)},[u,c]),tD(()=>{var e;l&&c&&(eQ(c)&&l.contains(c)&&l.removeChild(c),l.childNodes.length<=0&&(null==(e=l.parentElement)||e.removeChild(l)))});let h=to();return d&&l&&c?(0,tK.createPortal)(h({ourProps:{ref:i},theirProps:n,slot:{},defaultTag:tG,name:"Portal"}),c):null}),tJ=v.Fragment,tY=(0,v.createContext)(null),tQ=(0,v.createContext)(null),tX=td(function(e,t){let r=tk(t),{enabled:n=!0,ownerDocument:a,...i}=e,s=to();return n?v.default.createElement(tV,{...i,ownerDocument:a,ref:r}):s({ourProps:{ref:r},theirProps:i,slot:{},defaultTag:tG,name:"Portal"})}),t$=td(function(e,t){let{target:r,...n}=e,a={ref:tk(t)},i=to();return v.default.createElement(tY.Provider,{value:r},i({ourProps:a,theirProps:n,defaultTag:tJ,name:"Popover.Group"}))}),tZ=Object.assign(tX,{Group:t$});void 0!==w.default&&"undefined"!=typeof globalThis&&"undefined"!=typeof Element&&(null==(a=null==w.default?void 0:w.default.env)?void 0:a.NODE_ENV)==="test"&&void 0===(null==(i=null==Element?void 0:Element.prototype)?void 0:i.getAnimations)&&(Element.prototype.getAnimations=function(){return console.warn("Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.\nPlease install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.\n\nExample usage:\n```js\nimport { mockAnimationsApi } from 'jsdom-testing-mocks'\nmockAnimationsApi()\n```"),[]});var t0=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(t0||{});function t1(e){var t;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||(null!=(t=e.as)?t:t8)!==v.Fragment||1===v.default.Children.count(e.children)}let t2=(0,v.createContext)(null);t2.displayName="TransitionContext";var t5=(e=>(e.Visible="visible",e.Hidden="hidden",e))(t5||{});let t3=(0,v.createContext)(null);function t6(e){return"children"in e?t6(e.children):e.current.filter(e=>{let{el:t}=e;return null!==t.current}).filter(e=>{let{state:t}=e;return"visible"===t}).length>0}function t4(e,t){let r=ew(e),n=(0,v.useRef)([]),a=tM(),i=tL(),s=eW(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ts.Hidden,s=n.current.findIndex(t=>{let{el:r}=t;return r===e});-1!==s&&(eI(t,{[ts.Unmount](){n.current.splice(s,1)},[ts.Hidden](){n.current[s].state="hidden"}}),i.microTask(()=>{var e;!t6(n)&&a.current&&(null==(e=r.current)||e.call(r))}))}),o=eW(e=>{let t=n.current.find(t=>{let{el:r}=t;return r===e});return t?"visible"!==t.state&&(t.state="visible"):n.current.push({el:e,state:"visible"}),()=>s(e,ts.Unmount)}),l=(0,v.useRef)([]),c=(0,v.useRef)(Promise.resolve()),u=(0,v.useRef)({enter:[],leave:[]}),d=eW((e,r,n)=>{l.current.splice(0),t&&(t.chains.current[r]=t.chains.current[r].filter(t=>{let[r]=t;return r!==e})),null==t||t.chains.current[r].push([e,new Promise(e=>{l.current.push(e)})]),null==t||t.chains.current[r].push([e,new Promise(e=>{Promise.all(u.current[r].map(e=>{let[t,r]=e;return r})).then(()=>e())})]),"enter"===r?c.current=c.current.then(()=>null==t?void 0:t.wait.current).then(()=>n(r)):n(r)}),h=eW((e,t,r)=>{Promise.all(u.current[t].splice(0).map(e=>{let[t,r]=e;return r})).then(()=>{var e;null==(e=l.current.shift())||e()}).then(()=>r(t))});return(0,v.useMemo)(()=>({children:n,register:o,unregister:s,onStart:d,onStop:h,wait:c,chains:u}),[o,s,n,d,h,u,c])}t3.displayName="NestingContext";let t8=v.Fragment,t7=ti.RenderStrategy,t9=td(function(e,t){let{show:r,appear:n=!1,unmount:a=!0,...i}=e,s=(0,v.useRef)(null),o=tk(...t1(e)?[s,t]:null===t?[]:[t]);tw();let l=tN();if(void 0===r&&null!==l&&(r=(l&tE.Open)===tE.Open),void 0===r)throw Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[c,u]=(0,v.useState)(r?"visible":"hidden"),d=t4(()=>{r||u("hidden")}),[h,f]=(0,v.useState)(!0),g=(0,v.useRef)([r]);eb(()=>{!1!==h&&g.current[g.current.length-1]!==r&&(g.current.push(r),f(!1))},[g,r]);let p=(0,v.useMemo)(()=>({show:r,appear:n,initial:h}),[r,n,h]);eb(()=>{r?u("visible"):t6(d)||null===s.current||u("hidden")},[r,d]);let m={unmount:a},y=eW(()=>{var t;h&&f(!1),null==(t=e.beforeEnter)||t.call(e)}),b=eW(()=>{var t;h&&f(!1),null==(t=e.beforeLeave)||t.call(e)}),w=to();return v.default.createElement(t3.Provider,{value:d},v.default.createElement(t2.Provider,{value:p},w({ourProps:{...m,as:v.Fragment,children:v.default.createElement(re,{ref:o,...m,...i,beforeEnter:y,beforeLeave:b})},theirProps:{},defaultTag:v.Fragment,features:t7,visible:"visible"===c,name:"Transition"})))}),re=td(function(e,t){var r,n;let{transition:a=!0,beforeEnter:i,afterEnter:s,beforeLeave:o,afterLeave:l,enter:c,enterFrom:u,enterTo:d,entered:h,leave:f,leaveFrom:g,leaveTo:p,...m}=e,[y,b]=(0,v.useState)(null),w=(0,v.useRef)(null),x=t1(e),k=tk(...x?[w,t,b]:null===t?[]:[t]),_=null==(r=m.unmount)||r?ts.Unmount:ts.Hidden,{show:j,appear:S,initial:E}=function(){let e=(0,v.useContext)(t2);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),[N,T]=(0,v.useState)(j?"visible":"hidden"),C=function(){let e=(0,v.useContext)(t3);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),{register:P,unregister:O}=C;eb(()=>P(w),[P,w]),eb(()=>{if(_===ts.Hidden&&w.current)return j&&"visible"!==N?void T("visible"):eI(N,{hidden:()=>O(w),visible:()=>P(w)})},[N,w,P,O,j,_]);let A=tw();eb(()=>{if(x&&A&&"visible"===N&&null===w.current)throw Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[w,N,A,x]);let R=E&&!S,I=S&&j&&E,L=(0,v.useRef)(!1),M=t4(()=>{L.current||(T("hidden"),O(w))},C),D=eW(e=>{L.current=!0,M.onStart(w,e?"enter":"leave",e=>{"enter"===e?null==i||i():"leave"===e&&(null==o||o())})}),U=eW(e=>{let t=e?"enter":"leave";L.current=!1,M.onStop(w,t,e=>{"enter"===e?null==s||s():"leave"===e&&(null==l||l())}),"leave"!==t||t6(M)||(T("hidden"),O(w))});(0,v.useEffect)(()=>{x&&a||(D(j),U(j))},[j,x,a]);let[,F]=function(e,t,r,n){let[a,i]=(0,v.useState)(r),{hasFlag:s,addFlag:o,removeFlag:l}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,[t,r]=(0,v.useState)(e),n=(0,v.useCallback)(e=>r(e),[t]),a=(0,v.useCallback)(e=>r(t=>t|e),[t]),i=(0,v.useCallback)(e=>(t&e)===e,[t]);return{flags:t,setFlag:n,addFlag:a,hasFlag:i,removeFlag:(0,v.useCallback)(e=>r(t=>t&~e),[r]),toggleFlag:(0,v.useCallback)(e=>r(t=>t^e),[r])}}(e&&a?3:0),c=(0,v.useRef)(!1),u=(0,v.useRef)(!1);return eb(()=>{var a;if(e){if(r&&i(!0),!t){r&&o(3);return}return null==(a=null==n?void 0:n.start)||a.call(n,r),function(e,t){let{prepare:r,run:n,done:a,inFlight:i}=t,s=ej();return function(e,t){let{inFlight:r,prepare:n}=t;if(null!=r&&r.current)return n();let a=e.style.transition;e.style.transition="none",n(),e.offsetHeight,e.style.transition=a}(e,{prepare:r,inFlight:i}),s.nextFrame(()=>{n(),s.requestAnimationFrame(()=>{s.add(function(e,t){var r,n;let a=ej();if(!e)return a.dispose;let i=!1;a.add(()=>{i=!0});let s=null!=(n=null==(r=e.getAnimations)?void 0:r.call(e).filter(e=>e instanceof CSSTransition))?n:[];return 0===s.length?t():Promise.allSettled(s.map(e=>e.finished)).then(()=>{i||t()}),a.dispose}(e,a))})}),s.dispose}(t,{inFlight:c,prepare(){u.current?u.current=!1:u.current=c.current,c.current=!0,u.current||(r?(o(3),l(4)):(o(4),l(2)))},run(){u.current?r?(l(3),o(4)):(l(4),o(3)):r?l(1):o(1)},done(){var e;u.current&&"function"==typeof t.getAnimations&&t.getAnimations().length>0||(c.current=!1,l(7),r||i(!1),null==(e=null==n?void 0:n.end)||e.call(n,r))}})}},[e,r,t,tL()]),e?[a,{closed:s(1),enter:s(2),leave:s(4),transition:s(2)||s(4)}]:[r,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}(!(!a||!x||!A||R),y,j,{start:D,end:U}),B=th({ref:k,className:(null==(n=ta(m.className,I&&c,I&&u,F.enter&&c,F.enter&&F.closed&&u,F.enter&&!F.closed&&d,F.leave&&f,F.leave&&!F.closed&&g,F.leave&&F.closed&&p,!F.transition&&j&&h))?void 0:n.trim())||void 0,...function(e){let t={};for(let r in e)!0===e[r]&&(t["data-".concat(r)]="");return t}(F)}),q=0;"visible"===N&&(q|=tE.Open),"hidden"===N&&(q|=tE.Closed),j&&"hidden"===N&&(q|=tE.Opening),j||"visible"!==N||(q|=tE.Closing);let W=to();return v.default.createElement(t3.Provider,{value:M},v.default.createElement(tT,{value:q},W({ourProps:B,theirProps:m,defaultTag:t8,features:t7,visible:"visible"===N,name:"Transition.Child"})))}),rt=td(function(e,t){let r=null!==(0,v.useContext)(t2),n=null!==tN();return v.default.createElement(v.default.Fragment,null,!r&&n?v.default.createElement(t9,{ref:t,...e}):v.default.createElement(re,{ref:t,...e}))}),rr=Object.assign(t9,{Child:rt,Root:t9});var rn=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(rn||{}),ra=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(ra||{});let ri={0:(e,t)=>e.titleId===t.id?e:{...e,titleId:t.id}},rs=(0,v.createContext)(null);function ro(e){let t=(0,v.useContext)(rs);if(null===t){let t=Error("<".concat(e," /> is missing a parent <Dialog /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,ro),t}return t}function rl(e,t){return eI(t.type,ri,e,t)}rs.displayName="DialogContext";let rc=td(function(e,t){let r,n,a,i,s,o,l,c,u,d,h=(0,v.useId)(),{id:f="headlessui-dialog-".concat(h),open:g,onClose:p,initialFocus:m,role:y="dialog",autoFocus:b=!0,__demoMode:w=!1,unmount:x=!1,...k}=e,_=(0,v.useRef)(!1);y="dialog"===y||"alertdialog"===y?y:(_.current||(_.current=!0,console.warn("Invalid role [".concat(y,"] passed to <Dialog />. Only `dialog` and and `alertdialog` are supported. Using `dialog` instead."))),"dialog");let j=tN();void 0===g&&null!==j&&(g=(j&tE.Open)===tE.Open);let S=(0,v.useRef)(null),E=tk(S,t),N=tn(S),T=+!g,[C,P]=(0,v.useReducer)(rl,{titleId:null,descriptionId:null,panelRef:(0,v.createRef)()}),O=eW(()=>p(!1)),A=eW(e=>P({type:0,id:e})),R=!!tw()&&0===T,[I,L]=(r=(0,v.useContext)(tQ),n=(0,v.useRef)([]),a=eW(e=>(n.current.push(e),r&&r.register(e),()=>i(e))),i=eW(e=>{let t=n.current.indexOf(e);-1!==t&&n.current.splice(t,1),r&&r.unregister(e)}),s=(0,v.useMemo)(()=>({register:a,unregister:i,portals:n}),[a,i,n]),[n,(0,v.useMemo)(()=>function(e){let{children:t}=e;return v.default.createElement(tQ.Provider,{value:s},t)},[s])]),M=tv(),{resolveContainers:D}=function(){let{defaultContainers:e=[],portals:t,mainTreeNode:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=tn(r),a=eW(()=>{var a,i;let s=[];for(let t of e)null!==t&&(eX(t)?s.push(t):"current"in t&&eX(t.current)&&s.push(t.current));if(null!=t&&t.current)for(let e of t.current)s.push(e);for(let e of null!=(a=null==n?void 0:n.querySelectorAll("html > *, body > *"))?a:[])e!==document.body&&e!==document.head&&eX(e)&&"headlessui-portal-root"!==e.id&&(r&&(e.contains(r)||e.contains(null==(i=null==r?void 0:r.getRootNode())?void 0:i.host))||s.some(t=>e.contains(t))||s.push(e));return s});return{resolveContainers:a,contains:eW(e=>a().some(t=>t.contains(e)))}}({mainTreeNode:M,portals:I,defaultContainers:[{get current(){var U;return null!=(U=C.panelRef.current)?U:S.current}}]}),F=null!==j&&(j&tE.Closing)===tE.Closing;!function(e){let{allowed:t,disallowed:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=eK(e,"inert-others");eb(()=>{var e,a;if(!n)return;let i=ej();for(let t of null!=(e=null==r?void 0:r())?e:[])t&&i.add(eY(t));let s=null!=(a=null==t?void 0:t())?a:[];for(let e of s){if(!e)continue;let t=eG(e);if(!t)continue;let r=e.parentElement;for(;r&&r!==t.body;){for(let e of r.children)s.some(t=>e.contains(t))||i.add(eY(e));r=r.parentElement}}return i.dispose},[n,t,r])}(!w&&!F&&R,{allowed:eW(()=>{var e,t;return[null!=(t=null==(e=S.current)?void 0:e.closest("[data-headlessui-portal]"))?t:null]}),disallowed:eW(()=>{var e;return[null!=(e=null==M?void 0:M.closest("body > *:not(#headlessui-portal-root)"))?e:null]})});let B=eB.get(null);eb(()=>{if(R)return B.actions.push(f),()=>B.actions.pop(f)},[B,f,R]);let q=ez(B,(0,v.useCallback)(e=>B.selectors.isTop(e,f),[B,f]));o=ew(e=>{e.preventDefault(),O()}),l=(0,v.useCallback)(function(e,t){if(e.defaultPrevented)return;let r=t(e);if(null!==r&&r.getRootNode().contains(r)&&r.isConnected){for(let t of function e(t){return"function"==typeof t?e(t()):Array.isArray(t)||t instanceof Set?t:[t]}(D))if(null!==t&&(t.contains(r)||e.composed&&e.composedPath().includes(t)))return;return function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e!==(null==(t=eG(e))?void 0:t.body)&&eI(r,{0:()=>e.matches(e0),1(){let t=e;for(;null!==t;){if(t.matches(e0))return!0;t=t.parentElement}return!1}})}(r,e6.Loose)||-1===r.tabIndex||e.preventDefault(),o.current(e,r)}},[o,D]),c=(0,v.useRef)(null),tt(q,"pointerdown",e=>{var t,r;te()||(c.current=(null==(r=null==(t=e.composedPath)?void 0:t.call(e))?void 0:r[0])||e.target)},!0),tt(q,"pointerup",e=>{if(te()||!c.current)return;let t=c.current;return c.current=null,l(e,()=>t)},!0),u=(0,v.useRef)({x:0,y:0}),tt(q,"touchstart",e=>{u.current.x=e.touches[0].clientX,u.current.y=e.touches[0].clientY},!0),tt(q,"touchend",e=>{let t={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY};if(!(Math.abs(t.x-u.current.x)>=30||Math.abs(t.y-u.current.y)>=30))return l(e,()=>eZ(e.target)?e.target:null)},!0),tr(q,"blur",e=>l(e,()=>{var e;return e$(e=window.document.activeElement)&&"IFRAME"===e.nodeName?window.document.activeElement:null}),!0),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"undefined"!=typeof document?document.defaultView:null,r=arguments.length>2?arguments[2]:void 0,n=eK(e,"escape");ex(t,"keydown",e=>{n&&(e.defaultPrevented||e.key===ep.Escape&&r(e))})}(q,null==N?void 0:N.defaultView,e=>{e.preventDefault(),e.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur(),O()}),function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[document.body];!function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>({containers:[]}),n=(0,v.useSyncExternalStore)(tb.subscribe,tb.getSnapshot,tb.getSnapshot),a=t?n.get(t):void 0;a&&a.count,eb(()=>{if(!(!t||!e))return tb.dispatch("PUSH",t,r),()=>tb.dispatch("POP",t,r)},[e,t])}(eK(e,"scroll-lock"),t,e=>{var t;return{containers:[...null!=(t=e.containers)?t:[],r]}})}(!w&&!F&&R,N,D),d=ew(e=>{let t=e.getBoundingClientRect();0===t.x&&0===t.y&&0===t.width&&0===t.height&&O()}),(0,v.useEffect)(()=>{if(!R)return;let e=null===S?null:e$(S)?S:S.current;if(!e)return;let t=ej();if("undefined"!=typeof ResizeObserver){let r=new ResizeObserver(()=>d.current(e));r.observe(e),t.add(()=>r.disconnect())}if("undefined"!=typeof IntersectionObserver){let r=new IntersectionObserver(()=>d.current(e));r.observe(e),t.add(()=>r.disconnect())}return()=>t.dispose()},[S,d,R]);let[W,z]=function(){let[e,t]=(0,v.useState)([]);return[e.length>0?e.join(" "):void 0,(0,v.useMemo)(()=>function(e){let r=eW(e=>(t(t=>[...t,e]),()=>t(t=>{let r=t.slice(),n=r.indexOf(e);return -1!==n&&r.splice(n,1),r}))),n=(0,v.useMemo)(()=>({register:r,slot:e.slot,name:e.name,props:e.props,value:e.value}),[r,e.slot,e.name,e.props,e.value]);return v.default.createElement(tR.Provider,{value:n},e.children)},[t])]}(),H=(0,v.useMemo)(()=>[{dialogState:T,close:O,setTitleId:A,unmount:x},C],[T,C,O,A,x]),K=(0,v.useMemo)(()=>({open:0===T}),[T]),G={ref:E,id:f,role:y,tabIndex:-1,"aria-modal":w?void 0:0===T||void 0,"aria-labelledby":C.titleId,"aria-describedby":W,unmount:x},V=!function(){var e;let[t]=(0,v.useState)(()=>"undefined"!=typeof window&&"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)"):null),[r,n]=(0,v.useState)(null!=(e=null==t?void 0:t.matches)&&e);return eb(()=>{if(t)return t.addEventListener("change",e),()=>t.removeEventListener("change",e);function e(e){n(e.matches)}},[t]),r}(),J=tW.None;R&&!w&&(J|=tW.RestoreFocus,J|=tW.TabLock,b&&(J|=tW.AutoFocus),V&&(J|=tW.InitialFocus));let Y=to();return v.default.createElement(tC,null,v.default.createElement(tO,{force:!0},v.default.createElement(tZ,null,v.default.createElement(rs.Provider,{value:H},v.default.createElement(t$,{target:S},v.default.createElement(tO,{force:!1},v.default.createElement(z,{slot:K},v.default.createElement(L,null,v.default.createElement(tz,{initialFocus:m,initialFocusFallback:S,containers:D,features:J},v.default.createElement(tj,{value:O},Y({ourProps:G,theirProps:k,slot:K,defaultTag:ru,features:rd,visible:0===T,name:"Dialog"})))))))))))}),ru="div",rd=ti.RenderStrategy|ti.Static,rh=Object.assign(td(function(e,t){let{transition:r=!1,open:n,...a}=e,i=tN(),s=e.hasOwnProperty("open")||null!==i,o=e.hasOwnProperty("onClose");if(!s&&!o)throw Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!s)throw Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!o)throw Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!i&&"boolean"!=typeof e.open)throw Error("You provided an `open` prop to the `Dialog`, but the value is not a boolean. Received: ".concat(e.open));if("function"!=typeof e.onClose)throw Error("You provided an `onClose` prop to the `Dialog`, but the value is not a function. Received: ".concat(e.onClose));return(void 0!==n||r)&&!a.static?v.default.createElement(ty,null,v.default.createElement(rr,{show:n,transition:r,unmount:a.unmount},v.default.createElement(rc,{ref:t,...a}))):v.default.createElement(ty,null,v.default.createElement(rc,{ref:t,open:n,...a}))}),{Panel:td(function(e,t){let r=(0,v.useId)(),{id:n="headlessui-dialog-panel-".concat(r),transition:a=!1,...i}=e,[{dialogState:s,unmount:o},l]=ro("Dialog.Panel"),c=tk(t,l.panelRef),u=(0,v.useMemo)(()=>({open:0===s}),[s]),d=eW(e=>{e.stopPropagation()}),h=a?rt:v.Fragment,f=to();return v.default.createElement(h,{...a?{unmount:o}:{}},f({ourProps:{ref:c,id:n,onClick:d},theirProps:i,slot:u,defaultTag:"div",name:"Dialog.Panel"}))}),Title:(td(function(e,t){let{transition:r=!1,...n}=e,[{dialogState:a,unmount:i}]=ro("Dialog.Backdrop"),s=(0,v.useMemo)(()=>({open:0===a}),[a]),o=r?rt:v.Fragment,l=to();return v.default.createElement(o,{...r?{unmount:i}:{}},l({ourProps:{ref:t,"aria-hidden":!0},theirProps:n,slot:s,defaultTag:"div",name:"Dialog.Backdrop"}))}),td(function(e,t){let r=(0,v.useId)(),{id:n="headlessui-dialog-title-".concat(r),...a}=e,[{dialogState:i,setTitleId:s}]=ro("Dialog.Title"),o=tk(t);(0,v.useEffect)(()=>(s(n),()=>s(null)),[n,s]);let l=(0,v.useMemo)(()=>({open:0===i}),[i]);return to()({ourProps:{ref:o,id:n},theirProps:a,slot:l,defaultTag:"h2",name:"Dialog.Title"})})),Description:tI}),rf=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))});function rg(e){let{isOpen:t,onClose:r}=e,[n,a]=(0,v.useState)({client:"",agency:"",invoice_id:"",approved:"ne",viaduct:!1,from:"",to:"",media_received:!1,final_price:0,invoice_sent:!1}),[i,s]=(0,v.useState)(!1),o=async e=>{e.preventDefault(),s(!0);try{console.log("Submitting order:",n),await new Promise(e=>setTimeout(e,1e3)),a({client:"",agency:"",invoice_id:"",approved:"ne",viaduct:!1,from:"",to:"",media_received:!1,final_price:0,invoice_sent:!1}),r()}catch(e){console.error("Failed to create order:",e)}finally{s(!1)}},l=(e,t)=>{a(r=>({...r,[e]:t}))};return(0,y.jsxs)(rh,{open:t,onClose:r,className:"relative z-50",children:[(0,y.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,y.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,y.jsxs)(rh.Panel,{className:"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-xl shadow-2xl",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,y.jsx)(rh.Title,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Pridėti naują užsakymą"}),(0,y.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,y.jsx)(rf,{className:"w-6 h-6"})})]}),(0,y.jsxs)("form",{onSubmit:o,className:"p-6 space-y-6",children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Klientas *"}),(0,y.jsx)("input",{type:"text",required:!0,value:n.client,onChange:e=>l("client",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"Įveskite kliento pavadinimą"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Agentūra"}),(0,y.jsx)("input",{type:"text",value:n.agency,onChange:e=>l("agency",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"Įveskite agentūros pavadinimą"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Užsakymo Nr. *"}),(0,y.jsx)("input",{type:"text",required:!0,value:n.invoice_id,onChange:e=>l("invoice_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"Įveskite užsakymo numerį"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Statusas *"}),(0,y.jsxs)("select",{required:!0,value:n.approved,onChange:e=>l("approved",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[(0,y.jsx)("option",{value:"ne",children:"Nepatvirtinta"}),(0,y.jsx)("option",{value:"taip",children:"Patvirtinta"}),(0,y.jsx)("option",{value:"rezervuota",children:"Rezervuota"}),(0,y.jsx)("option",{value:"atšaukta",children:"Atšaukta"})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data nuo *"}),(0,y.jsx)("input",{type:"date",required:!0,value:n.from,onChange:e=>l("from",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data iki *"}),(0,y.jsx)("input",{type:"date",required:!0,value:n.to,onChange:e=>l("to",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Galutinė kaina *"}),(0,y.jsx)("input",{type:"number",required:!0,step:"0.01",min:"0",value:n.final_price,onChange:e=>l("final_price",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"0.00"})]})]}),(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,y.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,y.jsx)("input",{type:"checkbox",checked:n.viaduct,onChange:e=>l("viaduct",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,y.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Viadukas"})]}),(0,y.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,y.jsx)("input",{type:"checkbox",checked:n.media_received,onChange:e=>l("media_received",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,y.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Medija gauta"})]}),(0,y.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,y.jsx)("input",{type:"checkbox",checked:n.invoice_sent,onChange:e=>l("invoice_sent",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,y.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Sąskaita išsiųsta"})]})]}),(0,y.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,y.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Atšaukti"}),(0,y.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Kuriama...":"Sukurti užsakymą"})]})]})]})})]})}let rp=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}),rm=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}),ry=v.forwardRef(function(e,t){let{title:r,titleId:n,...a}=e;return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?v.createElement("title",{id:n},r):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"}))});class rv extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class rb extends rv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class rw extends rv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class rx extends rv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(s||(s={}));class rk{setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){var t,r,n,a,i;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=this,n=void 0,a=void 0,i=function*(){try{let r,{headers:n,method:a,body:i}=s,o={},{region:l}=s;l||(l=this.region);let c=new URL("".concat(this.url,"/").concat(e));l&&"any"!==l&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l)),i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",r=i):"string"==typeof i?(o["Content-Type"]="text/plain",r=i):"undefined"!=typeof FormData&&i instanceof FormData?r=i:(o["Content-Type"]="application/json",r=JSON.stringify(i)));let u=yield this.fetch(c.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:r}).catch(e=>{throw new rb(e)}),d=u.headers.get("x-relay-error");if(d&&"true"===d)throw new rw(u);if(!u.ok)throw new rx(u);let h=(null!=(t=u.headers.get("Content-Type"))?t:"text/plain").split(";")[0].trim();return{data:"application/json"===h?yield u.json():"application/octet-stream"===h?yield u.blob():"text/event-stream"===h?u:"multipart/form-data"===h?yield u.formData():yield u.text(),error:null,response:u}}catch(e){return{data:null,error:e,response:e instanceof rx||e instanceof rw?e.context:void 0}}},new(a||(a=Promise))(function(e,t){function s(e){try{l(i.next(e))}catch(e){t(e)}}function o(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof a?r:new a(function(e){e(r)})).then(s,o)}l((i=i.apply(r,n||[])).next())})}constructor(t,{headers:r={},customFetch:n,region:a=s.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=(t=>{let r;return r=t||("undefined"==typeof fetch?function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.A(11737).then(e=>{let{default:t}=e;return t(...r)})}:fetch),function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(...t)}})(n)}}let{PostgrestClient:r_,PostgrestQueryBuilder:rj,PostgrestFilterBuilder:rS,PostgrestTransformBuilder:rE,PostgrestBuilder:rN,PostgrestError:rT}=e.i(82215).default,rC=class{static detectEnvironment(){var t;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==e.g.WebSocket)return{type:"native",constructor:e.g.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null==(t=navigator.userAgent)?void 0:t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(void 0!==w.default&&w.default.versions&&w.default.versions.node){let e=parseInt(w.default.versions.node.split(".")[0]);return e>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(e," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(e," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}},rP="realtime-js/".concat("2.15.1");!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(o||(o={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(l||(l={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(c||(c={})),(u||(u={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(d||(d={}));class rO{decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let n=t.getUint8(1),a=t.getUint8(2),i=this.HEADER_LENGTH+2,s=r.decode(e.slice(i,i+n));i+=n;let o=r.decode(e.slice(i,i+a));return i+=a,{ref:null,topic:s,event:o,payload:JSON.parse(r.decode(e.slice(i,e.byteLength)))}}constructor(){this.HEADER_LENGTH=1}}class rA{reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(h||(h={}));let rR=function(e,t){var r;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=null!=(r=n.skipTypes)?r:[];return Object.keys(t).reduce((r,n)=>(r[n]=rI(n,e,t,a),r),{})},rI=(e,t,r,n)=>{let a=t.find(t=>t.name===e),i=null==a?void 0:a.type,s=r[e];return i&&!n.includes(i)?rL(i,s):rM(s)},rL=(e,t)=>{if("_"===e.charAt(0))return rB(t,e.slice(1,e.length));switch(e){case h.bool:return rD(t);case h.float4:case h.float8:case h.int2:case h.int4:case h.int8:case h.numeric:case h.oid:return rU(t);case h.json:case h.jsonb:return rF(t);case h.timestamp:return rq(t);case h.abstime:case h.date:case h.daterange:case h.int4range:case h.int8range:case h.money:case h.reltime:case h.text:case h.time:case h.timestamptz:case h.timetz:case h.tsrange:case h.tstzrange:default:return rM(t)}},rM=e=>e,rD=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},rU=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},rF=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log("JSON parse error: ".concat(e))}return e},rB=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n,a=e.slice(1,r);try{n=JSON.parse("["+a+"]")}catch(e){n=a?a.split(","):[]}return n.map(e=>rL(t,e))}return e},rq=e=>"string"==typeof e?e.replace(" ","T"):e,rW=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")+"/api/broadcast"};class rz{resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null==(r=this.receivedResp)?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:r}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(f||(f={}));class rH{static syncState(e,t,r,n){let a=this.cloneDeep(e),i=this.transformState(t),s={},o={};return this.map(a,(e,t)=>{i[e]||(o[e]=t)}),this.map(i,(e,t)=>{let r=a[e];if(r){let n=t.map(e=>e.presence_ref),a=r.map(e=>e.presence_ref),i=t.filter(e=>0>a.indexOf(e.presence_ref)),l=r.filter(e=>0>n.indexOf(e.presence_ref));i.length>0&&(s[e]=i),l.length>0&&(o[e]=l)}else s[e]=t}),this.syncDiff(a,{joins:s,leaves:o},r,n)}static syncDiff(e,t,r,n){let{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(a,(t,n)=>{var a;let i=null!=(a=e[t])?a:[];if(e[t]=this.cloneDeep(n),i.length>0){let r=e[t].map(e=>e.presence_ref),n=i.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...n)}r(t,i,n)}),this.map(i,(t,r)=>{let a=e[t];if(!a)return;let i=r.map(e=>e.presence_ref);a=a.filter(e=>0>i.indexOf(e.presence_ref)),e[t]=a,n(t,a,r),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let n=e[r];return"metas"in n?t[r]=n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rH.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=rH.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=rH.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(g||(g={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(p||(p={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(m||(m={}));class rK{subscribe(e){var t,r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;if(this.socket.isConnected()||this.socket.connect(),this.state==l.closed){let{config:{broadcast:a,presence:i,private:s}}=this.params,o=null!=(r=null==(t=this.bindings.postgres_changes)?void 0:t.map(e=>e.filter))?r:[],c=!!this.bindings[p.PRESENCE]&&this.bindings[p.PRESENCE].length>0,u={},d={broadcast:a,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:o,private:s};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(m.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(m.CLOSED)),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async t=>{var r;let{postgres_changes:n}=t;if(this.socket.setAuth(),void 0===n){null==e||e(m.SUBSCRIBED);return}{let t=this.bindings.postgres_changes,a=null!=(r=null==t?void 0:t.length)?r:0,i=[];for(let r=0;r<a;r++){let a=t[r],{filter:{event:s,schema:o,table:c,filter:u}}=a,d=n&&n[r];if(d&&d.event===s&&d.schema===o&&d.table===c&&d.filter===u)i.push(Object.assign(Object.assign({},a),{id:d.id}));else{this.unsubscribe(),this.state=l.errored,null==e||e(m.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=i,e&&e(m.SUBSCRIBED);return}}).receive("error",t=>{this.state=l.errored,null==e||e(m.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(m.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===l.joined&&e===p.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e){var t,r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._canPush()||"broadcast"!==e.type)return new Promise(t=>{var r,a,i;let s=this._push(e.type,e,n.timeout||this.timeout);"broadcast"!==e.type||(null==(i=null==(a=null==(r=this.params)?void 0:r.config)?void 0:a.broadcast)?void 0:i.ack)||t("ok"),s.receive("ok",()=>t("ok")),s.receive("error",()=>t("error")),s.receive("timeout",()=>t("timed out"))});{let{event:a,payload:i}=e,s={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!=(t=n.timeout)?t:this.timeout);return await (null==(r=e.body)?void 0:r.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=l.leaving;let t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(c.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{(r=new rz(this,c.leave,{},e)).receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=l.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){let n=new AbortController,a=setTimeout(()=>n.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),i}_push(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let n=new rz(this,e,t,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,a;let i=e.toLocaleLowerCase(),{close:s,error:o,leave:l,join:u}=c;if(r&&[s,o,l,u].indexOf(i)>=0&&r!==this._joinRef())return;let d=this._onMessage(i,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null==(n=this.bindings.postgres_changes)||n.filter(e=>{var t,r,n;return(null==(t=e.filter)?void 0:t.event)==="*"||(null==(n=null==(r=e.filter)?void 0:r.event)?void 0:n.toLocaleLowerCase())===i}).map(e=>e.callback(d,r)):null==(a=this.bindings[i])||a.filter(e=>{var r,n,a,s,o,l;if(!["broadcast","presence","postgres_changes"].includes(i))return e.type.toLocaleLowerCase()===i;if("id"in e){let i=e.id,s=null==(r=e.filter)?void 0:r.event;return i&&(null==(n=t.ids)?void 0:n.includes(i))&&("*"===s||(null==s?void 0:s.toLocaleLowerCase())===(null==(a=t.data)?void 0:a.type.toLocaleLowerCase()))}{let r=null==(o=null==(s=null==e?void 0:e.filter)?void 0:s.event)?void 0:o.toLocaleLowerCase();return"*"===r||r===(null==(l=null==t?void 0:t.event)?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof d&&"ids"in d){let e=d.data,{schema:t,table:r,commit_timestamp:n,type:a,errors:i}=e;d=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:n,eventType:a,new:{},old:{},errors:i}),this._getPayloadRecords(e))}e.callback(d,r)})}_isClosed(){return this.state===l.closed}_isJoined(){return this.state===l.joined}_isJoining(){return this.state===l.joining}_isLeaving(){return this.state===l.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,r){let n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null==(n=e.type)?void 0:n.toLocaleLowerCase())===r&&rK.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(c.close,{},e)}_onError(e){this._on(c.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=l.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=rR(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=rR(e.columns,e.old_record)),t}constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=l.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new rz(this,c.join,this.params,this.timeout),this.rejoinTimer=new rA(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=l.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=l.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=l.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=l.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=l.errored,this.rejoinTimer.scheduleTimeout())}),this._on(c.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new rH(this),this.broadcastEndpointURL=rW(this.socket.endPoint),this.private=this.params.config.private||!1}}let rG=()=>{},rV={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},rJ=[1e3,2e3,5e3,1e4];class rY{connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rC.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;if(e.includes("Node.js"))throw Error("".concat(e,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw Error("WebSocket not available: ".concat(e))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case o.connecting:return d.Connecting;case o.open:return d.Open;case o.closing:return d.Closing;default:return d.Closed}}isConnected(){return this.connectionState()===d.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},r="realtime:".concat(e),n=this.getChannels().find(e=>e.topic===r);if(n)return n;{let r=new rK("realtime:".concat(e),t,this);return this.channels.push(r),r}}push(e){let{topic:t,event:r,payload:n,ref:a}=e,i=()=>{this.encode(e,e=>{var t;null==(t=this.conn)||t.send(e)})};this.log("push","".concat(t," ").concat(r," (").concat(a,")"),n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected())return void this.heartbeatCallback("disconnected");if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,null==(e=this.conn)||e.close(1e3,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||null==(e=this.reconnectTimer)||e.scheduleTimeout()},rV.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{"phoenix"===e.topic&&"phx_reply"===e.event&&this.heartbeatCallback("ok"===e.payload.status?"ok":"error"),e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:t,event:r,payload:n,ref:a}=e,i=n.status||"";this.log("receive","".concat(i," ").concat(t," ").concat(r," ").concat(a?"(".concat(a,")"):"").trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null==(t=this.reconnectTimer)||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(t=this.reconnectTimer)||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(c.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return"".concat(e).concat(r).concat(n)}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=t||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e,version:rP}),t.joinedOnce&&t._isJoined()&&t._push(c.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this.setAuth().catch(t=>{this.log("error","error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(t){this.log("error","error in ".concat(e," callback"),t)}})}catch(t){this.log("error","error triggering ".concat(e," callbacks"),t)}}_setupReconnectionTimer(){this.reconnectTimer=new rA(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},rV.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,n,a,i,s,o,l;if(this.transport=null!=(t=null==e?void 0:e.transport)?t:null,this.timeout=null!=(r=null==e?void 0:e.timeout)?r:1e4,this.heartbeatIntervalMs=null!=(n=null==e?void 0:e.heartbeatIntervalMs)?n:rV.HEARTBEAT_INTERVAL,this.worker=null!=(a=null==e?void 0:e.worker)&&a,this.accessToken=null!=(i=null==e?void 0:e.accessToken)?i:null,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(s=null==e?void 0:e.reconnectAfterMs)?s:e=>rJ[e-1]||1e4,this.encode=null!=(o=null==e?void 0:e.encode)?o:(e,t)=>t(JSON.stringify(e)),this.decode=null!=(l=null==e?void 0:e.decode)?l:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=rV.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=rG,this.ref=0,this.reconnectTimer=null,this.logger=rG,this.conn=null,this.sendBuffer=[],this.serializer=new rO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=t=>{let r;return r=t||("undefined"==typeof fetch?function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.A(11737).then(e=>{let{default:t}=e;return t(...r)}).catch(e=>{throw Error("Failed to load @supabase/node-fetch: ".concat(e.message,". ")+"This is required for HTTP requests in Node.js environments without native fetch.")})}:fetch),function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(...t)}},!(null==(n=null==r?void 0:r.params)?void 0:n.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint="".concat(t,"/").concat(u.websocket),this.httpEndpoint=rW(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==r?void 0:r.fetch)}}var rQ=e.i(67034);class rX extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function r$(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class rZ extends rX{toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}}class r0 extends rX{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let r1=t=>{let r;return r=t||("undefined"==typeof fetch?function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.A(11737).then(e=>{let{default:t}=e;return t(...r)})}:fetch),function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(...t)}},r2=e=>{if(Array.isArray(e))return e.map(e=>r2(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(e=>{let[r,n]=e;t[r.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=r2(n)}),t};var r5=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};let r3=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e);function r6(t,r,n,a,i,s){return r5(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,((e,t,r,n)=>{let a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&n?((e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(n)?(a.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,(null==t?void 0:t.duplex)&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r)):a})(r,a,i,s)).then(e=>{if(!e.ok)throw e;return(null==a?void 0:a.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(t=>r5(void 0,void 0,void 0,function*(){var r,n,i,s;let o=yield(r=void 0,n=void 0,i=void 0,s=function*(){return"undefined"==typeof Response?(yield e.A(11737)).Response:Response},new(i||(i=Promise))(function(e,t){function a(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(a,o)}l((s=s.apply(r,n||[])).next())}));t instanceof o&&!(null==a?void 0:a.noResolveJson)?t.json().then(e=>{let r=t.status||500,n=(null==e?void 0:e.statusCode)||r+"";l(new rZ(r3(e),r,n))}).catch(e=>{l(new r0(r3(e),e))}):l(new r0(r3(t),t))}))})})}function r4(e,t,r,n){return r5(this,void 0,void 0,function*(){return r6(e,"GET",t,r,n)})}function r8(e,t,r,n,a){return r5(this,void 0,void 0,function*(){return r6(e,"POST",t,n,a,r)})}function r7(e,t,r,n,a){return r5(this,void 0,void 0,function*(){return r6(e,"PUT",t,n,a,r)})}function r9(e,t,r,n,a){return r5(this,void 0,void 0,function*(){return r6(e,"DELETE",t,n,a,r)})}var ne=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};let nt={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class nn{uploadOrUpdate(e,t,r,n){return ne(this,void 0,void 0,function*(){try{let a,i=Object.assign(Object.assign({},nr),n),s=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)}),o=i.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((a=new FormData).append("cacheControl",i.cacheControl),o&&a.append("metadata",this.encodeMetadata(o)),a.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((a=r).append("cacheControl",i.cacheControl),o&&a.append("metadata",this.encodeMetadata(o))):(a=r,s["cache-control"]="max-age=".concat(i.cacheControl),s["content-type"]=i.contentType,o&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==n?void 0:n.headers)&&(s=Object.assign(Object.assign({},s),n.headers));let l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield("PUT"==e?r7:r8)(this.fetch,"".concat(this.url,"/object/").concat(c),a,Object.assign({headers:s},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{data:{path:l,id:u.Id,fullPath:u.Key},error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}upload(e,t,r){return ne(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return ne(this,void 0,void 0,function*(){let a=this._removeEmptyFolders(e),i=this._getFinalPath(a),s=new URL(this.url+"/object/upload/sign/".concat(i));s.searchParams.set("token",t);try{let e,t=Object.assign({upsert:nr.upsert},n),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,i["cache-control"]="max-age=".concat(t.cacheControl),i["content-type"]=t.contentType);let o=yield r7(this.fetch,s.toString(),e,{headers:i});return{data:{path:a,fullPath:o.Key},error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return ne(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");let a=yield r8(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(r),{},{headers:n}),i=new URL(this.url+a.url),s=i.searchParams.get("token");if(!s)throw new rX("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:s},error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}update(e,t,r){return ne(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return ne(this,void 0,void 0,function*(){try{return{data:yield r8(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}copy(e,t,r){return ne(this,void 0,void 0,function*(){try{return{data:{path:(yield r8(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return ne(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield r8(this.fetch,"".concat(this.url,"/object/sign/").concat(n),Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),i=(null==r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return{data:a={signedUrl:encodeURI("".concat(this.url).concat(a.signedURL).concat(i))},error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return ne(this,void 0,void 0,function*(){try{let n=yield r8(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),a=(null==r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(a)):null})),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}download(e,t){return ne(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});try{let t=this._getFinalPath(e),a=yield r4(this.fetch,"".concat(this.url,"/").concat(r?"render/image/authenticated":"object","/").concat(t).concat(n?"?".concat(n):""),{headers:this.headers,noResolveJson:!0});return{data:yield a.blob(),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}info(e){return ne(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield r4(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:r2(e),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}exists(e){return ne(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,r,n){return r5(this,void 0,void 0,function*(){return r6(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),void 0)})}(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(e){if(r$(e)&&e instanceof r0){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),n=[],a=(null==t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==a&&n.push(a);let i=void 0!==(null==t?void 0:t.transform),s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==s&&n.push(s);let o=n.join("&");return""!==o&&(o="?".concat(o)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(i?"render/image":"object","/public/").concat(r).concat(o))}}}remove(e){return ne(this,void 0,void 0,function*(){try{return{data:yield r9(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}list(e,t,r){return ne(this,void 0,void 0,function*(){try{let n=Object.assign(Object.assign(Object.assign({},nt),t),{prefix:e||""});return{data:yield r8(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),n,{headers:this.headers},r),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}listV2(e,t){return ne(this,void 0,void 0,function*(){try{let r=Object.assign({},e);return{data:yield r8(this.fetch,"".concat(this.url,"/object/list-v2/").concat(this.bucketId),r,{headers:this.headers},t),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==rQ.Buffer?rQ.Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=r1(n)}}let na={"X-Client-Info":"storage-js/".concat("2.11.0")};var ni=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};class ns{listBuckets(){return ni(this,void 0,void 0,function*(){try{return{data:yield r4(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}getBucket(e){return ni(this,void 0,void 0,function*(){try{return{data:yield r4(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return ni(this,void 0,void 0,function*(){try{return{data:yield r8(this.fetch,"".concat(this.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return ni(this,void 0,void 0,function*(){try{return{data:yield r7(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}emptyBucket(e){return ni(this,void 0,void 0,function*(){try{return{data:yield r8(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}deleteBucket(e){return ni(this,void 0,void 0,function*(){try{return{data:yield r9(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(e){if(r$(e))return{data:null,error:e};throw e}})}constructor(e,t={},r,n){let a=new URL(e);(null==n?void 0:n.useNewHostname)&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},na),t),this.fetch=r1(r)}}class no extends ns{from(e){return new nn(this.url,this.headers,e,this.fetch)}constructor(e,t={},r,n){super(e,t,r,n)}}let nl="";nl="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let nc={headers:{"X-Client-Info":"supabase-js-".concat(nl,"/").concat("2.56.0")}},nu={schema:"public"},nd={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},nh={};var nf=e.i(6085);let ng="2.71.1",np="X-Supabase-Api-Version",nm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ny=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class nv extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function nb(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class nw extends nv{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class nx extends nv{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class nk extends nv{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class n_ extends nk{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class nj extends nk{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class nS extends nk{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class nE extends nk{toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}}class nN extends nk{toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}}class nT extends nk{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function nC(e){return nb(e)&&"AuthRetryableFetchError"===e.name}class nP extends nk{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class nO extends nk{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let nA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),nR=" 	\n\r=".split(""),nI=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<nR.length;t+=1)e[nR[t].charCodeAt(0)]=-2;for(let t=0;t<nA.length;t+=1)e[nA[t].charCodeAt(0)]=t;return e})();function nL(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)r(nA[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)r(nA[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function nM(e,t,r){let n=nI[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===n)return;else throw Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}function nD(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return r(e);for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let t=0;t<e.length;t+=1)nM(e.charCodeAt(t),a,i);return t.join("")}let nU=()=>"undefined"!=typeof window&&"undefined"!=typeof document,nF={tested:!1,writable:!1},nB=()=>{if(!nU())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(nF.tested)return nF.writable;let e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),nF.tested=!0,nF.writable=!0}catch(e){nF.tested=!0,nF.writable=!1}return nF.writable},nq=t=>{let r;return r=t||("undefined"==typeof fetch?function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.A(11737).then(e=>{let{default:t}=e;return t(...r)})}:fetch),function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(...t)}},nW=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},nz=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},nH=async(e,t)=>{await e.removeItem(t)};class nK{constructor(){this.promise=new nK.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function nG(e){let t=e.split(".");if(3!==t.length)throw new nO("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!ny.test(t[e]))throw new nO("JWT not in base64url format");return{header:JSON.parse(nD(t[0])),payload:JSON.parse(nD(t[1])),signature:function(e){let t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)nM(e.charCodeAt(t),r,n);return new Uint8Array(t)}(t[2]),raw:{header:t[0],payload:t[1]}}}async function nV(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function nJ(e){return("0"+e.toString(16)).substr(-2)}async function nY(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function nQ(e){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e):btoa(await nY(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function nX(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,nJ).join("")}(),a=n;r&&(a+="/PASSWORD_RECOVERY"),await nW(e,"".concat(t,"-code-verifier"),a);let i=await nQ(n),s=n===i?"plain":"s256";return[i,s]}nK.promiseConstructor=Promise;let n$=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,nZ=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function n0(e){if(!nZ.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function n1(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function n2(e){return JSON.parse(JSON.stringify(e))}var n5=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)0>t.indexOf(n[a])&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};let n3=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),n6=[502,503,504];async function n4(e){var t;let r,n;if(!("object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json))throw new nT(n3(e),0);if(n6.includes(e.status))throw new nT(n3(e),e.status);try{r=await e.json()}catch(e){throw new nx(n3(e),e)}let a=function(e){let t=e.headers.get(np);if(!t||!t.match(n$))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(e){return null}}(e);if(a&&a.getTime()>=nm["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new nP(n3(r),e.status,(null==(t=r.weak_password)?void 0:t.reasons)||[]);else if("session_not_found"===n)throw new n_}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new nP(n3(r),e.status,r.weak_password.reasons);throw new nw(n3(r),e.status||500,n)}async function n8(e,t,r,n){var a;let i=Object.assign({},null==n?void 0:n.headers);i[np]||(i[np]=nm["2024-01-01"].name),(null==n?void 0:n.jwt)&&(i.Authorization="Bearer ".concat(n.jwt));let s=null!=(a=null==n?void 0:n.query)?a:{};(null==n?void 0:n.redirectTo)&&(s.redirect_to=n.redirectTo);let o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await n7(e,t,r+o,{headers:i,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function n7(e,t,r,n,a,i){let s,o=((e,t,r,n)=>{let a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))})(t,n,a,i);try{s=await e(r,Object.assign({},o))}catch(e){throw console.error(e),new nT(n3(e),0)}if(s.ok||await n4(s),null==n?void 0:n.noResolveJson)return s;try{return await s.json()}catch(e){await n4(e)}}function n9(e){var t,r,n;let a=null;(n=e).access_token&&n.refresh_token&&n.expires_in&&(a=Object.assign({},e),e.expires_at||(a.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:a,user:null!=(t=e.user)?t:e},error:null}}function ae(e){let t=n9(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function at(e){var t;return{data:{user:null!=(t=e.user)?t:e},error:null}}function ar(e){return{data:e,error:null}}function an(e){let{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},user:Object.assign({},n5(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function aa(e){return e}let ai=["global","local","others"];var as=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)0>t.indexOf(n[a])&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class ao{async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ai[0];if(0>ai.indexOf(t))throw Error("@supabase/auth-js: Parameter scope must be one of ".concat(ai.join(", ")));try{return await n8(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(nb(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await n8(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:at})}catch(e){if(nb(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=as(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await n8(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:n,headers:this.headers,xform:an,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(nb(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await n8(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:at})}catch(e){if(nb(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,n,a,i,s,o;try{let l={nextPage:null,lastPage:0,total:0},c=await n8(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(a=null==(n=null==e?void 0:e.perPage)?void 0:n.toString())?a:""},xform:aa});if(c.error)throw c.error;let u=await c.json(),d=null!=(i=c.headers.get("x-total-count"))?i:0,h=null!=(o=null==(s=c.headers.get("link"))?void 0:s.split(","))?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(r,"Page")]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(e){if(nb(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){n0(e);try{return await n8(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:at})}catch(e){if(nb(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){n0(e);try{return await n8(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:at})}catch(e){if(nb(e))return{data:{user:null},error:e};throw e}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n0(e);try{return await n8(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:at})}catch(e){if(nb(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){n0(e.userId);try{let{data:t,error:r}=await n8(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(nb(e))return{data:null,error:e};throw e}}async _deleteFactor(e){n0(e.userId),n0(e.id);try{return{data:await n8(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(e){if(nb(e))return{data:null,error:e};throw e}}constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=nq(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}}function al(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let ac={debug:!!(globalThis&&nB()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class au extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ad extends au{}async function ah(e,t,r){ac.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),ac.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(n){ac.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{ac.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}if(0===t)throw ac.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ad('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(ac.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}))}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}let af={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:{"X-Client-Info":"gotrue-js/".concat(ng)},flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ag(e,t,r){return await r()}let ap={};class am{get jwks(){var e,t;return null!=(t=null==(e=ap[this.storageKey])?void 0:e.jwks)?t:{keys:[]}}set jwks(e){ap[this.storageKey]=Object.assign(Object.assign({},ap[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!=(t=null==(e=ap[this.storageKey])?void 0:e.cachedAt)?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ap[this.storageKey]=Object.assign(Object.assign({},ap[this.storageKey]),{cachedAt:e})}_debug(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.logDebugMessages&&this.logger("GoTrueClient@".concat(this.instanceID," (").concat(ng,") ").concat(new Date().toISOString()),...t),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),nU()&&this.detectSessionInUrl&&"none"!==r){let{data:n,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),nb(a)&&"AuthImplicitGrantRedirectError"===a.name){let t=null==(e=a.details)?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}let{session:i,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",s),await this._saveSession(i),setTimeout(async()=>{"recovery"===s?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(nb(e))return{error:e};return{error:new nx("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{let{data:a,error:i}=await n8(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!=(r=null==(t=null==e?void 0:e.options)?void 0:t.data)?r:{},gotrue_meta_security:{captcha_token:null==(n=null==e?void 0:e.options)?void 0:n.captchaToken}},xform:n9});if(i||!a)return{data:{user:null,session:null},error:i};let s=a.session,o=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:o,session:s},error:null}}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,n;try{let a;if("email"in e){let{email:r,password:n,options:i}=e,s=null,o=null;"pkce"===this.flowType&&([s,o]=await nX(this.storage,this.storageKey)),a=await n8(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:n,data:null!=(t=null==i?void 0:i.data)?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:s,code_challenge_method:o},xform:n9})}else if("phone"in e){let{phone:t,password:i,options:s}=e;a=await n8(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:i,data:null!=(r=null==s?void 0:s.data)?r:{},channel:null!=(n=null==s?void 0:s.channel)?n:"sms",gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:n9})}else throw new nS("You must provide either an email or phone number and a password");let{data:i,error:s}=a;if(s||!i)return{data:{user:null,session:null},error:s};let o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:n,options:a}=e;t=await n8(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:ae})}else if("phone"in e){let{phone:r,password:n,options:a}=e;t=await n8(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:ae})}else throw new nS("You must provide either an email or phone number and a password");let{data:r,error:n}=t;if(n)return{data:{user:null,session:null},error:n};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new nj};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null==(t=e.options)?void 0:t.redirectTo,scopes:null==(r=e.options)?void 0:r.scopes,queryParams:null==(n=e.options)?void 0:n.queryParams,skipBrowserRedirect:null==(a=e.options)?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}async signInWithSolana(e){var t,r,n,a,i,s,o,l,c,u,d,h;let f,g;if("message"in e)f=e.message,g=e.signature;else{let d,{chain:h,wallet:p,statement:m,options:y}=e;if(nU())if("object"==typeof p)d=p;else{let e=window;if("solana"in e&&"object"==typeof e.solana&&("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))d=e.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof p||!(null==y?void 0:y.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");d=p}let v=new URL(null!=(t=null==y?void 0:y.url)?t:window.location.href);if("signIn"in d&&d.signIn){let e,t=await d.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==y?void 0:y.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),m?{statement:m}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)f="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),g=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in d)||"function"!=typeof d.signMessage||!("publicKey"in d)||"object"!=typeof d||!d.publicKey||!("toBase58"in d.publicKey)||"function"!=typeof d.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=["".concat(v.host," wants you to sign in with your Solana account:"),d.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1","URI: ".concat(v.href),"Issued At: ".concat(null!=(n=null==(r=null==y?void 0:y.signInWithSolana)?void 0:r.issuedAt)?n:new Date().toISOString()),...(null==(a=null==y?void 0:y.signInWithSolana)?void 0:a.notBefore)?["Not Before: ".concat(y.signInWithSolana.notBefore)]:[],...(null==(i=null==y?void 0:y.signInWithSolana)?void 0:i.expirationTime)?["Expiration Time: ".concat(y.signInWithSolana.expirationTime)]:[],...(null==(s=null==y?void 0:y.signInWithSolana)?void 0:s.chainId)?["Chain ID: ".concat(y.signInWithSolana.chainId)]:[],...(null==(o=null==y?void 0:y.signInWithSolana)?void 0:o.nonce)?["Nonce: ".concat(y.signInWithSolana.nonce)]:[],...(null==(l=null==y?void 0:y.signInWithSolana)?void 0:l.requestId)?["Request ID: ".concat(y.signInWithSolana.requestId)]:[],...(null==(u=null==(c=null==y?void 0:y.signInWithSolana)?void 0:c.resources)?void 0:u.length)?["Resources",...y.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");let e=await d.signMessage(new TextEncoder().encode(f),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=e}}try{let{data:t,error:r}=await n8(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:function(e){let t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>nL(e,r,n)),nL(null,r,n),t.join("")}(g)},(null==(d=e.options)?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null==(h=e.options)?void 0:h.captchaToken}}:null),xform:n9});if(r)throw r;if(!t||!t.session||!t.user)return{data:{user:null,session:null},error:new nj};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async _exchangeCodeForSession(e){let t=await nz(this.storage,"".concat(this.storageKey,"-code-verifier")),[r,n]=(null!=t?t:"").split("/");try{let{data:t,error:a}=await n8(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:n9});if(await nH(this.storage,"".concat(this.storageKey,"-code-verifier")),a)throw a;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new nj};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:a}}catch(e){if(nb(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:n,access_token:a,nonce:i}=e,{data:s,error:o}=await n8(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:r,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:n9});if(o)return{data:{user:null,session:null},error:o};if(!s||!s.session||!s.user)return{data:{user:null,session:null},error:new nj};return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:o}}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,n,a,i;try{if("email"in e){let{email:n,options:a}=e,i=null,s=null;"pkce"===this.flowType&&([i,s]=await nX(this.storage,this.storageKey));let{error:o}=await n8(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:n,data:null!=(t=null==a?void 0:a.data)?t:{},create_user:null==(r=null==a?void 0:a.shouldCreateUser)||r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:i,code_challenge_method:s},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:r}=e,{data:s,error:o}=await n8(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!=(n=null==r?void 0:r.data)?n:{},create_user:null==(a=null==r?void 0:r.shouldCreateUser)||a,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!=(i=null==r?void 0:r.channel)?i:"sms"}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:o}}throw new nS("You must provide either an email or phone number.")}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let n,a;"options"in e&&(n=null==(t=e.options)?void 0:t.redirectTo,a=null==(r=e.options)?void 0:r.captchaToken);let{data:i,error:s}=await n8(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:n9});if(s)throw s;if(!i)throw Error("An error occurred on token verification.");let o=i.session,l=i.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,n;try{let a=null,i=null;return"pkce"===this.flowType&&([a,i]=await nX(this.storage,this.storageKey)),await n8(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!=(r=null==(t=e.options)?void 0:t.redirectTo)?r:void 0}),(null==(n=null==e?void 0:e.options)?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:ar})}catch(e){if(nb(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new n_;let{error:n}=await n8(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t="".concat(this.url,"/resend");if("email"in e){let{email:r,type:n,options:a}=e,{error:i}=await n8(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){let{phone:r,type:n,options:a}=e,{data:i,error:s}=await n8(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:s}}throw new nS("You must provide either an email or phone number and a type")}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await nz(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()","session has".concat(r?"":" not"," expired"),"expires_at",e.expires_at),!r){if(this.userStorage){let t=await nz(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=n1()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}let{session:n,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{session:null},error:a};return{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await n8(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:at});return await this._useSession(async e=>{var t,r,n;let{data:a,error:i}=e;if(i)throw i;return(null==(t=a.session)?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await n8(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!=(n=null==(r=a.session)?void 0:r.access_token)?n:void 0,xform:at}):{data:{user:null},error:new n_}})}catch(e){if(nb(e))return nb(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await nH(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:e};throw e}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async r=>{let{data:n,error:a}=r;if(a)throw a;if(!n.session)throw new n_;let i=n.session,s=null,o=null;"pkce"===this.flowType&&null!=e.email&&([s,o]=await nX(this.storage,this.storageKey));let{data:l,error:c}=await n8(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:o}),jwt:i.access_token,xform:at});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(e){if(nb(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new n_;let t=Date.now()/1e3,r=t,n=!0,a=null,{payload:i}=nG(e.access_token);if(i.exp&&(n=(r=i.exp)<=t),n){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};a=t}else{let{data:n,error:i}=await this._getUser(e.access_token);if(i)throw i;a={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(e){if(nb(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:n,error:a}=t;if(a)throw a;e=null!=(r=n.session)?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new n_;let{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(nb(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!nU())throw new nE("No browser detected.");if(e.error||e.error_description||e.error_code)throw new nE(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new nN("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new nE("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new nN("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:s,expires_at:o,token_type:l}=e;if(!a||!s||!i||!l)throw new nE("No session defined in URL");let c=Math.round(Date.now()/1e3),u=parseInt(s),d=c+u;o&&(d=parseInt(o));let h=d-c;1e3*h<=3e4&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(u,"s"));let f=d-u;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,d,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,d,c);let{data:g,error:p}=await this._getUser(a);if(p)throw p;let m={provider_token:r,provider_refresh_token:n,access_token:a,expires_in:u,expires_at:d,refresh_token:i,token_type:l,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(e){if(nb(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await nz(this.storage,"".concat(this.storageKey,"-code-verifier"));return!!(e.code&&t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var r;let{data:n,error:a}=t;if(a)return{error:a};let i=null==(r=n.session)?void 0:r.access_token;if(i){let{error:t}=await this.admin.signOut(i,e);if(t&&!(nb(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await nH(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{let{data:{session:n},error:a}=t;if(a)throw a;await (null==(r=this.stateChangeEmitters.get(e))?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(t){await (null==(n=this.stateChangeEmitters.get(e))?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,n=null;"pkce"===this.flowType&&([r,n]=await nX(this.storage,this.storageKey,!0));try{return await n8(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(nb(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!=(e=t.user.identities)?e:[]},error:null}}catch(e){if(nb(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:r,error:n}=await this._useSession(async t=>{var r,n,a,i,s;let{data:o,error:l}=t;if(l)throw l;let c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null==(r=e.options)?void 0:r.redirectTo,scopes:null==(n=e.options)?void 0:n.scopes,queryParams:null==(a=e.options)?void 0:a.queryParams,skipBrowserRedirect:!0});return await n8(this.fetch,"GET",c,{headers:this.headers,jwt:null!=(s=null==(i=o.session)?void 0:i.access_token)?s:void 0})});if(n)throw n;return!nU()||(null==(t=e.options)?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(nb(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;let{data:a,error:i}=t;if(i)throw i;return await n8(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!=(n=null==(r=a.session)?void 0:r.access_token)?n:void 0})})}catch(e){if(nb(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{var r,n;let a=Date.now();return await (r=async r=>(r>0&&await nV(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await n8(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:n9})),n=(e,t)=>{let r=200*Math.pow(2,e);return t&&nC(t)&&Date.now()+r-a<3e4},new Promise((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{let t=await r(a);if(!n(a,null,t))return void e(t)}catch(e){if(!n(a,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),nb(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),nU()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let n=await nz(this.storage,this.storageKey);if(n&&this.userStorage){let t=await nz(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:n.user},await nW(this.userStorage,this.storageKey+"-user",t)),n.user=null!=(e=null==t?void 0:t.user)?e:n1()}else if(n&&!n.user&&!n.user){let e=await nz(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(n.user=e.user,await nH(this.storage,this.storageKey+"-user"),await nW(this.storage,this.storageKey,n)):n.user=n1()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),null!==n&&await this._removeSession();return}let a=(null!=(t=n.expires_at)?t:1/0)*1e3-Date.now()<9e4;if(this._debug(r,"session has".concat(a?"":" not"," expired with margin of ").concat(9e4,"s")),a){if(this.autoRefreshToken&&n.refresh_token){let{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),nC(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(n.user&&!0===n.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(n.access_token);!t&&(null==e?void 0:e.user)?(n.user=e.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(r,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(e){this._debug(r,"error",e),console.error(e);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new n_;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(n,"begin");try{this.refreshingDeferred=new nK;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new n_;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(e){if(this._debug(n,"error",e),nb(e)){let r={session:null,error:e};return nC(e)||await this._removeSession(),null==(t=this.refreshingDeferred)||t.resolve(r),r}throw null==(r=this.refreshingDeferred)||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n="#_notifyAllSubscribers(".concat(e,")");this._debug(n,"begin",t,"broadcast = ".concat(r));try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let n=[],a=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){n.push(e)}});if(await Promise.all(a),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;let t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await nW(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let n=n2(e);await nW(this.storage,this.storageKey,n)}else{let e=n2(t);await nW(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await nH(this.storage,this.storageKey),await nH(this.storage,this.storageKey+"-code-verifier"),await nH(this.storage,this.storageKey+"-user"),this.userStorage&&await nH(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&nU()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let n=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(n," ticks, a tick lasts ").concat(3e4,"ms, refresh threshold is ").concat(3," ticks")),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof au)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!nU()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState)return void this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let n=["provider=".concat(encodeURIComponent(t))];if((null==r?void 0:r.redirectTo)&&n.push("redirect_to=".concat(encodeURIComponent(r.redirectTo))),(null==r?void 0:r.scopes)&&n.push("scopes=".concat(encodeURIComponent(r.scopes))),"pkce"===this.flowType){let[e,t]=await nX(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});n.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push("skip_http_redirect=".concat(r.skipBrowserRedirect)),"".concat(e,"?").concat(n.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:n,error:a}=t;return a?{data:null,error:a}:await n8(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token})})}catch(e){if(nb(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;let{data:a,error:i}=t;if(i)return{data:null,error:i};let s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await n8(this.fetch,"POST","".concat(this.url,"/factors"),{body:s,headers:this.headers,jwt:null==(r=null==a?void 0:a.session)?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null==(n=null==o?void 0:o.totp)?void 0:n.qr_code)&&(o.totp.qr_code="data:image/svg+xml;utf-8,".concat(o.totp.qr_code)),{data:o,error:null})})}catch(e){if(nb(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:a}=t;if(a)return{data:null,error:a};let{data:i,error:s}=await n8(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:s})})}catch(e){if(nb(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:a}=t;return a?{data:null,error:a}:await n8(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:{channel:e.channel},headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token})})}catch(e){if(nb(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],n=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),a=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:i}=nG(n.access_token),s=null;i.aal&&(s=i.aal);let o=s;return(null!=(r=null==(t=n.user.factors)?void 0:t.filter(e=>"verified"===e.status))?r:[]).length>0&&(o="aal2"),{data:{currentLevel:s,nextLevel:o,currentAuthenticationMethods:i.amr||[]},error:null}}))}async fetchJwk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]},r=t.keys.find(t=>t.kid===e);if(r)return r;let n=Date.now();if((r=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>n)return r;let{data:a,error:i}=await n8(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(i)throw i;return a.keys&&0!==a.keys.length&&(this.jwks=a,this.jwks_cached_at=n,r=a.keys.find(t=>t.kid===e))?r:null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=e;if(!r){let{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}let{header:n,payload:a,signature:i,raw:{header:s,payload:o}}=nG(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(a.exp);let l=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!l){let{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:a,header:n,signature:i},error:null}}let c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(n.alg),u=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,u,i,function(e){let t=[];return!function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){let t=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}(n,t)}}(e,e=>t.push(e)),new Uint8Array(t)}("".concat(s,".").concat(o))))throw new nO("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(e){if(nb(e))return{data:null,error:e};throw e}}constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=am.nextInstanceID,am.nextInstanceID+=1,this.instanceID>0&&nU()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let n=Object.assign(Object.assign({},af),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new ao({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=nq(n.fetch),this.lock=n.lock||ag,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:nU()&&(null==(t=null==globalThis?void 0:globalThis.navigator)?void 0:t.locks)?this.lock=ah:this.lock=ag,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:nB()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=al(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=al(this.memoryStorage)),nU()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null==(r=this.broadcastChannel)||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}}am.nextInstanceID=0;let ay=am;class av extends ay{constructor(e){super(e)}}(function(){if("undefined"!=typeof window||void 0===w.default)return!1;let e=w.default.version;if(null==e)return!1;let t=e.match(/^v(\d+)\./);return!!t&&18>=parseInt(t[1],10)})()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");let ab=x.supabase.url,aw=x.supabase.anonKey;if(!ab||!aw)throw Error("Missing Supabase environment variables");let ax=new class e{get functions(){return new rk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,r)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,n,a,i;return r=this,n=void 0,a=void 0,i=function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return null!=(t=null==(e=r.session)?void 0:e.access_token)?t:this.supabaseKey},new(a||(a=Promise))(function(e,t){function s(e){try{l(i.next(e))}catch(e){t(e)}}function o(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof a?r:new a(function(e){e(r)})).then(s,o)}l((i=i.apply(r,n||[])).next())})}_initSupabaseAuthClient(e,t,r){let{autoRefreshToken:n,persistSession:a,detectSessionInUrl:i,storage:s,storageKey:o,flowType:l,lock:c,debug:u}=e,d={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new av({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),t),storageKey:o,autoRefreshToken:n,persistSession:a,detectSessionInUrl:i,storage:s,flowType:l,lock:c,debug:u,fetch:r,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new rY(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?this.changedAccessToken=r:"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}constructor(e,t,r){var n,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let s=new URL(function(e){return e.endsWith("/")?e:e+"/"}(e));this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);let o="sb-".concat(s.hostname.split(".")[0],"-auth-token"),l=function(e,t){var r,n;let{db:a,auth:i,realtime:s,global:o}=e,{db:l,auth:c,realtime:u,global:d}=t,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),s),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},null!=(r=null==d?void 0:d.headers)?r:{}),null!=(n=null==o?void 0:o.headers)?n:{})}),accessToken:()=>{var e,t,r,n;return e=this,t=void 0,n=function*(){return""},new(r=void 0,r=Promise)(function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})}};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=r?r:{},{db:nu,realtime:nh,auth:Object.assign(Object.assign({},nd),{storageKey:o}),global:nc});this.storageKey=null!=(n=l.auth.storageKey)?n:"",this.headers=null!=(a=l.global.headers)?a:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!=(i=l.auth)?i:{},this.headers,l.global.fetch),this.fetch=((e,t,r)=>{let n=(e=>{let t;return t=e||("undefined"==typeof fetch?nf.default:fetch),function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t(...r)}})(r),a="undefined"==typeof Headers?nf.Headers:Headers;return(r,i)=>(function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){var s;let o=null!=(s=yield t())?s:e,l=new a(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(o)),n(r,Object.assign(Object.assign({},i),{headers:l}))})})(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new r_(new URL("rest/v1",s).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new no(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}}(ab,aw,void 0);class ak{static async getComments(e){let{data:t,error:r}=await ax.from("comments").select("*").eq("order_id",e).order("created_at",{ascending:!1});if(r)throw r;let n=await this.getPrintscreensForOrder(e);return(t||[]).map(e=>({...e,printscreens:n}))}static async getPrintscreensForOrder(e){try{let{data:t,error:r}=await ax.from("file_attachments").select("*").eq("order_id",e).order("created_at",{ascending:!1});if(r)return console.error("❌ Failed to load printscreens:",r),[];return(t||[]).filter(e=>e.file_type&&e.file_type.startsWith("image/"))}catch(e){return console.error("❌ Error loading printscreens:",e),[]}}static async addComment(e){let{data:t,error:r}=await ax.from("comments").insert([{...e,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(r)throw r;return t}static async updateComment(e,t){let{data:r,error:n}=await ax.from("comments").update({text:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return r}static async deleteComment(e){let{error:t}=await ax.from("comments").delete().eq("id",e);if(t)throw t}static async getReminders(e){let{data:t,error:r}=await ax.from("reminders").select("*").eq("order_id",e).order("due_date",{ascending:!0});if(r)throw r;return t||[]}static async addReminder(e,t){let{data:r,error:n}=await ax.from("reminders").insert([{order_id:e,...t,created_at:new Date().toISOString()}]).select().single();if(n)throw n;return r}static async updateReminder(e,t){let{data:r,error:n}=await ax.from("reminders").update(t).eq("id",e).select().single();if(n)throw n;return r}static async deleteReminder(e){let{error:t}=await ax.from("reminders").delete().eq("id",e);if(t)throw t}static async getFiles(e){let{data:t,error:r}=await ax.from("file_attachments").select("*").eq("order_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}static async uploadFileToStorage(e,t){console.log("🔍 Starting file upload to Storage...");try{let r="".concat(Date.now(),"_").concat(t.name),n="".concat(e,"/").concat(r);console.log("📤 Uploading to Storage:",n);let{error:a}=await ax.storage.from("files").upload(n,t);if(a)throw console.error("❌ Storage upload failed:",a),a;let{data:i}=ax.storage.from("files").getPublicUrl(n);if(!i.publicUrl)throw Error("Failed to get public URL");let s={order_id:e,filename:t.name,file_url:i.publicUrl,file_type:t.type||"application/octet-stream",created_at:new Date().toISOString()};console.log("📤 Saving metadata to DB:",s);let{data:o,error:l}=await ax.from("file_attachments").insert([s]).select().single();if(l)throw console.error("❌ Failed to save metadata:",l),l;return console.log("✅ File uploaded successfully:",t.name),{id:o.id,order_id:e,filename:t.name,file_url:i.publicUrl,file_type:t.type||"application/octet-stream",created_at:o.created_at}}catch(e){throw console.error("❌ Upload failed:",e),e}}static async uploadPrintscreen(e,t){try{let r="printscreen_".concat(Date.now(),"_").concat(t.name),n="".concat(e,"/printscreens/").concat(r),{error:a}=await ax.storage.from("files").upload(n,t);if(a)throw a;let{data:i}=ax.storage.from("files").getPublicUrl(n);if(!i.publicUrl)throw Error("Failed to get public URL");let s={order_id:e,filename:t.name,file_url:i.publicUrl,file_type:t.type||"image/png",created_at:new Date().toISOString()},{data:o,error:l}=await ax.from("file_attachments").insert([s]).select().single();if(l)throw l;return{id:o.id,order_id:e,filename:t.name,file_url:i.publicUrl,file_type:t.type||"image/png",created_at:o.created_at}}catch(e){throw console.error("Printscreen upload failed:",e),e}}static async deleteFile(e){let{data:t,error:r}=await ax.from("file_attachments").select("file_url").eq("id",e).single();if(r)throw r;let n=new URL(t.file_url).pathname.split("/"),a=n.findIndex(e=>"files"===e),i=n.slice(a+1).join("/"),{error:s}=await ax.storage.from("files").remove([i]);if(s)throw s;let{error:o}=await ax.from("file_attachments").delete().eq("id",e);if(o)throw o}}function a_(e){let t,{order:r,isOpen:n,onClose:a}=e,[i,s]=(0,v.useState)("details"),[o,l]=(0,v.useState)([]),[c,u]=(0,v.useState)([]),[d,h]=(0,v.useState)([]),[f,g]=(0,v.useState)(""),[p,m]=(0,v.useState)({title:"",due_date:"",is_completed:!1});(0,v.useEffect)(()=>{let e=async()=>{if(r)try{let[e,t,n]=await Promise.all([ak.getComments(r.id),ak.getReminders(r.id),ak.getFiles(r.id)]);l(e),u(t),h(n)}catch(e){console.error("Failed to load order data:",e)}};r&&n&&e()},[r,n]);let b=async()=>{if(r&&f.trim())try{let e=await ak.addComment({order_id:r.id,text:f});l(t=>[e,...t]),g("")}catch(e){console.error("Failed to add comment:",e)}},w=async()=>{if(r&&p.title.trim()&&p.due_date)try{let e=await ak.addReminder(r.id,{title:p.title,due_date:p.due_date,is_completed:!1});u(t=>[...t,e]),m({title:"",due_date:"",is_completed:!1})}catch(e){console.error("Failed to add reminder:",e)}},x=async e=>{var t;if(r&&(null==(t=e.target.files)?void 0:t.length))try{let t=e.target.files[0],n=await ak.uploadFileToStorage(r.id,t);h(e=>[n,...e])}catch(e){console.error("Failed to upload file:",e)}},k=e=>{try{return es(new Date(e),"yyyy-MM-dd")}catch(t){return e}};return r?(0,y.jsxs)(rh,{open:n,onClose:a,className:"relative z-50",children:[(0,y.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,y.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,y.jsxs)(rh.Panel,{className:"mx-auto max-w-4xl w-full h-[90vh] bg-white dark:bg-gray-800 rounded-xl shadow-2xl flex flex-col",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,y.jsxs)(rh.Title,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Užsakymo detalės: ",r.client]}),(0,y.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,y.jsx)(rf,{className:"w-6 h-6"})})]}),(0,y.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,y.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"details",label:"Detalės",icon:null},{id:"comments",label:"Komentarai",icon:rp},{id:"reminders",label:"Priminimai",icon:rm},{id:"files",label:"Failai",icon:ry}].map(e=>(0,y.jsx)("button",{onClick:()=>s(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat(i===e.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[e.icon&&(0,y.jsx)(e.icon,{className:"w-4 h-4"}),(0,y.jsx)("span",{children:e.label})]})},e.id))})}),(0,y.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:["details"===i&&(0,y.jsxs)("div",{className:"space-y-6",children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Pagrindinė informacija"}),(0,y.jsxs)("dl",{className:"space-y-3",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Klientas"}),(0,y.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:r.client})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Agentūra"}),(0,y.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:r.agency||"-"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Užsakymo Nr."}),(0,y.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:r.invoice_id})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Statusas"}),(0,y.jsx)("dd",{children:(0,y.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(r.approved?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:r.approved?"Patvirtinta":"Nepatvirtinta"})})]})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Datos ir kaina"}),(0,y.jsxs)("dl",{className:"space-y-3",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Data nuo"}),(0,y.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:k(r.from)})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Data iki"}),(0,y.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:k(r.to)})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Galutinė kaina"}),(0,y.jsx)("dd",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(t=r.final_price,new Intl.NumberFormat("lt-LT",{style:"currency",currency:"EUR"}).format(t))})]})]})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Papildoma informacija"}),(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)("input",{type:"checkbox",checked:r.viaduct,readOnly:!0,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,y.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Viadukas"})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)("input",{type:"checkbox",checked:r.media_received,readOnly:!0,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,y.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Medija gauta"})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)("input",{type:"checkbox",checked:r.invoice_sent,readOnly:!0,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,y.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Sąskaita išsiųsta"})]})]})]})]}),"comments"===i&&(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"flex space-x-3",children:[(0,y.jsx)("input",{type:"text",value:f,onChange:e=>g(e.target.value),placeholder:"Pridėti komentarą...",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"}),(0,y.jsx)("button",{onClick:b,disabled:!f.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Pridėti"})]}),(0,y.jsxs)("div",{className:"space-y-3",children:[o.map(e=>(0,y.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:e.text}),(0,y.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:k(e.created_at)})]})},e.id)),0===o.length&&(0,y.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"Komentarų nėra"})]})]}),"reminders"===i&&(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Pridėti priminimą"}),(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,y.jsx)("input",{type:"text",value:p.title,onChange:e=>m(t=>({...t,title:e.target.value})),placeholder:"Pavadinimas",className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"}),(0,y.jsx)("input",{type:"date",value:p.due_date,onChange:e=>m(t=>({...t,due_date:e.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),(0,y.jsx)("button",{onClick:w,disabled:!p.title.trim()||!p.due_date,className:"mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Pridėti priminimą"})]}),(0,y.jsxs)("div",{className:"space-y-3",children:[c.map(e=>(0,y.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white",children:e.title}),(0,y.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Iki: ",k(e.due_date)]})]}),(0,y.jsx)("input",{type:"checkbox",checked:e.is_completed,onChange:async t=>{try{await ak.updateReminder(e.id,{is_completed:t.target.checked}),u(r=>r.map(r=>r.id===e.id?{...r,is_completed:t.target.checked}:r))}catch(e){console.error("Failed to update reminder:",e)}},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})]})},e.id)),0===c.length&&(0,y.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"Priminimų nėra"})]})]}),"files"===i&&(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Pridėti failą"}),(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)("input",{type:"file",onChange:x,accept:".jpg,.jpeg,.png,.pdf,.xls,.xlsx",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"}),(0,y.jsx)(ry,{className:"w-5 h-5 text-gray-400"})]})]}),(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[d.map(e=>(0,y.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)(ry,{className:"w-8 h-8 text-gray-400"}),(0,y.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,y.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.filename}),(0,y.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:k(e.created_at)})]})]}),(0,y.jsxs)("div",{className:"mt-3 flex space-x-2",children:[(0,y.jsx)("a",{href:e.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Peržiūrėti"}),(0,y.jsx)("button",{onClick:async()=>{try{await ak.deleteFile(e.id),h(t=>t.filter(t=>t.id!==e.id))}catch(e){console.error("Failed to delete file:",e)}},className:"text-sm text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:"Ištrinti"})]})]},e.id)),0===d.length&&(0,y.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8 col-span-full",children:"Failų nėra"})]})]})]})]})})]}):null}var aj=e.i(57688);function aS(e){var t;let{order:r,isOpen:n,onClose:a,onOrderUpdated:i}=e,[s,o]=(0,v.useState)({}),[l,c]=(0,v.useState)([]),[u,d]=(0,v.useState)([]),[h,f]=(0,v.useState)([]),[g,p]=(0,v.useState)(!1),[m,b]=(0,v.useState)(""),[w,x]=(0,v.useState)(""),[k,_]=(0,v.useState)(""),[S,E]=(0,v.useState)([]),[N,T]=(0,v.useState)(null),C=async()=>{if(r)try{let e=await j.getQuoteByOrderId(r.invoice_id);T(e)}catch(e){console.log("No quote found for order:",r.invoice_id)}};(0,v.useEffect)(()=>{r&&(o({client:r.client,agency:r.agency,invoice_id:r.invoice_id,from:r.from,to:r.to,final_price:r.final_price||0,approved:r.approved,media_received:r.media_received,invoice_sent:r.invoice_sent,viaduct:r.viaduct}),C())},[r]),(0,v.useEffect)(()=>{if(n){let e=document.querySelector('[role="dialog"]');e&&e.focus()}},[n]);let P=(0,v.useCallback)(async()=>{if(r)try{let e=(await ak.getComments(r.id)).sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime());c(e)}catch(e){console.error("Error loading comments:",e)}},[r]),O=(0,v.useCallback)(async()=>{if(r)try{let e=await ak.getReminders(r.id);d(e)}catch(e){console.error("Error loading reminders:",e)}},[r]),A=(0,v.useCallback)(async()=>{if(r)try{let e=await ak.getPrintscreensForOrder(r.id);f(e),E([])}catch(e){console.error("Error loading print screens:",e)}},[r]);(0,v.useEffect)(()=>{if(r&&n){P();let e=setTimeout(()=>{O(),A()},500);return()=>clearTimeout(e)}},[r,n,P,O,A]);let R=(e,t)=>{o(r=>({...r,[e]:t}))},I=async()=>{if(r){p(!0);try{let e=await j.updateOrder(r.id,s);i(e),a()}catch(e){console.error("Error updating order:",e)}finally{p(!1)}}},L=async()=>{if(r&&confirm("Ar tikrai norite ištrinti šį užsakymą?"))try{await j.deleteOrder(r.id),a()}catch(e){console.error("Error deleting order:",e)}},M=async()=>{if(r&&m.trim())try{let e=await ak.addComment({order_id:r.id,text:m.trim()});c(t=>[e,...t]),b("");let t=document.querySelector('[contenteditable="true"]');t&&(t.textContent="")}catch(n){console.error("Error adding comment:",n);let e={id:"temp-".concat(Date.now()),text:m.trim(),created_at:new Date().toISOString(),order_id:r.id};c(t=>[e,...t]),b("");let t=document.querySelector('[contenteditable="true"]');t&&(t.textContent="")}},D=async()=>{if(r&&w&&k.trim())try{let e=new Date(w).toISOString().split("T")[0],t=await ak.addReminder(r.id,{due_date:e,title:k.trim(),is_completed:!1});d(e=>[...e,t]),x(""),_("")}catch(t){console.error("Error adding reminder:",t);let e={id:"temp-".concat(Date.now()),due_date:w,title:k.trim(),is_completed:!1,order_id:r.id,created_at:new Date().toISOString()};d(t=>[...t,e]),x(""),_("")}},U=async e=>{try{await ak.deleteReminder(e),d(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error deleting reminder:",e)}},F=e=>{window.open(e.file_url,"_blank")},B=async e=>{var t;let n=null==(t=e.clipboardData)?void 0:t.items;if(n&&r)for(let t=0;t<n.length;t++){let a=n[t];if(a.type.startsWith("image/")){e.preventDefault();let t=a.getAsFile();if(!t)continue;try{let e=await ak.uploadPrintscreen(r.id,t);E(t=>[...t,e])}catch(e){console.error("Error uploading printscreen:",e)}}}},q=e=>{try{return new Date(e).toISOString().split("T")[0]}catch(t){return e}},W=e=>{try{let t=new Date(e),r=new Date(t.getFullYear(),0,4),n=r.getDay()||7,a=new Date(r);a.setDate(r.getDate()-n+1);let i=Math.floor((t.getTime()-a.getTime())/864e5),s=Math.ceil((i+1)/7);return"W".concat(s)}catch(e){return""}},z=s.from?W(s.from):"",H=s.to?W(s.to):"",K=z&&H?"".concat(z," → ").concat(H):z||H||"";return n&&r?(0,y.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true",onKeyDown:e=>{"Escape"===e.key&&a()},tabIndex:0,children:(0,y.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:r.client}),(0,y.jsxs)("p",{className:"text-gray-600",children:[r.agency," | ",r.invoice_id]})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Media"}),(0,y.jsx)("button",{type:"button",onClick:()=>R("media_received",!s.media_received),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(s.media_received?"bg-green-300":"bg-gray-200"),children:(0,y.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(s.media_received?"translate-x-6":"translate-x-1")})})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Sąskaita"}),(0,y.jsx)("button",{type:"button",onClick:()=>R("invoice_sent",!s.invoice_sent),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(s.invoice_sent?"bg-green-300":"bg-gray-200"),children:(0,y.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(s.invoice_sent?"translate-x-6":"translate-x-1")})})]}),(0,y.jsx)("button",{type:"button",onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors ml-4",children:(0,y.jsx)(rf,{className:"w-6 h-6"})})]})]}),(0,y.jsxs)("div",{className:"p-6 space-y-3",children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pavadinimas"}),(0,y.jsx)("input",{type:"text",value:s.client||"",onChange:e=>R("client",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statusas"}),(0,y.jsxs)("select",{value:s.approved?"taip":"ne",onChange:e=>R("approved","taip"===e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,y.jsx)("option",{value:"ne",children:"Nepatvirtinta"}),(0,y.jsx)("option",{value:"taip",children:"Patvirtinta"}),(0,y.jsx)("option",{value:"rezervuota",children:"Rezervuota"}),(0,y.jsx)("option",{value:"atšaukta",children:"Atšaukta"})]})]})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transliacijų laikotarpis"}),(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)("input",{type:"text",value:s.from?q(s.from):"",onChange:e=>R("from",e.target.value),pattern:"\\d{4}-\\d{2}-\\d{2}",placeholder:"yyyy-mm-dd",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,y.jsx)("span",{className:"text-gray-500",children:"→"}),(0,y.jsx)("input",{type:"text",value:s.to?q(s.to):"",onChange:e=>R("to",e.target.value),pattern:"\\d{4}-\\d{2}-\\d{2}",placeholder:"yyyy-mm-dd",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,y.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,y.jsx)("span",{className:"font-normal",children:"Savaitės:"})," ",(0,y.jsx)("span",{className:"font-semibold",children:K})]})})]}),s.from&&s.to&&s.final_price&&(0,y.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"space-y-2",children:[((e,t,r)=>{try{if(!e||!t||!r)return[];let n=e.split(" ")[0],a=t.split(" ")[0],[i,s,o]=n.split("-").map(Number),[l,c,u]=a.split("-").map(Number),d=new Date(i,s-1,o),h=new Date(l,c-1,u);if(isNaN(d.getTime())||isNaN(h.getTime()))return[];let f=0,g=new Date(d);for(;g<=h;){f++;let e=new Date(g);e.setDate(e.getDate()+1),g=e}let p=[],m=["sausis","vasaris","kovas","balandis","gegužė","birželis","liepa","rugpjūtis","rugsėjis","spalis","lapkritis","gruodis"],y=new Date(d),v=new Date(h);for(;y<=v;){let e=y.getMonth()+1,t=y.getFullYear(),r="".concat(t,"-").concat(e),n=p.find(e=>e.month===r);n||(n={month:r,year:t,days:0,amount:0,monthName:m[e-1]},p.push(n)),n.days++,y.setDate(y.getDate()+1)}return p.forEach(e=>{e.amount=e.days/f*r}),p.map(e=>({month:parseInt(e.month.split("-")[1]),year:e.year,monthName:e.monthName,days:e.days,amount:e.amount}))}catch(e){return console.error("Error in calculateMonthlyDistribution:",e),[]}})(s.from,s.to,s.final_price).map(e=>(0,y.jsxs)("div",{className:"text-sm text-gray-900",children:[e.monthName.charAt(0).toUpperCase()+e.monthName.slice(1)," ",e.year," (",e.days," d.) → ",e.amount.toFixed(2),"€"]},e.month)),(0,y.jsx)("div",{className:"pt-3 border-t border-gray-200",children:(0,y.jsxs)("div",{className:"text-sm text-gray-900 flex items-center",children:[(0,y.jsx)("span",{className:"font-normal",children:"Viso:"})," ",(0,y.jsxs)("span",{className:"font-semibold",children:[null==(t=s.final_price)?void 0:t.toFixed(2),"€"]}),N&&(0,y.jsx)("button",{onClick:()=>{let e=(null==r?void 0:r.viaduct)?N.viaduct_link:N.link;window.open(e,"_blank")},className:"ml-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Atidaryti skaičiuoklę",children:"🔗"})]})})]})}),(0,y.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Komentaras"}),(0,y.jsx)("div",{contentEditable:!0,onInput:e=>b(e.currentTarget.textContent||""),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),M())},onPaste:B,"data-placeholder":"Įveskite komentarą... (Enter - išsaugoti, Cmd+V - printscreen)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-24 resize-none min-h-[6rem] overflow-y-auto",style:{whiteSpace:"pre-wrap"}}),l.length>0&&(0,y.jsx)("div",{className:"mt-4 space-y-2",children:l.map(e=>(0,y.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,y.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:new Date(e.created_at).toLocaleString("lt-LT")}),(0,y.jsx)("div",{className:"text-sm text-gray-900",children:e.text})]},e.id))})]}),(0,y.jsx)("div",{className:"space-y-4",children:(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Printscreens"}),(0,y.jsxs)("div",{className:"flex flex-wrap gap-2",children:[S.map(e=>(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(aj.default,{src:e.file_url,alt:"Printscreen",width:64,height:64,className:"w-16 h-16 object-cover rounded border cursor-pointer hover:opacity-80",onClick:()=>F(e)}),(0,y.jsx)("button",{type:"button",onClick:async()=>{try{await ak.deleteFile(e.id),E(t=>t.filter(t=>t.id!==e.id)),f(t=>t.filter(t=>t.id!==e.id))}catch(e){console.error("Error deleting printscreen:",e)}},className:"absolute -top-1 -right-1 w-4 h-4 bg-black text-white rounded-full text-xs hover:bg-gray-800 flex items-center justify-center",children:"×"})]},e.id)),h.map(e=>(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(aj.default,{src:e.file_url,alt:"Printscreen",width:64,height:64,className:"w-16 h-16 object-cover rounded border cursor-pointer hover:opacity-80",onClick:()=>F(e)}),(0,y.jsx)("button",{type:"button",onClick:async()=>{try{await ak.deleteFile(e.id),f(t=>t.filter(t=>t.id!==e.id))}catch(e){console.error("Error deleting printscreen:",e)}},className:"absolute -top-1 -right-1 w-4 h-4 bg-black text-white rounded-full text-xs hover:bg-gray-800 flex items-center justify-center",children:"×"})]},e.id)),0===S.length&&0===h.length&&(0,y.jsx)("div",{className:"text-sm text-gray-400 italic",children:"Cmd+V į komentaro lauką pridėti printscreen"})]})]})})]}),(0,y.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data"}),(0,y.jsx)("input",{type:"date",value:w,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priminimo žinutė"}),(0,y.jsxs)("div",{className:"flex space-x-2",children:[(0,y.jsx)("input",{type:"text",value:k,onChange:e=>_(e.target.value),placeholder:"Įveskite priminimo žinutę...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,y.jsx)("button",{type:"button",onClick:D,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Pridėti"})]})]})]}),u.length>0&&(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Priminimai"}),(0,y.jsx)("div",{className:"space-y-2",children:u.map(e=>(0,y.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"text-sm font-medium text-gray-900",children:new Date(e.due_date).toLocaleDateString("lt-LT")}),(0,y.jsx)("div",{className:"text-sm text-gray-600",children:e.title})]}),(0,y.jsx)("button",{type:"button",onClick:()=>U(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Ištrinti"})]},e.id))})]})]}),(0,y.jsxs)("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[(0,y.jsx)("button",{type:"button",onClick:L,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Ištrinti"}),(0,y.jsxs)("div",{className:"flex space-x-3",children:[(0,y.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Uždaryti"}),(0,y.jsx)("button",{type:"button",onClick:I,disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:g?"Išsaugoma...":"Išsaugoti"})]})]})]})}):null}function aE(e){let{onClose:t,onOpenEditModal:r}=e,[n,a]=(0,v.useState)([]),[i,s]=(0,v.useState)(!0),[o,l]=(0,v.useState)({});(0,v.useEffect)(()=>{c()},[]);let c=async()=>{try{let{data:e,error:t}=await ax.from("reminders").select("*").eq("is_completed",!1).order("due_date",{ascending:!0});if(t)throw t;if(a(e||[]),e&&e.length>0){let t=[...new Set(e.map(e=>e.order_id))],r={};for(let e of t)try{let t=await j.getOrder(e);r[e]=t.client}catch(t){console.error("Error loading order ".concat(e,":"),t),r[e]="Nežinomas klientas"}l(r)}}catch(e){console.error("Error loading reminders:",e)}finally{s(!1)}};return i?(0,y.jsx)("div",{className:"fixed top-4 right-4 z-50 bg-white rounded-xl shadow-2xl border border-gray-100 p-6 max-w-sm backdrop-blur-sm",children:(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-500 border-t-transparent"}),(0,y.jsx)("div",{className:"text-sm text-gray-600",children:"Kraunama priminimai..."})]})}):0===n.length?null:(0,y.jsxs)("div",{className:"fixed top-4 right-4 z-50 space-y-3 max-w-sm",children:[n.map(e=>(0,y.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl shadow-xl p-5 backdrop-blur-sm hover:shadow-2xl transition-all duration-300 cursor-pointer hover:bg-gray-50",onClick:()=>r(e.order_id),children:(0,y.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,y.jsx)("div",{className:"flex-shrink-0",children:(0,y.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-red-400 to-pink-500 rounded-full flex items-center justify-center shadow-lg",children:(0,y.jsx)("span",{className:"text-white text-lg",children:"!"})})}),(0,y.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,y.jsx)("h4",{className:"text-xs text-gray-600",children:"Priminimas"}),(0,y.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Aktyvus"})]}),(0,y.jsx)("p",{className:"text-sm font-bold text-gray-800 mb-3 leading-relaxed",children:e.title}),(0,y.jsxs)("div",{className:"space-y-1",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[(0,y.jsx)("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full"}),(0,y.jsx)("span",{className:"font-medium",children:"Klientas:"}),(0,y.jsx)("span",{className:"text-gray-800",children:o[e.order_id]||"Kraunama..."})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[(0,y.jsx)("span",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"}),(0,y.jsx)("span",{className:"font-medium",children:"Data:"}),(0,y.jsx)("span",{className:"text-gray-800",children:new Date(e.due_date).toLocaleDateString("lt-LT")})]})]})]})]})},e.id)),(0,y.jsx)("div",{className:"flex justify-end pt-2",children:(0,y.jsxs)("button",{onClick:t,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 bg-white/80 hover:bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 backdrop-blur-sm",children:[(0,y.jsx)("span",{children:"Uždaryti"}),(0,y.jsx)("svg",{className:"ml-1.5 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]})}function aN(){let[e,t]=(0,v.useState)(!1),[r,n]=(0,v.useState)(null),[a,i]=(0,v.useState)(null),[s,o]=(0,v.useState)(""),[l,c]=(0,v.useState)(!0),[u,d]=(0,v.useState)(0),[h,f]=(0,v.useState)(!1);(0,v.useEffect)(()=>{let e=localStorage.getItem("darkMode");null!==e&&f(JSON.parse(e))},[]),(0,v.useEffect)(()=>{localStorage.setItem("darkMode",JSON.stringify(h)),h?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[h]);let g=new Date,p=String(g.getMonth()+1).padStart(2,"0"),m=g.getFullYear(),[b,w]=(0,v.useState)({status:"taip",month:p,year:m.toString(),client:"",agency:"",media_received:"",invoice_sent:""}),x=async e=>{try{let t=await j.getOrder(e);i(t)}catch(e){console.error("Error loading order for edit:",e)}};return(0,y.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,y.jsx)(ed,{onAddOrder:()=>t(!0),isDarkMode:h,onToggleDarkMode:()=>{f(!h)}}),(0,y.jsxs)("main",{className:"container mx-auto px-4 py-6",children:[(0,y.jsx)(eg,{searchQuery:s,onSearchChange:o,filters:b,onFiltersChange:w}),(0,y.jsx)(eo,{searchQuery:s,filters:b,onEditOrder:e=>{i(e)}},u)]}),(0,y.jsx)(rg,{isOpen:e,onClose:()=>t(!1)}),(0,y.jsx)(a_,{order:r,isOpen:!!r,onClose:()=>n(null)}),(0,y.jsx)(aS,{order:a,isOpen:!!a,onClose:()=>i(null),onOrderUpdated:()=>{d(e=>e+1),i(null)}}),l&&(0,y.jsx)(aE,{onClose:()=>c(!1),onOpenEditModal:x})]})}}]);